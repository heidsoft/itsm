{"version":3,"names":["cov_1ieh03uyru","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","s","f","b","inputSourceMap","version","sources","sourcesContent","names","mappings","_coverageSchema","coverage","actualCoverage","BatchOperationStatus","BatchOperationType"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-prototype/src/types/batch-operations.ts"],"sourcesContent":["/**\n * 批量操作类型定义\n * 支持工单的批量分配、状态更新、字段更新、删除、导出等操作\n */\n\nimport type { TicketStatus, TicketPriority, TicketType } from './ticket';\n\n// ==================== 批量操作类型枚举 ====================\n\nexport enum BatchOperationType {\n  ASSIGN = 'assign',                     // 批量分配\n  UPDATE_STATUS = 'update_status',       // 批量状态更新\n  UPDATE_PRIORITY = 'update_priority',   // 批量优先级更新\n  UPDATE_TYPE = 'update_type',           // 批量类型更新\n  UPDATE_CATEGORY = 'update_category',   // 批量分类更新\n  ADD_TAGS = 'add_tags',                 // 批量添加标签\n  REMOVE_TAGS = 'remove_tags',           // 批量删除标签\n  UPDATE_FIELDS = 'update_fields',       // 批量更新自定义字段\n  DELETE = 'delete',                     // 批量删除\n  ARCHIVE = 'archive',                   // 批量归档\n  EXPORT = 'export',                     // 批量导出\n  CLOSE = 'close',                       // 批量关闭\n  REOPEN = 'reopen',                     // 批量重新打开\n}\n\n// ==================== 批量操作请求 ====================\n\nexport interface BatchOperationRequest {\n  operationType: BatchOperationType;\n  ticketIds: number[];                   // 工单IDs（最多1000个）\n  data?: BatchOperationData;             // 操作数据\n  comment?: string;                      // 批量操作说明\n  notifyAssignees?: boolean;             // 是否通知处理人\n}\n\nexport interface BatchOperationData {\n  // 批量分配\n  assigneeId?: number;\n  teamId?: number;\n  assignmentRule?: 'round_robin' | 'load_balance' | 'manual';\n  \n  // 批量状态更新\n  status?: TicketStatus;\n  resolution?: string;\n  \n  // 批量优先级更新\n  priority?: TicketPriority;\n  \n  // 批量类型更新\n  type?: TicketType;\n  \n  // 批量分类更新\n  categoryId?: number;\n  \n  // 批量标签操作\n  tags?: string[];\n  \n  // 批量字段更新\n  customFields?: Record<string, any>;\n  \n  // 批量导出\n  exportFormat?: 'excel' | 'csv' | 'pdf';\n  exportFields?: string[];\n  includeComments?: boolean;\n  includeAttachments?: boolean;\n  \n  // 批量关闭\n  closureReason?: string;\n  satisfactionRequired?: boolean;\n}\n\n// ==================== 批量操作响应 ====================\n\nexport interface BatchOperationResponse {\n  operationId: string;                   // 操作ID\n  operationType: BatchOperationType;\n  totalCount: number;                    // 总数\n  successCount: number;                  // 成功数\n  failedCount: number;                   // 失败数\n  skippedCount: number;                  // 跳过数\n  completedAt?: Date;                    // 完成时间\n  errors: BatchOperationError[];         // 错误列表\n  warnings: BatchOperationWarning[];     // 警告列表\n  downloadUrl?: string;                  // 导出文件下载链接（导出操作）\n}\n\nexport interface BatchOperationError {\n  ticketId: number;\n  ticketNumber: string;\n  error: string;\n  errorCode?: string;\n  details?: any;\n}\n\nexport interface BatchOperationWarning {\n  ticketId: number;\n  ticketNumber: string;\n  warning: string;\n  details?: any;\n}\n\n// ==================== 批量操作进度 ====================\n\nexport interface BatchOperationProgress {\n  operationId: string;\n  operationType: BatchOperationType;\n  status: BatchOperationStatus;\n  totalCount: number;\n  processedCount: number;\n  successCount: number;\n  failedCount: number;\n  percentage: number;                    // 百分比（0-100）\n  startedAt: Date;\n  estimatedCompletionTime?: Date;\n  currentTicket?: {\n    ticketId: number;\n    ticketNumber: string;\n  };\n}\n\nexport enum BatchOperationStatus {\n  PENDING = 'pending',                   // 等待中\n  RUNNING = 'running',                   // 执行中\n  PAUSED = 'paused',                     // 已暂停\n  COMPLETED = 'completed',               // 已完成\n  FAILED = 'failed',                     // 失败\n  CANCELLED = 'cancelled',               // 已取消\n}\n\n// ==================== 批量操作日志 ====================\n\nexport interface BatchOperationLog {\n  id: string;\n  operationId: string;\n  operationType: BatchOperationType;\n  operatorId: number;\n  operatorName: string;\n  ticketIds: number[];\n  totalCount: number;\n  successCount: number;\n  failedCount: number;\n  status: BatchOperationStatus;\n  startedAt: Date;\n  completedAt?: Date;\n  duration?: number;                     // 耗时（秒）\n  comment?: string;\n  data?: BatchOperationData;\n  errors?: BatchOperationError[];\n}\n\n// ==================== 批量选择配置 ====================\n\nexport interface BatchSelectionConfig {\n  maxSelectionCount?: number;            // 最大选择数量（默认1000）\n  allowCrossPage?: boolean;              // 允许跨页选择\n  selectAll?: boolean;                   // 全选（根据筛选条件）\n  excludeIds?: number[];                 // 排除的工单IDs\n}\n\n// ==================== 批量验证 ====================\n\nexport interface BatchOperationValidation {\n  isValid: boolean;\n  canProceed: boolean;\n  errors: ValidationError[];\n  warnings: ValidationWarning[];\n  affectedTickets: {\n    ticketId: number;\n    ticketNumber: string;\n    currentStatus: TicketStatus;\n    willChange: boolean;\n    conflicts?: string[];\n  }[];\n}\n\nexport interface ValidationError {\n  field: string;\n  message: string;\n  severity: 'error' | 'critical';\n  ticketIds?: number[];\n}\n\nexport interface ValidationWarning {\n  field: string;\n  message: string;\n  ticketIds?: number[];\n  canIgnore: boolean;\n}\n\n// ==================== 批量导出配置 ====================\n\nexport interface BatchExportConfig {\n  format: 'excel' | 'csv' | 'pdf';\n  fields: ExportField[];\n  includeComments: boolean;\n  includeAttachments: boolean;\n  includeHistory: boolean;\n  includeRelations: boolean;\n  groupBy?: 'status' | 'priority' | 'assignee' | 'category';\n  sortBy?: string;\n  sortOrder?: 'asc' | 'desc';\n  fileName?: string;\n}\n\nexport interface ExportField {\n  fieldName: string;\n  fieldLabel: string;\n  includeInExport: boolean;\n  order: number;\n}\n\n// ==================== 批量分配规则 ====================\n\nexport interface BatchAssignmentRule {\n  type: 'round_robin' | 'load_balance' | 'skill_based' | 'manual';\n  targetUserIds?: number[];\n  targetTeamId?: number;\n  skillTags?: string[];\n  maxWorkload?: number;                  // 每人最大工作负载\n  considerCurrentWorkload?: boolean;\n  considerAvailability?: boolean;\n}\n\nexport interface AssignmentResult {\n  ticketId: number;\n  assignedTo: number;\n  assignedToName: string;\n  currentWorkload: number;\n  reason: string;\n}\n\n// ==================== 批量操作预览 ====================\n\nexport interface BatchOperationPreview {\n  operationType: BatchOperationType;\n  affectedCount: number;\n  changes: BatchOperationChange[];\n  estimatedDuration: number;             // 预计耗时（秒）\n  risks: BatchOperationRisk[];\n}\n\nexport interface BatchOperationChange {\n  ticketId: number;\n  ticketNumber: string;\n  field: string;\n  currentValue: any;\n  newValue: any;\n  willAffectSLA: boolean;\n  willTriggerWorkflow: boolean;\n  willSendNotification: boolean;\n}\n\nexport interface BatchOperationRisk {\n  level: 'low' | 'medium' | 'high' | 'critical';\n  description: string;\n  affectedTicketIds: number[];\n  mitigation?: string;\n}\n\n// ==================== 批量操作统计 ====================\n\nexport interface BatchOperationStats {\n  totalOperations: number;\n  operationsByType: Record<BatchOperationType, number>;\n  successRate: number;                   // 成功率（%）\n  averageDuration: number;               // 平均耗时（秒）\n  totalTicketsAffected: number;\n  mostCommonErrors: {\n    error: string;\n    count: number;\n  }[];\n  operationsByUser: {\n    userId: number;\n    username: string;\n    operationCount: number;\n    successRate: number;\n  }[];\n  recentOperations: BatchOperationLog[];\n}\n\n// ==================== 批量操作权限 ====================\n\nexport interface BatchOperationPermissions {\n  canBatchAssign: boolean;\n  canBatchUpdateStatus: boolean;\n  canBatchUpdatePriority: boolean;\n  canBatchUpdateFields: boolean;\n  canBatchDelete: boolean;\n  canBatchExport: boolean;\n  canBatchClose: boolean;\n  maxBatchSize: number;                  // 最大批量操作数量\n  allowedOperations: BatchOperationType[];\n}\n\n// ==================== 批量操作队列 ====================\n\nexport interface BatchOperationQueue {\n  queueId: string;\n  operations: QueuedOperation[];\n  status: 'active' | 'paused' | 'completed';\n  createdAt: Date;\n  processedCount: number;\n  remainingCount: number;\n}\n\nexport interface QueuedOperation {\n  id: string;\n  operationType: BatchOperationType;\n  ticketIds: number[];\n  priority: 'low' | 'normal' | 'high';\n  status: 'pending' | 'processing' | 'completed' | 'failed';\n  scheduledAt?: Date;\n  startedAt?: Date;\n  completedAt?: Date;\n}\n\n// ==================== 批量操作确认 ====================\n\nexport interface BatchOperationConfirmation {\n  operationType: BatchOperationType;\n  ticketCount: number;\n  requiresConfirmation: boolean;\n  confirmationMessage: string;\n  confirmationLevel: 'low' | 'medium' | 'high';\n  mustTypeConfirmation?: string;         // 高危操作需要输入的确认文本\n  warnings: string[];\n  estimatedImpact: {\n    affectedUsers: number;\n    affectedTeams: number;\n    slaImpact: number;\n    workflowTriggers: number;\n  };\n}\n\n// ==================== 工具类型 ====================\n\nexport type BatchOperationCallback = (progress: BatchOperationProgress) => void;\n\nexport type BatchOperationFilter = (ticketId: number) => boolean;\n\n// ==================== 导出所有类型 ====================\n\nexport default BatchOperationRequest;\n\n"],"mappings":"AAAA;;;GAGC;;AAAA;AAAA,SAAAA,eAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,MAAA,OAAAC,QAAA;EAAA,IAAAC,GAAA;EAAA,IAAAC,YAAA;IAAAL,IAAA;IAAAM,YAAA;MAAA;QAAAC,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;U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","ignoreList":[]}