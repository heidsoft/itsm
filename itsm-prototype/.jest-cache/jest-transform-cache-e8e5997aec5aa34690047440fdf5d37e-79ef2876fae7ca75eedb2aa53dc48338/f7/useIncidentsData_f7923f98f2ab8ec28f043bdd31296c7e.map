{"version":3,"names":["cov_160hhzpdcy","actualCoverage","s","useIncidentsData","f","t","_i18n","useI18n","incidents","setIncidents","_react","useState","loading","setLoading","total","setTotal","currentPage","setCurrentPage","pageSize","setPageSize","filters","setFilters","status","priority","source","keyword","metrics","setMetrics","total_incidents","critical_incidents","major_incidents","avg_resolution_time","useEffect","loadIncidents","loadMetrics","response","_incidentapi","IncidentAPI","listIncidents","page","page_size","error","console","_antd","message","getIncidentMetrics","handleSearch","value","handleFilterChange","key"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-prototype/src/app/(main)/incidents/hooks/useIncidentsData.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { IncidentAPI, Incident } from '@/lib/api/incident-api';\nimport { message } from 'antd';\nimport { useI18n } from '@/lib/i18n';\n\nexport const useIncidentsData = () => {\n  const { t } = useI18n();\n  const [incidents, setIncidents] = useState<Incident[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [total, setTotal] = useState(0);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pageSize, setPageSize] = useState(10);\n  const [filters, setFilters] = useState({\n    status: '',\n    priority: '',\n    source: '',\n    keyword: '',\n  });\n  const [metrics, setMetrics] = useState({\n    total_incidents: 0,\n    critical_incidents: 0,\n    major_incidents: 0,\n    avg_resolution_time: 0,\n  });\n\n  useEffect(() => {\n    loadIncidents();\n    loadMetrics();\n  }, [currentPage, pageSize, filters]);\n\n  const loadIncidents = async () => {\n    setLoading(true);\n    try {\n      const response = await IncidentAPI.listIncidents({\n        page: currentPage,\n        page_size: pageSize,\n        status: filters.status,\n        priority: filters.priority,\n        source: filters.source,\n        keyword: filters.keyword,\n      });\n      setIncidents(response.incidents);\n      setTotal(response.total);\n    } catch (error) {\n      console.error('Failed to load incidents:', error);\n      message.error(t('incidents.loadDataError'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadMetrics = async () => {\n    try {\n      const response = await IncidentAPI.getIncidentMetrics();\n      setMetrics(response);\n    } catch (error) {\n      console.error('Failed to load metrics:', error);\n      setMetrics({\n        total_incidents: 0,\n        critical_incidents: 0,\n        major_incidents: 0,\n        avg_resolution_time: 0,\n      });\n    }\n  };\n\n  const handleSearch = (value: string) => {\n    setFilters({ ...filters, keyword: value });\n    setCurrentPage(1);\n  };\n\n  const handleFilterChange = (key: string, value: string) => {\n    setFilters({ ...filters, [key]: value });\n    setCurrentPage(1);\n  };\n\n  return {\n    incidents,\n    loading,\n    total,\n    currentPage,\n    pageSize,\n    filters,\n    metrics,\n    setCurrentPage,\n    setPageSize,\n    handleSearch,\n    handleFilterChange,\n    loadIncidents,\n  };\n};\n"],"mappings":"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","ignoreList":[]}