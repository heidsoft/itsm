{"version":3,"names":["cov_d05uaxwn2","actualCoverage","s","SimpleErrorBoundary","f","default","_default","withErrorBoundary","Text","Paragraph","_antd","Typography","ErrorBoundary","_react","Component","constructor","props","handleRetry","setState","hasError","error","errorInfo","errorId","handleGoHome","window","location","href","state","getDerivedStateFromError","Date","now","Math","random","toString","substr","componentDidCatch","console","onError","b","process","env","NODE_ENV","render","fallback","_jsxruntime","jsx","className","Card","Result","icon","_lucidereact","AlertTriangle","size","title","subTitle","extra","jsxs","Space","direction","Button","type","RefreshCw","onClick","Home","showDetails","strong","code","message","Fragment","componentStack","children","errorBoundaryProps","WrappedComponent","displayName","name"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-prototype/src/app/components/common/ErrorBoundary.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { Component, ErrorInfo, ReactNode } from 'react';\nimport { Result, Button, Card, Typography, Space } from 'antd';\nimport { AlertTriangle, RefreshCw, Home } from 'lucide-react';\n\nconst { Text, Paragraph } = Typography;\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n  onError?: (error: Error, errorInfo: ErrorInfo) => void;\n  showDetails?: boolean;\n}\n\ninterface State {\n  hasError: boolean;\n  error: Error | null;\n  errorInfo: ErrorInfo | null;\n  errorId: string;\n}\n\nclass ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      hasError: false,\n      error: null,\n      errorInfo: null,\n      errorId: '',\n    };\n  }\n\n  static getDerivedStateFromError(error: Error): Partial<State> {\n    // 生成错误ID用于追踪\n    const errorId = `ERR_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    \n    return {\n      hasError: true,\n      error,\n      errorId,\n    };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    // 记录错误信息\n    console.error('ErrorBoundary caught an error:', error, errorInfo);\n    \n    this.setState({\n      error,\n      errorInfo,\n    });\n\n    // 调用外部错误处理函数\n    if (this.props.onError) {\n      this.props.onError(error, errorInfo);\n    }\n\n    // 在生产环境中，这里可以发送错误报告到监控服务\n    if (process.env.NODE_ENV === 'production') {\n      // 示例：发送错误到监控服务\n      // errorReportingService.captureException(error, {\n      //   extra: errorInfo,\n      //   tags: { errorBoundary: true }\n      // });\n    }\n  }\n\n  handleRetry = () => {\n    this.setState({\n      hasError: false,\n      error: null,\n      errorInfo: null,\n      errorId: '',\n    });\n  };\n\n  handleGoHome = () => {\n    window.location.href = '/dashboard';\n  };\n\n  render() {\n    if (this.state.hasError) {\n      // 如果提供了自定义fallback，使用它\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      // 默认错误UI\n      return (\n        <div className=\"min-h-screen bg-gray-50 flex items-center justify-center p-4\">\n          <Card className=\"max-w-2xl w-full\">\n            <Result\n              icon={<AlertTriangle className=\"text-red-500\" size={64} />}\n              title=\"页面出现错误\"\n              subTitle=\"抱歉，页面遇到了一些问题。请尝试刷新页面或联系技术支持。\"\n              extra={\n                <Space direction=\"vertical\" size=\"large\" className=\"w-full\">\n                  <Space>\n                    <Button \n                      type=\"primary\" \n                      icon={<RefreshCw size={16} />}\n                      onClick={this.handleRetry}\n                    >\n                      重试\n                    </Button>\n                    <Button \n                      icon={<Home size={16} />}\n                      onClick={this.handleGoHome}\n                    >\n                      返回首页\n                    </Button>\n                  </Space>\n                  \n                  {this.props.showDetails && this.state.error && (\n                    <Card size=\"small\" className=\"text-left\">\n                      <Space direction=\"vertical\" size=\"small\" className=\"w-full\">\n                        <Text strong>错误详情:</Text>\n                        <Text code className=\"text-red-600\">\n                          {this.state.error.message}\n                        </Text>\n                        \n                        <Text strong>错误ID:</Text>\n                        <Text code>{this.state.errorId}</Text>\n                        \n                        {this.state.errorInfo && (\n                          <>\n                            <Text strong>组件堆栈:</Text>\n                            <Paragraph>\n                              <pre className=\"text-xs bg-gray-100 p-2 rounded overflow-auto max-h-32\">\n                                {this.state.errorInfo.componentStack}\n                              </pre>\n                            </Paragraph>\n                          </>\n                        )}\n                      </Space>\n                    </Card>\n                  )}\n                  \n                  <Text type=\"secondary\" className=\"text-sm\">\n                    如果问题持续存在，请将错误ID提供给技术支持团队\n                  </Text>\n                </Space>\n              }\n            />\n          </Card>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n// 函数式组件包装器，用于更简单的使用\nexport const withErrorBoundary = <P extends object>(\n  Component: React.ComponentType<P>,\n  errorBoundaryProps?: Omit<Props, 'children'>\n) => {\n  const WrappedComponent = (props: P) => (\n    <ErrorBoundary {...errorBoundaryProps}>\n      <Component {...props} />\n    </ErrorBoundary>\n  );\n  \n  WrappedComponent.displayName = `withErrorBoundary(${Component.displayName || Component.name})`;\n  \n  return WrappedComponent;\n};\n\n// 轻量级错误边界，用于小组件\nexport const SimpleErrorBoundary: React.FC<{\n  children: ReactNode;\n  fallback?: ReactNode;\n}> = ({ children, fallback }) => {\n  return (\n    <ErrorBoundary\n      fallback={\n        fallback || (\n          <div className=\"p-4 text-center\">\n            <AlertTriangle className=\"text-red-500 mx-auto mb-2\" size={24} />\n            <Text type=\"secondary\">组件加载失败</Text>\n          </div>\n        )\n      }\n    >\n      {children}\n    </ErrorBoundary>\n  );\n};\n\nexport default ErrorBoundary;"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}