{"version":3,"names":["TicketFilters","DEFAULT_VALUE","cov_1lcmqv99s7","s","status","priority","keyword","dateStart","dateEnd","sortBy","value","onChange","f","local","setLocal","_react","default","useState","useEffect","patch","partial","handleImmediateChange","next","handleApply","handleReset","_jsxruntime","jsxs","e","target","jsx","type","placeholder","style","display","gap","marginLeft","onClick"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-prototype/src/app/components/TicketFilters.tsx"],"sourcesContent":["import React from 'react';\n\nexport type TicketFilterState = {\n  status: 'all' | 'open' | 'in_progress' | 'resolved' | 'closed';\n  priority: 'all' | 'p1' | 'p2' | 'p3' | 'p4';\n  keyword: string;\n  dateStart: string; // YYYY-MM-DD\n  dateEnd: string;   // YYYY-MM-DD\n  sortBy: 'createdAt_desc' | 'createdAt_asc' | 'priority_desc' | 'priority_asc';\n};\n\ninterface Props {\n  value: TicketFilterState;\n  onChange: (next: TicketFilterState) => void;\n}\n\nconst DEFAULT_VALUE: TicketFilterState = {\n  status: 'all',\n  priority: 'all',\n  keyword: '',\n  dateStart: '',\n  dateEnd: '',\n  sortBy: 'createdAt_desc',\n};\n\n// 组件策略：\n// - 下拉选择（状态、优先级、排序）即时触发 onChange\n// - 文本与日期输入在“应用”按钮点击时提交\n// - “重置”按钮恢复默认并触发 onChange\nexport default function TicketFilters({ value, onChange }: Props) {\n  const [local, setLocal] = React.useState<TicketFilterState>(value);\n\n  React.useEffect(() => {\n    setLocal(value);\n  }, [value.status, value.priority, value.keyword, value.dateStart, value.dateEnd, value.sortBy]);\n\n  const patch = (partial: Partial<TicketFilterState>) => ({ ...local, ...partial }) as TicketFilterState;\n\n  const handleImmediateChange = (partial: Partial<TicketFilterState>) => {\n    const next = patch(partial);\n    setLocal(next);\n    onChange(next);\n  };\n\n  const handleApply = () => {\n    onChange(local);\n  };\n\n  const handleReset = () => {\n    setLocal(DEFAULT_VALUE);\n    onChange(DEFAULT_VALUE);\n  };\n\n  return (\n    <div data-testid=\"ticket-filters\" aria-label=\"工单过滤与排序\">\n      {/* 状态 */}\n      <label>\n        状态\n        <select\n          data-testid=\"filter-status-select\"\n          value={local.status}\n          onChange={(e) => handleImmediateChange({ status: e.target.value as TicketFilterState['status'] })}\n        >\n          <option value=\"all\">全部</option>\n          <option value=\"open\">待处理</option>\n          <option value=\"in_progress\">处理中</option>\n          <option value=\"resolved\">已解决</option>\n          <option value=\"closed\">已关闭</option>\n        </select>\n      </label>\n\n      {/* 优先级 */}\n      <label>\n        优先级\n        <select\n          data-testid=\"filter-priority-select\"\n          value={local.priority}\n          onChange={(e) => handleImmediateChange({ priority: e.target.value as TicketFilterState['priority'] })}\n        >\n          <option value=\"all\">全部</option>\n          <option value=\"p1\">P1</option>\n          <option value=\"p2\">P2</option>\n          <option value=\"p3\">P3</option>\n          <option value=\"p4\">P4</option>\n        </select>\n      </label>\n\n      {/* 关键字 */}\n      <label>\n        关键字\n        <input\n          data-testid=\"filter-keyword-input\"\n          type=\"text\"\n          value={local.keyword}\n          onChange={(e) => setLocal(patch({ keyword: e.target.value }))}\n          placeholder=\"搜索标题或描述\"\n        />\n      </label>\n\n      {/* 日期范围 */}\n      <label>\n        开始日期\n        <input\n          data-testid=\"filter-date-start\"\n          type=\"date\"\n          value={local.dateStart}\n          onChange={(e) => setLocal(patch({ dateStart: e.target.value }))}\n        />\n      </label>\n      <label>\n        结束日期\n        <input\n          data-testid=\"filter-date-end\"\n          type=\"date\"\n          value={local.dateEnd}\n          onChange={(e) => setLocal(patch({ dateEnd: e.target.value }))}\n        />\n      </label>\n\n      {/* 排序 */}\n      <label>\n        排序\n        <select\n          data-testid=\"filter-sort-select\"\n          value={local.sortBy}\n          onChange={(e) => handleImmediateChange({ sortBy: e.target.value as TicketFilterState['sortBy'] })}\n        >\n          <option value=\"createdAt_desc\">最近创建</option>\n          <option value=\"createdAt_asc\">最早创建</option>\n          <option value=\"priority_desc\">优先级高到低</option>\n          <option value=\"priority_asc\">优先级低到高</option>\n        </select>\n      </label>\n\n      {/* 操作 */}\n      <div style={{ display: 'inline-flex', gap: 8, marginLeft: 8 }}>\n        <button data-testid=\"filter-apply-btn\" onClick={handleApply}>应用</button>\n        <button data-testid=\"filter-reset-btn\" onClick={handleReset}>重置</button>\n      </div>\n    </div>\n  );\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;AACA;AACA;AACA;AACA;;;;;;WAAwBA,aAAA;;;;;;;;wEA7BN;;;;;;;;;;;;;;;AAgBlB,MAAMC,aAAA;AAAA;AAAA,CAAAC,cAAA,GAAAC,CAAA,OAAmC;EACvCC,MAAA,EAAQ;EACRC,QAAA,EAAU;EACVC,OAAA,EAAS;EACTC,SAAA,EAAW;EACXC,OAAA,EAAS;EACTC,MAAA,EAAQ;AACV;AAMe,SAAST,cAAc;EAAEU,KAAK;EAAEC;AAAQ,CAAS;EAAA;EAAAT,cAAA,GAAAU,CAAA;EAC9D,MAAM,CAACC,KAAA,EAAOC,QAAA,CAAS;EAAA;EAAA,CAAAZ,cAAA,GAAAC,CAAA,OAAGY,MAAA,CAAAC,OAAK,CAACC,QAAQ,CAAoBP,KAAA;EAAA;EAAAR,cAAA,GAAAC,CAAA;EAE5DY,MAAA,CAAAC,OAAK,CAACE,SAAS,CAAC;IAAA;IAAAhB,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAC,CAAA;IACdW,QAAA,CAASJ,KAAA;EACX,GAAG,CAACA,KAAA,CAAMN,MAAM,EAAEM,KAAA,CAAML,QAAQ,EAAEK,KAAA,CAAMJ,OAAO,EAAEI,KAAA,CAAMH,SAAS,EAAEG,KAAA,CAAMF,OAAO,EAAEE,KAAA,CAAMD,MAAM,CAAC;EAAA;EAAAP,cAAA,GAAAC,CAAA;EAE9F,MAAMgB,KAAA,GAASC,OAAA,IAAyC;IAAA;IAAAlB,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAC,CAAA;IAAA;MAAE,GAAGU,KAAK;MAAE,GAAGO;IAAQ;EAAA;EAAA;EAAAlB,cAAA,GAAAC,CAAA;EAE/E,MAAMkB,qBAAA,GAAyBD,OAAA;IAAA;IAAAlB,cAAA,GAAAU,CAAA;IAC7B,MAAMU,IAAA;IAAA;IAAA,CAAApB,cAAA,GAAAC,CAAA,QAAOgB,KAAA,CAAMC,OAAA;IAAA;IAAAlB,cAAA,GAAAC,CAAA;IACnBW,QAAA,CAASQ,IAAA;IAAA;IAAApB,cAAA,GAAAC,CAAA;IACTQ,QAAA,CAASW,IAAA;EACX;EAAA;EAAApB,cAAA,GAAAC,CAAA;EAEA,MAAMoB,WAAA,GAAcA,CAAA;IAAA;IAAArB,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAC,CAAA;IAClBQ,QAAA,CAASE,KAAA;EACX;EAAA;EAAAX,cAAA,GAAAC,CAAA;EAEA,MAAMqB,WAAA,GAAcA,CAAA;IAAA;IAAAtB,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAC,CAAA;IAClBW,QAAA,CAASb,aAAA;IAAA;IAAAC,cAAA,GAAAC,CAAA;IACTQ,QAAA,CAASV,aAAA;EACX;EAAA;EAAAC,cAAA,GAAAC,CAAA;EAEA,oBACE,IAAAsB,WAAA,CAAAC,IAAA,EAAC;IAAI,eAAY;IAAiB,cAAW;4BAE3C,IAAAD,WAAA,CAAAC,IAAA,EAAC;iBAAM,M,aAEL,IAAAD,WAAA,CAAAC,IAAA,EAAC;QACC,eAAY;QACZhB,KAAA,EAAOG,KAAA,CAAMT,MAAM;QACnBO,QAAA,EAAWgB,CAAA,IAAM;UAAA;UAAAzB,cAAA,GAAAU,CAAA;UAAAV,cAAA,GAAAC,CAAA;UAAA,OAAAkB,qBAAA,CAAsB;YAAEjB,MAAA,EAAQuB,CAAA,CAAEC,MAAM,CAAClB;UAAqC;QAAA;gCAE/F,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAM;yBACpB,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAO;yBACrB,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAc;yBAC5B,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAW;yBACzB,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAS;;;qBAK3B,IAAAe,WAAA,CAAAC,IAAA,EAAC;iBAAM,O,aAEL,IAAAD,WAAA,CAAAC,IAAA,EAAC;QACC,eAAY;QACZhB,KAAA,EAAOG,KAAA,CAAMR,QAAQ;QACrBM,QAAA,EAAWgB,CAAA,IAAM;UAAA;UAAAzB,cAAA,GAAAU,CAAA;UAAAV,cAAA,GAAAC,CAAA;UAAA,OAAAkB,qBAAA,CAAsB;YAAEhB,QAAA,EAAUsB,CAAA,CAAEC,MAAM,CAAClB;UAAuC;QAAA;gCAEnG,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAM;yBACpB,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAK;yBACnB,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAK;yBACnB,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAK;yBACnB,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAK;;;qBAKvB,IAAAe,WAAA,CAAAC,IAAA,EAAC;iBAAM,O,aAEL,IAAAD,WAAA,CAAAI,GAAA,EAAC;QACC,eAAY;QACZC,IAAA,EAAK;QACLpB,KAAA,EAAOG,KAAA,CAAMP,OAAO;QACpBK,QAAA,EAAWgB,CAAA,IAAM;UAAA;UAAAzB,cAAA,GAAAU,CAAA;UAAAV,cAAA,GAAAC,CAAA;UAAA,OAAAW,QAAA,CAASK,KAAA,CAAM;YAAEb,OAAA,EAASqB,CAAA,CAAEC,MAAM,CAAClB;UAAM;QAAA;QAC1DqB,WAAA,EAAY;;qBAKhB,IAAAN,WAAA,CAAAC,IAAA,EAAC;iBAAM,Q,aAEL,IAAAD,WAAA,CAAAI,GAAA,EAAC;QACC,eAAY;QACZC,IAAA,EAAK;QACLpB,KAAA,EAAOG,KAAA,CAAMN,SAAS;QACtBI,QAAA,EAAWgB,CAAA,IAAM;UAAA;UAAAzB,cAAA,GAAAU,CAAA;UAAAV,cAAA,GAAAC,CAAA;UAAA,OAAAW,QAAA,CAASK,KAAA,CAAM;YAAEZ,SAAA,EAAWoB,CAAA,CAAEC,MAAM,CAAClB;UAAM;QAAA;;qBAGhE,IAAAe,WAAA,CAAAC,IAAA,EAAC;iBAAM,Q,aAEL,IAAAD,WAAA,CAAAI,GAAA,EAAC;QACC,eAAY;QACZC,IAAA,EAAK;QACLpB,KAAA,EAAOG,KAAA,CAAML,OAAO;QACpBG,QAAA,EAAWgB,CAAA,IAAM;UAAA;UAAAzB,cAAA,GAAAU,CAAA;UAAAV,cAAA,GAAAC,CAAA;UAAA,OAAAW,QAAA,CAASK,KAAA,CAAM;YAAEX,OAAA,EAASmB,CAAA,CAAEC,MAAM,CAAClB;UAAM;QAAA;;qBAK9D,IAAAe,WAAA,CAAAC,IAAA,EAAC;iBAAM,M,aAEL,IAAAD,WAAA,CAAAC,IAAA,EAAC;QACC,eAAY;QACZhB,KAAA,EAAOG,KAAA,CAAMJ,MAAM;QACnBE,QAAA,EAAWgB,CAAA,IAAM;UAAA;UAAAzB,cAAA,GAAAU,CAAA;UAAAV,cAAA,GAAAC,CAAA;UAAA,OAAAkB,qBAAA,CAAsB;YAAEZ,MAAA,EAAQkB,CAAA,CAAEC,MAAM,CAAClB;UAAqC;QAAA;gCAE/F,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAiB;yBAC/B,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAgB;yBAC9B,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAgB;yBAC9B,IAAAe,WAAA,CAAAI,GAAA,EAAC;UAAOnB,KAAA,EAAM;oBAAe;;;qBAKjC,IAAAe,WAAA,CAAAC,IAAA,EAAC;MAAIM,KAAA,EAAO;QAAEC,OAAA,EAAS;QAAeC,GAAA,EAAK;QAAGC,UAAA,EAAY;MAAE;8BAC1D,IAAAV,WAAA,CAAAI,GAAA,EAAC;QAAO,eAAY;QAAmBO,OAAA,EAASb,WAAA;kBAAa;uBAC7D,IAAAE,WAAA,CAAAI,GAAA,EAAC;QAAO,eAAY;QAAmBO,OAAA,EAASZ,WAAA;kBAAa;;;;AAIrE","ignoreList":[]}