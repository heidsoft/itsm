{"version":3,"names":["cov_w6hg3w1z2","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","s","f","b","inputSourceMap","version","sources","sourcesContent","names","mappings","_coverageSchema","coverage","actualCoverage","TicketAssignmentApi","autoAssign","ticketId","_httpclient","httpClient","post","getRecommendations","get","listRules","getRule","ruleId","createRule","data","updateRule","put","deleteRule","delete","testRule"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-prototype/src/lib/api/ticket-assignment-api.ts"],"sourcesContent":["/**\n * 工单智能分配API\n * 提供自动分配、分配推荐、分配规则管理功能\n */\n\nimport { httpClient } from './http-client';\n\nexport interface AssignRecommendation {\n  user_id: number;\n  user_name: string;\n  user_email?: string;\n  user_avatar?: string;\n  score: number;\n  reason: string;\n  factors: {\n    skill_match?: number;\n    workload?: number;\n    history_success?: number;\n    availability?: number;\n  };\n}\n\nexport interface AutoAssignResponse {\n  ticket_id: number;\n  assigned_to?: number;\n  assignment_type: 'rule' | 'smart' | 'manual';\n  reason: string;\n  score?: number;\n}\n\n// 条件配置类型\nexport interface ConditionConfig {\n  field: string;\n  operator: 'equals' | 'not_equals' | 'contains' | 'not_contains' | 'greater_than' | 'less_than' | 'in' | 'not_in';\n  value: string | number | boolean | string[] | number[];\n}\n\n// 动作配置类型\nexport interface ActionConfig {\n  type: 'assign' | 'set_priority' | 'set_status' | 'notify' | 'escalate';\n  params: {\n    assignee_id?: number;\n    priority?: string;\n    status?: string;\n    notify_users?: number[];\n    escalation_level?: number;\n  };\n}\n\nexport interface AssignmentRule {\n  id: number;\n  name: string;\n  description?: string;\n  priority: number;\n  conditions: ConditionConfig[];\n  actions: ActionConfig[];\n  is_active: boolean;\n  execution_count: number;\n  last_executed_at?: string;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface CreateAssignmentRuleRequest {\n  name: string;\n  description?: string;\n  priority: number;\n  conditions: ConditionConfig[];\n  actions: ActionConfig[];\n  is_active: boolean;\n}\n\nexport interface UpdateAssignmentRuleRequest {\n  name?: string;\n  description?: string;\n  priority?: number;\n  conditions?: ConditionConfig[];\n  actions?: ActionConfig[];\n  is_active?: boolean;\n}\n\nexport interface TestAssignmentRuleRequest {\n  rule_id: number;\n  ticket_id: number;\n}\n\nexport interface TestAssignmentRuleResponse {\n  matched: boolean;\n  assigned_to?: number;\n  reason?: string;\n  score?: number;\n}\n\nexport interface GetAssignRecommendationsResponse {\n  recommendations: AssignRecommendation[];\n  total: number;\n}\n\nexport interface ListAssignmentRulesResponse {\n  rules: AssignmentRule[];\n  total: number;\n}\n\nexport class TicketAssignmentApi {\n  /**\n   * 自动分配工单\n   */\n  static async autoAssign(ticketId: number): Promise<AutoAssignResponse> {\n    return httpClient.post<AutoAssignResponse>(`/api/v1/tickets/${ticketId}/auto-assign`);\n  }\n\n  /**\n   * 获取分配推荐\n   */\n  static async getRecommendations(ticketId: number): Promise<GetAssignRecommendationsResponse> {\n    return httpClient.get<GetAssignRecommendationsResponse>(`/api/v1/tickets/assign-recommendations/${ticketId}`);\n  }\n\n  /**\n   * 获取分配规则列表\n   */\n  static async listRules(): Promise<ListAssignmentRulesResponse> {\n    return httpClient.get<ListAssignmentRulesResponse>('/api/v1/tickets/assignment-rules');\n  }\n\n  /**\n   * 获取分配规则详情\n   */\n  static async getRule(ruleId: number): Promise<AssignmentRule> {\n    return httpClient.get<AssignmentRule>(`/api/v1/tickets/assignment-rules/${ruleId}`);\n  }\n\n  /**\n   * 创建分配规则\n   */\n  static async createRule(data: CreateAssignmentRuleRequest): Promise<AssignmentRule> {\n    return httpClient.post<AssignmentRule>('/api/v1/tickets/assignment-rules', data);\n  }\n\n  /**\n   * 更新分配规则\n   */\n  static async updateRule(ruleId: number, data: UpdateAssignmentRuleRequest): Promise<AssignmentRule> {\n    return httpClient.put<AssignmentRule>(`/api/v1/tickets/assignment-rules/${ruleId}`, data);\n  }\n\n  /**\n   * 删除分配规则\n   */\n  static async deleteRule(ruleId: number): Promise<void> {\n    return httpClient.delete(`/api/v1/tickets/assignment-rules/${ruleId}`);\n  }\n\n  /**\n   * 测试分配规则\n   */\n  static async testRule(data: TestAssignmentRuleRequest): Promise<TestAssignmentRuleResponse> {\n    return httpClient.post<TestAssignmentRuleResponse>('/api/v1/tickets/assignment-rules/test', data);\n  }\n}\n\n"],"mappings":"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","ignoreList":[]}