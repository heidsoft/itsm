{"version":3,"names":["MainLayout","Content","cov_1qe30cci8g","s","_antd","Layout","children","f","collapsed","setCollapsed","_react","useState","mounted","setMounted","pathname","_navigation","usePathname","router","useRouter","useEffect","b","_authservice","AuthService","isAuthenticated","push","handleResize","window","innerWidth","addEventListener","removeEventListener","handleContentClick","_jsxruntime","jsx","ConfigProvider","locale","_zh_CN","default","App","jsxs","style","minHeight","_Sidebar","Sidebar","onCollapse","marginLeft","_layoutconfig","LAYOUT_CONFIG","sider","collapsedWidth","width","transition","_Header","Header","showBreadcrumb","onClick","margin","padding","background","borderRadius","boxShadow","textAlign","color","fontSize","Date","getFullYear","position","top","left","right","bottom","backgroundColor","zIndex"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-prototype/src/app/(main)/layout.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { Layout, ConfigProvider, App } from 'antd';\nimport zhCN from 'antd/locale/zh_CN';\nimport { usePathname, useRouter } from 'next/navigation';\nimport { Header } from '@/components/layout/Header';\nimport { Sidebar } from '@/components/layout/Sidebar';\nimport { AuthService } from '@/lib/services/auth-service';\nimport { LAYOUT_CONFIG } from '@/config/layout.config';\n\nconst { Content } = Layout;\n\n/**\n * 主应用布局\n * 包含 Header、Sidebar 和 Content 区域\n * 需要用户认证才能访问\n */\nexport default function MainLayout({\n  children,\n}: Readonly<{\n  children: React.ReactNode;\n}>) {\n  const [collapsed, setCollapsed] = useState(false);\n  const [mounted, setMounted] = useState(false);\n  const pathname = usePathname();\n  const router = useRouter();\n\n  // 处理客户端挂载\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  // 认证检查\n  useEffect(() => {\n    if (mounted && !AuthService.isAuthenticated()) {\n      router.push('/login');\n    }\n  }, [mounted, router]);\n\n  // 响应式布局：在移动端自动折叠侧边栏\n  useEffect(() => {\n    const handleResize = () => {\n      if (window.innerWidth < 768) {\n        setCollapsed(true);\n      }\n    };\n\n    handleResize();\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // 在移动端，点击内容区域时折叠侧边栏\n  const handleContentClick = () => {\n    if (window.innerWidth < 768 && !collapsed) {\n      setCollapsed(true);\n    }\n  };\n\n  // 未挂载时显示 loading（避免服务端渲染问题）\n  if (!mounted) {\n    return null;\n  }\n\n  return (\n    <ConfigProvider locale={zhCN}>\n      <App>\n        <Layout style={{ minHeight: '100vh' }}>\n          {/* 侧边栏 */}\n          <Sidebar collapsed={collapsed} onCollapse={setCollapsed} />\n\n          {/* 主内容区域 */}\n          <Layout\n            style={{\n              marginLeft: collapsed\n                ? LAYOUT_CONFIG.sider.collapsedWidth\n                : LAYOUT_CONFIG.sider.width,\n              transition: 'margin-left 0.2s',\n            }}\n          >\n            {/* 顶部导航栏 */}\n            <Header collapsed={collapsed} onCollapse={setCollapsed} showBreadcrumb={true} />\n\n            {/* 内容区域 */}\n            <Content\n              onClick={handleContentClick}\n              style={{\n                margin: '16px',\n                padding: '24px',\n                background: '#ffffff',\n                borderRadius: '8px',\n                minHeight: 'calc(100vh - 56px - 32px)', // 减去 header 高度和 margin\n                boxShadow: '0 1px 2px 0 rgba(0, 0, 0, 0.05)',\n              }}\n            >\n              {children}\n            </Content>\n\n            {/* 页脚（可选） */}\n            <footer\n              style={{\n                textAlign: 'center',\n                padding: '16px',\n                background: 'transparent',\n                color: '#9ca3af',\n                fontSize: '12px',\n              }}\n            >\n              ITSM Platform ©{new Date().getFullYear()} - IT服务管理平台\n            </footer>\n          </Layout>\n\n          {/* 移动端遮罩层 */}\n          {!collapsed && window.innerWidth < 768 && (\n            <div\n              onClick={() => setCollapsed(true)}\n              style={{\n                position: 'fixed',\n                top: 0,\n                left: 0,\n                right: 0,\n                bottom: 0,\n                backgroundColor: 'rgba(0, 0, 0, 0.45)',\n                zIndex: LAYOUT_CONFIG.zIndex.sider - 1,\n              }}\n            />\n          )}\n        </Layout>\n      </App>\n    </ConfigProvider>\n  );\n}\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}