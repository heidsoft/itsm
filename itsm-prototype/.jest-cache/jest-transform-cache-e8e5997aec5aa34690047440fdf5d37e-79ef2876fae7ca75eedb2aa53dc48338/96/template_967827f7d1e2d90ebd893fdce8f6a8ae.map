{"version":3,"names":["cov_j7zdajz0","actualCoverage","s","FieldType","f","TemplateVisibility"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-prototype/src/types/template.ts"],"sourcesContent":["/**\n * 工单模板增强类型定义\n * 遵循设计文档规范，支持高级字段配置、条件显示、版本控制等\n */\n\n// ==================== 字段类型枚举 ====================\n\nexport enum FieldType {\n  // 基础类型\n  TEXT = 'text',\n  TEXTAREA = 'textarea',\n  NUMBER = 'number',\n  DATE = 'date',\n  DATETIME = 'datetime',\n  TIME = 'time',\n  \n  // 选择类型\n  SELECT = 'select',\n  MULTI_SELECT = 'multi_select',\n  RADIO = 'radio',\n  CHECKBOX = 'checkbox',\n  \n  // 高级类型\n  USER_PICKER = 'user_picker',\n  DEPARTMENT_PICKER = 'department_picker',\n  FILE_UPLOAD = 'file_upload',\n  RICH_TEXT = 'rich_text',\n  CASCADER = 'cascader',\n  RATING = 'rating',\n  SLIDER = 'slider',\n  COLOR_PICKER = 'color_picker',\n  \n  // 特殊类型\n  DIVIDER = 'divider',\n  SECTION_TITLE = 'section_title',\n}\n\n// ==================== 字段验证 ====================\n\nexport interface FieldValidation {\n  min?: number;                      // 最小值/最小长度\n  max?: number;                      // 最大值/最大长度\n  pattern?: string;                  // 正则表达式\n  customMessage?: string;            // 自定义错误消息\n  minLength?: number;                // 最小字符长度\n  maxLength?: number;                // 最大字符长度\n  minValue?: number;                 // 最小数值\n  maxValue?: number;                 // 最大数值\n  email?: boolean;                   // 邮箱格式\n  url?: boolean;                     // URL格式\n  phone?: boolean;                   // 电话格式\n  custom?: (value: any) => boolean | string; // 自定义验证函数\n}\n\n// ==================== 字段选项 ====================\n\nexport interface FieldOption {\n  label: string;\n  value: string | number;\n  color?: string;\n  icon?: string;\n  disabled?: boolean;\n  children?: FieldOption[];         // 级联选择子选项\n}\n\n// ==================== 条件显示 ====================\n\nexport interface FieldConditional {\n  field: string;                     // 依赖字段ID\n  operator: 'equals' | 'not_equals' | 'contains' | 'not_contains' | 'greater_than' | 'less_than' | 'in' | 'not_in';\n  value: any;                        // 比较值\n  and?: FieldConditional[];          // AND 条件组\n  or?: FieldConditional[];           // OR 条件组\n}\n\n// ==================== 模板字段 ====================\n\nexport interface TemplateField {\n  id: string;                        // 字段唯一ID\n  name: string;                      // 字段名称（数据库字段名）\n  label: string;                     // 字段标签（显示名称）\n  type: FieldType;                   // 字段类型\n  required: boolean;                 // 是否必填\n  defaultValue?: any;                // 默认值\n  placeholder?: string;              // 占位符\n  helpText?: string;                 // 帮助文本\n  tooltip?: string;                  // 工具提示\n  validation?: FieldValidation;      // 验证规则\n  options?: FieldOption[];           // 选项（下拉、单选、多选）\n  conditional?: FieldConditional;    // 条件显示\n  order: number;                     // 排序\n  width?: number | string;           // 字段宽度（栅格）\n  disabled?: boolean;                // 是否禁用\n  hidden?: boolean;                  // 是否隐藏\n  \n  // 高级配置\n  maxFileSize?: number;              // 文件最大大小（字节）\n  acceptedFileTypes?: string[];      // 接受的文件类型\n  multiple?: boolean;                // 是否多选（文件上传、用户选择等）\n  showSearch?: boolean;              // 是否显示搜索（选择器）\n  allowClear?: boolean;              // 是否允许清空\n  \n  // 富文本配置\n  richTextConfig?: {\n    toolbar?: string[];              // 工具栏配置\n    height?: number;                 // 编辑器高度\n    plugins?: string[];              // 插件\n  };\n  \n  // 级联选择配置\n  cascaderConfig?: {\n    changeOnSelect?: boolean;\n    showSearch?: boolean;\n    loadData?: (selectedOptions: FieldOption[]) => Promise<void>;\n  };\n}\n\n// ==================== 模板类别 ====================\n\nexport interface TemplateCategory {\n  id: string;\n  name: string;\n  description?: string;\n  icon?: string;\n  color?: string;\n  parentId?: string;\n  order: number;\n  isActive: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\n// ==================== 模板权限 ====================\n\nexport enum TemplateVisibility {\n  PUBLIC = 'public',                 // 公开（所有人可见）\n  PRIVATE = 'private',               // 私有（仅创建人可见）\n  DEPARTMENT = 'department',         // 部门（指定部门可见）\n  ROLE = 'role',                     // 角色（指定角色可见）\n  TEAM = 'team',                     // 团队（指定团队可见）\n}\n\nexport interface TemplatePermission {\n  visibility: TemplateVisibility;\n  allowedDepartments?: string[];     // 允许的部门IDs\n  allowedRoles?: string[];           // 允许的角色IDs\n  allowedTeams?: string[];           // 允许的团队IDs\n  allowedUsers?: string[];           // 允许的用户IDs\n  denyDepartments?: string[];        // 拒绝的部门IDs\n  denyRoles?: string[];              // 拒绝的角色IDs\n  denyUsers?: string[];              // 拒绝的用户IDs\n}\n\n// ==================== 模板默认值 ====================\n\nexport interface TemplateDefaults {\n  type?: string;                     // 工单类型\n  priority?: string;                 // 优先级\n  category?: string;                 // 分类\n  assigneeId?: string;               // 默认处理人\n  teamId?: string;                   // 默认团队\n  tags?: string[];                   // 默认标签\n  slaId?: string;                    // SLA配置\n  [key: string]: any;                // 其他自定义默认值\n}\n\n// ==================== 模板自动化 ====================\n\nexport interface TemplateAutomation {\n  autoAssign?: boolean;              // 自动分配\n  assignmentRule?: {\n    type: 'round_robin' | 'load_balance' | 'skill_based' | 'random';\n    targetTeamId?: string;\n    targetUserIds?: string[];\n    skillTags?: string[];\n  };\n  \n  requiresApproval?: boolean;        // 需要审批\n  approvalWorkflow?: {\n    workflowId?: string;\n    approvalLevel: 'none' | 'manager' | 'director' | 'executive' | 'custom';\n    approvers?: string[];            // 审批人IDs\n    approvalType: 'sequential' | 'parallel' | 'any_one';\n  };\n  \n  autoNotify?: boolean;              // 自动通知\n  notificationRules?: {\n    recipients?: string[];           // 收件人IDs\n    channels?: ('email' | 'sms' | 'in_app' | 'webhook')[];\n    template?: string;               // 通知模板\n    triggerEvents?: string[];        // 触发事件\n  }[];\n  \n  autoTag?: boolean;                 // 自动标签\n  tagRules?: {\n    condition?: string;              // 条件表达式\n    tags?: string[];\n  }[];\n}\n\n// ==================== 模板版本 ====================\n\nexport interface TemplateVersion {\n  version: string;                   // 版本号（如 1.0.0）\n  changelog?: string;                // 变更日志\n  createdBy: string;                 // 创建人ID\n  createdAt: string;                 // 创建时间\n  isPublished: boolean;              // 是否已发布\n  isDraft: boolean;                  // 是否草稿\n}\n\n// ==================== 工单模板 ====================\n\nexport interface TicketTemplate {\n  // 基础信息\n  id: string;                        // 模板ID (UUID)\n  name: string;                      // 模板名称\n  description: string;               // 模板描述\n  categoryId: string;                // 分类ID\n  icon?: string;                     // 图标URL或图标名称\n  coverImage?: string;               // 封面图URL\n  color?: string;                    // 主题颜色\n  \n  // 字段配置\n  fields: TemplateField[];           // 字段列表\n  \n  // 默认值\n  defaults: TemplateDefaults;        // 默认值配置\n  \n  // 权限配置\n  permission: TemplatePermission;    // 权限配置\n  \n  // 自动化配置\n  automation?: TemplateAutomation;   // 自动化配置\n  \n  // 版本控制\n  version: string;                   // 当前版本\n  versionHistory?: TemplateVersion[]; // 版本历史\n  \n  // 状态和元数据\n  isActive: boolean;                 // 是否启用\n  isDraft: boolean;                  // 是否草稿\n  isArchived: boolean;               // 是否归档\n  usageCount: number;                // 使用次数\n  rating: number;                    // 平均评分\n  ratingCount: number;               // 评分人数\n  \n  // 审计字段\n  createdBy: string;                 // 创建人ID\n  createdAt: string;                 // 创建时间\n  updatedBy?: string;                // 更新人ID\n  updatedAt: string;                 // 更新时间\n  publishedAt?: string;              // 发布时间\n  publishedBy?: string;              // 发布人ID\n  \n  // 扩展字段\n  metadata?: Record<string, any>;    // 元数据\n  tags?: string[];                   // 标签\n}\n\n// ==================== API请求/响应类型 ====================\n\nexport interface CreateTemplateRequest {\n  name: string;\n  description: string;\n  categoryId: string;\n  fields: TemplateField[];\n  defaults?: TemplateDefaults;\n  permission?: TemplatePermission;\n  automation?: TemplateAutomation;\n  icon?: string;\n  coverImage?: string;\n  color?: string;\n  tags?: string[];\n}\n\nexport interface UpdateTemplateRequest extends Partial<CreateTemplateRequest> {\n  isActive?: boolean;\n  isDraft?: boolean;\n  version?: string;\n}\n\nexport interface TemplateListQuery {\n  // 分页\n  page?: number;\n  pageSize?: number;\n  \n  // 搜索\n  search?: string;\n  \n  // 筛选\n  categoryId?: string;\n  visibility?: TemplateVisibility;\n  isActive?: boolean;\n  isDraft?: boolean;\n  isArchived?: boolean;\n  tags?: string[];\n  \n  // 排序\n  sortBy?: 'name' | 'usageCount' | 'rating' | 'createdAt' | 'updatedAt';\n  sortOrder?: 'asc' | 'desc';\n  \n  // 权限筛选\n  userId?: string;                   // 当前用户ID，用于权限过滤\n}\n\nexport interface TemplateListResponse {\n  templates: TicketTemplate[];\n  total: number;\n  page: number;\n  pageSize: number;\n  totalPages: number;\n}\n\nexport interface CreateTicketFromTemplateRequest {\n  templateId: string;\n  fieldValues: Record<string, any>; // 字段值\n  overrides?: {                     // 覆盖默认值\n    priority?: string;\n    assigneeId?: string;\n    teamId?: string;\n    tags?: string[];\n    [key: string]: any;\n  };\n}\n\nexport interface TemplateUsageStats {\n  templateId: string;\n  usageCount: number;\n  lastUsedAt?: string;\n  avgCreationTime: number;          // 平均创建时间（秒）\n  successRate: number;               // 成功率（%）\n  topUsers: Array<{\n    userId: string;\n    username: string;\n    count: number;\n  }>;\n  usageByDate: Array<{\n    date: string;\n    count: number;\n  }>;\n}\n\nexport interface TemplateRating {\n  templateId: string;\n  userId: string;\n  rating: number;                    // 1-5星\n  comment?: string;\n  createdAt: string;\n}\n\nexport interface TemplateDuplicateRequest {\n  templateId: string;\n  newName: string;\n  copyFields?: boolean;\n  copyAutomation?: boolean;\n  copyPermission?: boolean;\n}\n\nexport interface TemplateExportFormat {\n  format: 'json' | 'yaml' | 'excel';\n  includeStats?: boolean;\n  includeVersionHistory?: boolean;\n}\n\nexport interface TemplateImportRequest {\n  format: 'json' | 'yaml' | 'excel';\n  data: string | File;\n  overwriteExisting?: boolean;\n  validateOnly?: boolean;\n}\n\nexport interface TemplateValidationResult {\n  isValid: boolean;\n  errors: Array<{\n    field: string;\n    message: string;\n    severity: 'error' | 'warning';\n  }>;\n  warnings: Array<{\n    field: string;\n    message: string;\n  }>;\n}\n\n// ==================== 字段配置器使用的辅助类型 ====================\n\nexport interface FieldDesignerConfig {\n  fieldTypes: Array<{\n    type: FieldType;\n    label: string;\n    icon: string;\n    description: string;\n    category: 'basic' | 'advanced' | 'special';\n    defaultConfig: Partial<TemplateField>;\n  }>;\n  \n  validationRules: Array<{\n    name: string;\n    label: string;\n    applicableTypes: FieldType[];\n    configType: 'boolean' | 'number' | 'string' | 'regex';\n  }>;\n}\n\n// ==================== 工具类型 ====================\n\nexport type TemplateFieldValue = string | number | boolean | string[] | number[] | Date | null;\n\nexport type TemplateFieldMap = Record<string, TemplateFieldValue>;\n\nexport interface TemplatePreview {\n  template: TicketTemplate;\n  sampleData?: TemplateFieldMap;\n}\n\n// ==================== 导出所有类型 ====================\n\nexport default TicketTemplate;\n\n"],"mappings":"AAAA;;;GAAA,CAKA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAEY;IAAAA,YAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,YAAA;AAAAA,YAAA,GAAAE,CAAA;;;;;;;;;;;;;;;;;;;;EAAAC,SAAS,WAAAA,CAAA;IAAA;IAAAH,YAAA,GAAAI,CAAA;IAAAJ,YAAA,GAAAE,CAAA;WAATC,SAAA;;EA+HAE,kBAAkB,WAAAA,CAAA;IAAA;IAAAL,YAAA,GAAAI,CAAA;IAAAJ,YAAA,GAAAE,CAAA;WAAlBG,kBAAA;;;AA/HL,IAAAF,SAAK;AAAA;AAAA,cAAAH,YAAA,GAAAE,CAAA,iBAAAC,SAAA;EAAA;EAAAH,YAAA,GAAAI,CAAA;EAAAJ,YAAA,GAAAE,CAAA;EACV;;;;;;;;;;;;;;;;;EAQA;EAAA;EAAAF,YAAA,GAAAE,CAAA;;;;;;;;;;;EAMA;EAAA;EAAAF,YAAA,GAAAE,CAAA;;;;;;;;;;;;;;;;;;;;;;;EAUA;EAAA;EAAAF,YAAA,GAAAE,CAAA;;;;;;;SAzBUC,SAAA;;AA+HL,IAAAE,kBAAK;AAAA;AAAA,cAAAL,YAAA,GAAAE,CAAA,kBAAAG,kBAAA;EAAA;EAAAL,YAAA,GAAAI,CAAA;EAAAJ,YAAA,GAAAE,CAAA;;;;;;;;;;;;;;;;SAAAG,kBAAA","ignoreList":[]}