{"version":3,"names":["cov_2o1u3asave","actualCoverage","s","ticketTemplateService","TicketTemplateService","getTemplates","params","b","f","queryParams","page","page_size","category","is_active","undefined","response","_httpclient","httpClient","get","error","console","getTemplate","id","createTemplate","data","post","updateTemplate","put","deleteTemplate","delete","toggleTemplateStatus","isActive","patch","copyTemplate","newName","name","getTemplateCategories","healthCheck","warn"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-prototype/src/lib/services/ticket-template-service.ts"],"sourcesContent":["import { httpClient } from '@/lib/api/http-client';\n\nexport interface TicketTemplate {\n  id: number;\n  name: string;\n  description: string;\n  category: string;\n  fields: TemplateField[];\n  is_active: boolean;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface TemplateField {\n  name: string;\n  label: string;\n  type: \"text\" | \"textarea\" | \"select\" | \"number\" | \"date\" | \"checkbox\";\n  required: boolean;\n  options?: string[];\n  default_value?: string;\n  validation_rules?: string[];\n}\n\nexport interface CreateTemplateRequest {\n  name: string;\n  description: string;\n  category: string;\n  fields: TemplateField[];\n}\n\nexport interface UpdateTemplateRequest {\n  name?: string;\n  description?: string;\n  category?: string;\n  fields?: TemplateField[];\n  is_active?: boolean;\n}\n\nexport interface ListTemplatesParams {\n  category?: string;\n  search?: string;\n  is_active?: boolean;\n  page?: number;\n  page_size?: number;\n}\n\nexport interface TemplateListResponse {\n  templates: TicketTemplate[];\n  total: number;\n  page: number;\n  page_size: number;\n}\n\nclass TicketTemplateService {\n  // 获取模板列表\n  async getTemplates(params: ListTemplatesParams = {}): Promise<TemplateListResponse> {\n    try {\n      // 将params对象转换为查询参数\n      const queryParams: Record<string, unknown> = {};\n      if (params.page) queryParams.page = params.page;\n      if (params.page_size) queryParams.page_size = params.page_size;\n      if (params.category) queryParams.category = params.category;\n      if (params.is_active !== undefined) queryParams.is_active = params.is_active;\n      \n      const response = await httpClient.get<TemplateListResponse>('/api/v1/ticket-templates', queryParams);\n      return response;\n    } catch (error) {\n      console.error('TicketTemplateService.getTemplates error:', error);\n      throw error;\n    }\n  }\n\n  // 获取单个模板\n  async getTemplate(id: number): Promise<TicketTemplate> {\n    try {\n      const response = await httpClient.get<TicketTemplate>(`/api/v1/ticket-templates/${id}`);\n      return response;\n    } catch (error) {\n      console.error('TicketTemplateService.getTemplate error:', error);\n      throw error;\n    }\n  }\n\n  // 创建模板\n  async createTemplate(data: CreateTemplateRequest): Promise<TicketTemplate> {\n    try {\n      const response = await httpClient.post<TicketTemplate>('/api/v1/ticket-templates', data);\n      return response;\n    } catch (error) {\n      console.error('TicketTemplateService.createTemplate error:', error);\n      throw error;\n    }\n  }\n\n  // 更新模板\n  async updateTemplate(id: number, data: UpdateTemplateRequest): Promise<TicketTemplate> {\n    try {\n      const response = await httpClient.put<TicketTemplate>(`/api/v1/ticket-templates/${id}`, data);\n      return response;\n    } catch (error) {\n      console.error('TicketTemplateService.updateTemplate error:', error);\n      throw error;\n    }\n  }\n\n  // 删除模板\n  async deleteTemplate(id: number): Promise<void> {\n    try {\n      await httpClient.delete(`/api/v1/ticket-templates/${id}`);\n    } catch (error) {\n      console.error('TicketTemplateService.deleteTemplate error:', error);\n      throw error;\n    }\n  }\n\n  // 激活/停用模板\n  async toggleTemplateStatus(id: number, isActive: boolean): Promise<TicketTemplate> {\n    try {\n      const response = await httpClient.patch<TicketTemplate>(`/api/v1/ticket-templates/${id}/status`, {\n        is_active: isActive\n      });\n      return response;\n    } catch (error) {\n      console.error('TicketTemplateService.toggleTemplateStatus error:', error);\n      throw error;\n    }\n  }\n\n  // 复制模板\n  async copyTemplate(id: number, newName: string): Promise<TicketTemplate> {\n    try {\n      const response = await httpClient.post<TicketTemplate>(`/api/v1/ticket-templates/${id}/copy`, {\n        name: newName\n      });\n      return response;\n    } catch (error) {\n      console.error('TicketTemplateService.copyTemplate error:', error);\n      throw error;\n    }\n  }\n\n  // 获取模板分类\n  async getTemplateCategories(): Promise<string[]> {\n    try {\n      const response = await httpClient.get<string[]>('/api/v1/ticket-templates/categories');\n      return response;\n    } catch (error) {\n      console.error('TicketTemplateService.getTemplateCategories error:', error);\n      throw error;\n    }\n  }\n\n  // 健康检查\n  async healthCheck(): Promise<boolean> {\n    try {\n      await httpClient.get('/api/v1/health');\n      return true;\n    } catch (error) {\n      console.warn('TicketTemplateService health check failed:', error);\n      return false;\n    }\n  }\n}\n\nexport const ticketTemplateService = new TicketTemplateService();\n"],"mappings":"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","ignoreList":[]}