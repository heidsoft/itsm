{"version":3,"names":["cov_1045irldp8","actualCoverage","s","useChangesData","f","changes","setChanges","_react","useState","loading","setLoading","stats","setStats","total","draft","pending","approved","implementing","completed","cancelled","filter","setFilter","searchText","setSearchText","pagination","setPagination","current","pageSize","mockChanges","id","title","description","justification","status","priority","type","impactScope","riskLevel","createdBy","createdByName","assigneeName","tenantId","plannedStartDate","plannedEndDate","implementationPlan","rollbackPlan","createdAt","updatedAt","mockStats","fetchChanges","Promise","resolve","setTimeout","prev","length","error","console","fetchStats","useEffect","handleTableChange","paginationInfo"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-prototype/src/app/(main)/changes/hooks/useChangesData.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { Change, ChangeStats } from '@/lib/services/change-service';\n\nexport const useChangesData = () => {\n  const [changes, setChanges] = useState<Change[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [stats, setStats] = useState<ChangeStats>({\n    total: 0,\n    draft: 0,\n    pending: 0,\n    approved: 0,\n    implementing: 0,\n    completed: 0,\n    cancelled: 0,\n  });\n  const [filter, setFilter] = useState('全部');\n  const [searchText, setSearchText] = useState('');\n  const [pagination, setPagination] = useState({ current: 1, pageSize: 10, total: 0 });\n\n  const mockChanges: Change[] = [\n    {\n      id: 1,\n      title: '系统升级变更',\n      description: '升级核心系统版本',\n      justification: '提升系统性能和安全性',\n      status: 'pending',\n      priority: 'high',\n      type: 'standard',\n      impactScope: 'high',\n      riskLevel: 'medium',\n      createdBy: 1,\n      createdByName: '张三',\n      assigneeName: '李四',\n      tenantId: 1,\n      plannedStartDate: '2024-01-15T09:00:00Z',\n      plannedEndDate: '2024-01-15T18:00:00Z',\n      implementationPlan: '系统升级实施计划',\n      rollbackPlan: '系统回滚计划',\n      createdAt: '2024-01-10T10:00:00Z',\n      updatedAt: '2024-01-10T10:00:00Z',\n    },\n    {\n      id: 2,\n      title: '数据库配置变更',\n      description: '调整数据库连接池配置',\n      justification: '优化数据库性能',\n      status: 'approved',\n      priority: 'medium',\n      type: 'normal',\n      impactScope: 'medium',\n      riskLevel: 'low',\n      createdBy: 2,\n      createdByName: '王五',\n      assigneeName: '赵六',\n      tenantId: 1,\n      plannedStartDate: '2024-01-16T14:00:00Z',\n      plannedEndDate: '2024-01-16T16:00:00Z',\n      implementationPlan: '数据库配置变更计划',\n      rollbackPlan: '数据库配置回滚计划',\n      createdAt: '2024-01-12T14:30:00Z',\n      updatedAt: '2024-01-12T14:30:00Z',\n    },\n  ];\n\n  const mockStats: ChangeStats = {\n    total: 156,\n    draft: 12,\n    pending: 23,\n    approved: 45,\n    implementing: 18,\n    completed: 88,\n    cancelled: 5,\n  };\n\n  const fetchChanges = async () => {\n    try {\n      setLoading(true);\n      // 模拟API调用\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      setChanges(mockChanges);\n      setPagination(prev => ({ ...prev, total: mockChanges.length }));\n    } catch (error) {\n      console.error('获取变更列表失败:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchStats = async () => {\n    try {\n      // 模拟API调用\n      await new Promise(resolve => setTimeout(resolve, 500));\n      setStats(mockStats);\n    } catch (error) {\n      console.error('获取统计数据失败:', error);\n    }\n  };\n\n  useEffect(() => {\n    fetchChanges();\n    fetchStats();\n  }, []);\n\n  const handleTableChange = (paginationInfo: {\n    current?: number;\n    pageSize?: number;\n    total?: number;\n  }) => {\n    setPagination(prev => ({ ...prev, ...paginationInfo }));\n    fetchChanges();\n  };\n\n  return {\n    changes,\n    loading,\n    stats,\n    filter,\n    setFilter,\n    searchText,\n    setSearchText,\n    pagination,\n    handleTableChange,\n    fetchChanges,\n  };\n};\n"],"mappings":"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","ignoreList":[]}