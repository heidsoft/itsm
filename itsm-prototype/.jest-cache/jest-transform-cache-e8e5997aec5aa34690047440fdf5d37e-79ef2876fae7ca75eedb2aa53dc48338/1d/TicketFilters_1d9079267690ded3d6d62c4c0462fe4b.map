{"version":3,"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-prototype/src/app/components/TicketFilters.tsx"],"sourcesContent":["import React from 'react';\n\nexport type TicketFilterState = {\n  status: 'all' | 'open' | 'in_progress' | 'resolved' | 'closed';\n  priority: 'all' | 'p1' | 'p2' | 'p3' | 'p4';\n  keyword: string;\n  dateStart: string; // YYYY-MM-DD\n  dateEnd: string;   // YYYY-MM-DD\n  sortBy: 'createdAt_desc' | 'createdAt_asc' | 'priority_desc' | 'priority_asc';\n};\n\ninterface Props {\n  value: TicketFilterState;\n  onChange: (next: TicketFilterState) => void;\n}\n\nconst DEFAULT_VALUE: TicketFilterState = {\n  status: 'all',\n  priority: 'all',\n  keyword: '',\n  dateStart: '',\n  dateEnd: '',\n  sortBy: 'createdAt_desc',\n};\n\n// 组件策略：\n// - 下拉选择（状态、优先级、排序）即时触发 onChange\n// - 文本与日期输入在“应用”按钮点击时提交\n// - “重置”按钮恢复默认并触发 onChange\nexport default function TicketFilters({ value, onChange }: Props) {\n  const [local, setLocal] = React.useState<TicketFilterState>(value);\n\n  React.useEffect(() => {\n    setLocal(value);\n  }, [value.status, value.priority, value.keyword, value.dateStart, value.dateEnd, value.sortBy]);\n\n  const patch = (partial: Partial<TicketFilterState>) => ({ ...local, ...partial }) as TicketFilterState;\n\n  const handleImmediateChange = (partial: Partial<TicketFilterState>) => {\n    const next = patch(partial);\n    setLocal(next);\n    onChange(next);\n  };\n\n  const handleApply = () => {\n    onChange(local);\n  };\n\n  const handleReset = () => {\n    setLocal(DEFAULT_VALUE);\n    onChange(DEFAULT_VALUE);\n  };\n\n  return (\n    <div data-testid=\"ticket-filters\" aria-label=\"工单过滤与排序\">\n      {/* 状态 */}\n      <label>\n        状态\n        <select\n          data-testid=\"filter-status-select\"\n          value={local.status}\n          onChange={(e) => handleImmediateChange({ status: e.target.value as TicketFilterState['status'] })}\n        >\n          <option value=\"all\">全部</option>\n          <option value=\"open\">待处理</option>\n          <option value=\"in_progress\">处理中</option>\n          <option value=\"resolved\">已解决</option>\n          <option value=\"closed\">已关闭</option>\n        </select>\n      </label>\n\n      {/* 优先级 */}\n      <label>\n        优先级\n        <select\n          data-testid=\"filter-priority-select\"\n          value={local.priority}\n          onChange={(e) => handleImmediateChange({ priority: e.target.value as TicketFilterState['priority'] })}\n        >\n          <option value=\"all\">全部</option>\n          <option value=\"p1\">P1</option>\n          <option value=\"p2\">P2</option>\n          <option value=\"p3\">P3</option>\n          <option value=\"p4\">P4</option>\n        </select>\n      </label>\n\n      {/* 关键字 */}\n      <label>\n        关键字\n        <input\n          data-testid=\"filter-keyword-input\"\n          type=\"text\"\n          value={local.keyword}\n          onChange={(e) => setLocal(patch({ keyword: e.target.value }))}\n          placeholder=\"搜索标题或描述\"\n        />\n      </label>\n\n      {/* 日期范围 */}\n      <label>\n        开始日期\n        <input\n          data-testid=\"filter-date-start\"\n          type=\"date\"\n          value={local.dateStart}\n          onChange={(e) => setLocal(patch({ dateStart: e.target.value }))}\n        />\n      </label>\n      <label>\n        结束日期\n        <input\n          data-testid=\"filter-date-end\"\n          type=\"date\"\n          value={local.dateEnd}\n          onChange={(e) => setLocal(patch({ dateEnd: e.target.value }))}\n        />\n      </label>\n\n      {/* 排序 */}\n      <label>\n        排序\n        <select\n          data-testid=\"filter-sort-select\"\n          value={local.sortBy}\n          onChange={(e) => handleImmediateChange({ sortBy: e.target.value as TicketFilterState['sortBy'] })}\n        >\n          <option value=\"createdAt_desc\">最近创建</option>\n          <option value=\"createdAt_asc\">最早创建</option>\n          <option value=\"priority_desc\">优先级高到低</option>\n          <option value=\"priority_asc\">优先级低到高</option>\n        </select>\n      </label>\n\n      {/* 操作 */}\n      <div style={{ display: 'inline-flex', gap: 8, marginLeft: 8 }}>\n        <button data-testid=\"filter-apply-btn\" onClick={handleApply}>应用</button>\n        <button data-testid=\"filter-reset-btn\" onClick={handleReset}>重置</button>\n      </div>\n    </div>\n  );\n}"],"names":["TicketFilters","DEFAULT_VALUE","status","priority","keyword","dateStart","dateEnd","sortBy","value","onChange","local","setLocal","React","useState","useEffect","patch","partial","handleImmediateChange","next","handleApply","handleReset","div","data-testid","aria-label","label","select","e","target","option","input","type","placeholder","style","display","gap","marginLeft","button","onClick"],"mappings":"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"}