{"version":3,"names":["cov_2q7cd6cum3","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","s","f","b","inputSourceMap","version","sources","sourcesContent","names","mappings","_coverageSchema","coverage","actualCoverage","RelationDirection","TicketRelationType"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-prototype/src/types/ticket-relations.ts"],"sourcesContent":["/**\n * 工单关联类型定义\n * 支持父子关系、依赖关系、相关关系等多种工单关联类型\n */\n\nimport type { Ticket } from './ticket';\n\n// ==================== 关联类型枚举 ====================\n\n/**\n * 工单关联类型\n */\nexport enum TicketRelationType {\n  // 层级关系\n  PARENT_CHILD = 'parent_child',         // 父子关系\n  \n  // 依赖关系\n  BLOCKS = 'blocks',                     // 阻塞（A阻塞B，B依赖A）\n  BLOCKED_BY = 'blocked_by',             // 被阻塞\n  DEPENDS_ON = 'depends_on',             // 依赖于\n  \n  // 关联关系\n  RELATES_TO = 'relates_to',             // 相关\n  DUPLICATES = 'duplicates',             // 重复（A重复B）\n  DUPLICATED_BY = 'duplicated_by',       // 被重复\n  \n  // 因果关系\n  CAUSES = 'causes',                     // 导致\n  CAUSED_BY = 'caused_by',               // 由...导致\n  \n  // 替代关系\n  REPLACES = 'replaces',                 // 替代\n  REPLACED_BY = 'replaced_by',           // 被替代\n  \n  // 分解关系\n  SPLITS_FROM = 'splits_from',           // 分离自\n  MERGED_INTO = 'merged_into',           // 合并到\n}\n\n/**\n * 关联方向\n */\nexport enum RelationDirection {\n  INBOUND = 'inbound',                   // 入向（被其他工单关联）\n  OUTBOUND = 'outbound',                 // 出向（关联其他工单）\n  BIDIRECTIONAL = 'bidirectional',       // 双向\n}\n\n// ==================== 工单关联接口 ====================\n\n/**\n * 工单关联\n */\nexport interface TicketRelation {\n  id: string;\n  sourceTicketId: number;                // 源工单ID\n  sourceTicketNumber: string;            // 源工单编号\n  targetTicketId: number;                // 目标工单ID\n  targetTicketNumber: string;            // 目标工单编号\n  relationType: TicketRelationType;      // 关联类型\n  direction: RelationDirection;          // 关联方向\n  description?: string;                  // 关联描述\n  createdBy: number;                     // 创建人ID\n  createdByName: string;                 // 创建人姓名\n  createdAt: Date;                       // 创建时间\n  metadata?: Record<string, any>;        // 元数据\n}\n\n/**\n * 工单关联详情（包含关联工单的基本信息）\n */\nexport interface TicketRelationWithDetails extends TicketRelation {\n  sourceTicket?: Partial<Ticket>;        // 源工单基本信息\n  targetTicket?: Partial<Ticket>;        // 目标工单基本信息\n}\n\n// ==================== 父子关系 ====================\n\n/**\n * 父工单信息\n */\nexport interface ParentTicket {\n  id: number;\n  ticketNumber: string;\n  title: string;\n  status: string;\n  priority: string;\n  assignee?: {\n    id: number;\n    name: string;\n    avatar?: string;\n  };\n  progress?: number;                     // 进度（基于子工单）\n  childrenCount: number;                 // 子工单数量\n  completedChildrenCount: number;        // 已完成子工单数量\n}\n\n/**\n * 子工单信息\n */\nexport interface ChildTicket {\n  id: number;\n  ticketNumber: string;\n  title: string;\n  status: string;\n  priority: string;\n  assignee?: {\n    id: number;\n    name: string;\n    avatar?: string;\n  };\n  order: number;                         // 排序顺序\n  isBlocking: boolean;                   // 是否阻塞其他子工单\n}\n\n/**\n * 工单层级结构\n */\nexport interface TicketHierarchy {\n  ticket: Ticket;\n  parent?: ParentTicket;\n  children: ChildTicket[];\n  ancestors: ParentTicket[];             // 祖先工单链\n  depth: number;                         // 层级深度\n  path: string[];                        // 路径（工单编号）\n}\n\n// ==================== 依赖关系 ====================\n\n/**\n * 工单依赖\n */\nexport interface TicketDependency {\n  id: string;\n  ticketId: number;\n  dependsOnTicketId: number;\n  dependsOnTicketNumber: string;\n  dependsOnTicketTitle: string;\n  dependsOnTicketStatus: string;\n  dependencyType: 'hard' | 'soft';       // 硬依赖/软依赖\n  isBlocking: boolean;                   // 是否当前阻塞\n  canStart: boolean;                     // 是否可以开始\n  estimatedUnblockDate?: Date;           // 预计解除阻塞日期\n  createdAt: Date;\n}\n\n/**\n * 依赖图\n */\nexport interface DependencyGraph {\n  nodes: DependencyNode[];\n  edges: DependencyEdge[];\n  criticalPath: number[];                // 关键路径\n  estimatedCompletionDate?: Date;        // 预计完成日期\n}\n\nexport interface DependencyNode {\n  ticketId: number;\n  ticketNumber: string;\n  title: string;\n  status: string;\n  priority: string;\n  estimatedDuration?: number;            // 预计工期（小时）\n  isCritical: boolean;                   // 是否在关键路径上\n  level: number;                         // 层级\n}\n\nexport interface DependencyEdge {\n  from: number;\n  to: number;\n  type: 'blocks' | 'depends_on';\n  isBlocking: boolean;\n}\n\n// ==================== 关联操作 ====================\n\n/**\n * 创建关联请求\n */\nexport interface CreateRelationRequest {\n  sourceTicketId: number;\n  targetTicketId: number;\n  relationType: TicketRelationType;\n  description?: string;\n  metadata?: Record<string, any>;\n}\n\n/**\n * 批量创建关联请求\n */\nexport interface BatchCreateRelationsRequest {\n  sourceTicketId: number;\n  relations: Array<{\n    targetTicketId: number;\n    relationType: TicketRelationType;\n    description?: string;\n  }>;\n}\n\n/**\n * 更新关联请求\n */\nexport interface UpdateRelationRequest {\n  description?: string;\n  metadata?: Record<string, any>;\n}\n\n/**\n * 删除关联请求\n */\nexport interface DeleteRelationRequest {\n  relationId: string;\n  reason?: string;\n}\n\n// ==================== 关联验证 ====================\n\n/**\n * 关联验证结果\n */\nexport interface RelationValidation {\n  isValid: boolean;\n  canCreate: boolean;\n  errors: ValidationError[];\n  warnings: ValidationWarning[];\n  suggestions: string[];\n}\n\nexport interface ValidationError {\n  code: string;\n  message: string;\n  field?: string;\n}\n\nexport interface ValidationWarning {\n  code: string;\n  message: string;\n  severity: 'low' | 'medium' | 'high';\n}\n\n/**\n * 关联冲突\n */\nexport interface RelationConflict {\n  type: 'circular' | 'duplicate' | 'invalid_state' | 'permission';\n  message: string;\n  conflictingRelations: TicketRelation[];\n  resolution?: string;\n}\n\n// ==================== 关联搜索和过滤 ====================\n\n/**\n * 关联查询参数\n */\nexport interface RelationQuery {\n  ticketId: number;\n  relationType?: TicketRelationType;\n  direction?: RelationDirection;\n  includeDetails?: boolean;\n  recursive?: boolean;                   // 是否递归查询\n  maxDepth?: number;                     // 最大递归深度\n}\n\n/**\n * 关联搜索结果\n */\nexport interface RelationSearchResult {\n  relations: TicketRelationWithDetails[];\n  total: number;\n  hasMore: boolean;\n}\n\n// ==================== 关联统计 ====================\n\n/**\n * 工单关联统计\n */\nexport interface TicketRelationStats {\n  totalRelations: number;\n  relationsByType: Record<TicketRelationType, number>;\n  inboundCount: number;\n  outboundCount: number;\n  parentCount: number;\n  childrenCount: number;\n  blockedByCount: number;\n  blockingCount: number;\n  relatedCount: number;\n  duplicateCount: number;\n}\n\n/**\n * 关联影响分析\n */\nexport interface RelationImpactAnalysis {\n  ticketId: number;\n  affectedTickets: Array<{\n    ticketId: number;\n    ticketNumber: string;\n    title: string;\n    impactType: 'direct' | 'indirect';\n    impactLevel: 'low' | 'medium' | 'high';\n    reason: string;\n  }>;\n  totalAffected: number;\n  criticalImpacts: number;\n  recommendations: string[];\n}\n\n// ==================== 关联图谱 ====================\n\n/**\n * 关系图谱节点\n */\nexport interface RelationGraphNode {\n  id: number;\n  ticketNumber: string;\n  title: string;\n  status: string;\n  priority: string;\n  type: string;\n  assignee?: {\n    id: number;\n    name: string;\n    avatar?: string;\n  };\n  depth: number;\n  children?: RelationGraphNode[];\n}\n\n/**\n * 关系图谱配置\n */\nexport interface RelationGraphConfig {\n  maxDepth: number;\n  relationTypes: TicketRelationType[];\n  direction: RelationDirection;\n  showLabels: boolean;\n  showStatus: boolean;\n  layout: 'tree' | 'force' | 'hierarchical';\n  highlightCriticalPath: boolean;\n}\n\n/**\n * 关系图谱数据\n */\nexport interface RelationGraphData {\n  nodes: RelationGraphNode[];\n  edges: Array<{\n    source: number;\n    target: number;\n    type: TicketRelationType;\n    label?: string;\n  }>;\n  config: RelationGraphConfig;\n}\n\n// ==================== 关联建议 ====================\n\n/**\n * 关联建议\n */\nexport interface RelationSuggestion {\n  targetTicketId: number;\n  targetTicketNumber: string;\n  targetTicketTitle: string;\n  suggestedRelationType: TicketRelationType;\n  confidence: number;                    // 置信度（0-1）\n  reason: string;\n  similarity?: number;                   // 相似度\n}\n\n/**\n * 智能关联推荐\n */\nexport interface SmartRelationRecommendation {\n  ticketId: number;\n  suggestions: RelationSuggestion[];\n  duplicateCandidates: Array<{\n    ticketId: number;\n    ticketNumber: string;\n    title: string;\n    similarity: number;\n    reason: string;\n  }>;\n  relatedTickets: Array<{\n    ticketId: number;\n    ticketNumber: string;\n    title: string;\n    relevanceScore: number;\n    commonTags: string[];\n    commonUsers: string[];\n  }>;\n}\n\n// ==================== 关联历史 ====================\n\n/**\n * 关联操作历史\n */\nexport interface RelationHistory {\n  id: string;\n  relationId: string;\n  action: 'created' | 'updated' | 'deleted';\n  relationType: TicketRelationType;\n  sourceTicketId: number;\n  targetTicketId: number;\n  performedBy: number;\n  performedByName: string;\n  performedAt: Date;\n  reason?: string;\n  metadata?: Record<string, any>;\n}\n\n// ==================== 批量关联操作 ====================\n\n/**\n * 批量关联操作结果\n */\nexport interface BatchRelationResult {\n  success: boolean;\n  created: number;\n  failed: number;\n  errors: Array<{\n    targetTicketId: number;\n    error: string;\n  }>;\n}\n\n// ==================== 关联权限 ====================\n\n/**\n * 关联权限\n */\nexport interface RelationPermissions {\n  canCreate: boolean;\n  canUpdate: boolean;\n  canDelete: boolean;\n  canViewAll: boolean;\n  allowedRelationTypes: TicketRelationType[];\n  restrictions: string[];\n}\n\n// ==================== 导出所有类型 ====================\n\nexport default TicketRelation;\n\n"],"mappings":"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","ignoreList":[]}