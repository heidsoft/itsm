// Code generated by ent, DO NOT EDIT.

package ent

import (
	"context"
	"errors"
	"fmt"
	"itsm-backend/ent/cloudresource"
	"itsm-backend/ent/cloudservice"
	"itsm-backend/ent/predicate"
	"time"

	"entgo.io/ent/dialect/sql"
	"entgo.io/ent/dialect/sql/sqlgraph"
	"entgo.io/ent/schema/field"
)

// CloudServiceUpdate is the builder for updating CloudService entities.
type CloudServiceUpdate struct {
	config
	hooks    []Hook
	mutation *CloudServiceMutation
}

// Where appends a list predicates to the CloudServiceUpdate builder.
func (csu *CloudServiceUpdate) Where(ps ...predicate.CloudService) *CloudServiceUpdate {
	csu.mutation.Where(ps...)
	return csu
}

// SetParentID sets the "parent_id" field.
func (csu *CloudServiceUpdate) SetParentID(i int) *CloudServiceUpdate {
	csu.mutation.SetParentID(i)
	return csu
}

// SetNillableParentID sets the "parent_id" field if the given value is not nil.
func (csu *CloudServiceUpdate) SetNillableParentID(i *int) *CloudServiceUpdate {
	if i != nil {
		csu.SetParentID(*i)
	}
	return csu
}

// ClearParentID clears the value of the "parent_id" field.
func (csu *CloudServiceUpdate) ClearParentID() *CloudServiceUpdate {
	csu.mutation.ClearParentID()
	return csu
}

// SetProvider sets the "provider" field.
func (csu *CloudServiceUpdate) SetProvider(s string) *CloudServiceUpdate {
	csu.mutation.SetProvider(s)
	return csu
}

// SetNillableProvider sets the "provider" field if the given value is not nil.
func (csu *CloudServiceUpdate) SetNillableProvider(s *string) *CloudServiceUpdate {
	if s != nil {
		csu.SetProvider(*s)
	}
	return csu
}

// SetCategory sets the "category" field.
func (csu *CloudServiceUpdate) SetCategory(s string) *CloudServiceUpdate {
	csu.mutation.SetCategory(s)
	return csu
}

// SetNillableCategory sets the "category" field if the given value is not nil.
func (csu *CloudServiceUpdate) SetNillableCategory(s *string) *CloudServiceUpdate {
	if s != nil {
		csu.SetCategory(*s)
	}
	return csu
}

// ClearCategory clears the value of the "category" field.
func (csu *CloudServiceUpdate) ClearCategory() *CloudServiceUpdate {
	csu.mutation.ClearCategory()
	return csu
}

// SetServiceCode sets the "service_code" field.
func (csu *CloudServiceUpdate) SetServiceCode(s string) *CloudServiceUpdate {
	csu.mutation.SetServiceCode(s)
	return csu
}

// SetNillableServiceCode sets the "service_code" field if the given value is not nil.
func (csu *CloudServiceUpdate) SetNillableServiceCode(s *string) *CloudServiceUpdate {
	if s != nil {
		csu.SetServiceCode(*s)
	}
	return csu
}

// SetServiceName sets the "service_name" field.
func (csu *CloudServiceUpdate) SetServiceName(s string) *CloudServiceUpdate {
	csu.mutation.SetServiceName(s)
	return csu
}

// SetNillableServiceName sets the "service_name" field if the given value is not nil.
func (csu *CloudServiceUpdate) SetNillableServiceName(s *string) *CloudServiceUpdate {
	if s != nil {
		csu.SetServiceName(*s)
	}
	return csu
}

// SetResourceTypeCode sets the "resource_type_code" field.
func (csu *CloudServiceUpdate) SetResourceTypeCode(s string) *CloudServiceUpdate {
	csu.mutation.SetResourceTypeCode(s)
	return csu
}

// SetNillableResourceTypeCode sets the "resource_type_code" field if the given value is not nil.
func (csu *CloudServiceUpdate) SetNillableResourceTypeCode(s *string) *CloudServiceUpdate {
	if s != nil {
		csu.SetResourceTypeCode(*s)
	}
	return csu
}

// SetResourceTypeName sets the "resource_type_name" field.
func (csu *CloudServiceUpdate) SetResourceTypeName(s string) *CloudServiceUpdate {
	csu.mutation.SetResourceTypeName(s)
	return csu
}

// SetNillableResourceTypeName sets the "resource_type_name" field if the given value is not nil.
func (csu *CloudServiceUpdate) SetNillableResourceTypeName(s *string) *CloudServiceUpdate {
	if s != nil {
		csu.SetResourceTypeName(*s)
	}
	return csu
}

// SetAPIVersion sets the "api_version" field.
func (csu *CloudServiceUpdate) SetAPIVersion(s string) *CloudServiceUpdate {
	csu.mutation.SetAPIVersion(s)
	return csu
}

// SetNillableAPIVersion sets the "api_version" field if the given value is not nil.
func (csu *CloudServiceUpdate) SetNillableAPIVersion(s *string) *CloudServiceUpdate {
	if s != nil {
		csu.SetAPIVersion(*s)
	}
	return csu
}

// ClearAPIVersion clears the value of the "api_version" field.
func (csu *CloudServiceUpdate) ClearAPIVersion() *CloudServiceUpdate {
	csu.mutation.ClearAPIVersion()
	return csu
}

// SetAttributeSchema sets the "attribute_schema" field.
func (csu *CloudServiceUpdate) SetAttributeSchema(m map[string]interface{}) *CloudServiceUpdate {
	csu.mutation.SetAttributeSchema(m)
	return csu
}

// ClearAttributeSchema clears the value of the "attribute_schema" field.
func (csu *CloudServiceUpdate) ClearAttributeSchema() *CloudServiceUpdate {
	csu.mutation.ClearAttributeSchema()
	return csu
}

// SetIsSystem sets the "is_system" field.
func (csu *CloudServiceUpdate) SetIsSystem(b bool) *CloudServiceUpdate {
	csu.mutation.SetIsSystem(b)
	return csu
}

// SetNillableIsSystem sets the "is_system" field if the given value is not nil.
func (csu *CloudServiceUpdate) SetNillableIsSystem(b *bool) *CloudServiceUpdate {
	if b != nil {
		csu.SetIsSystem(*b)
	}
	return csu
}

// SetIsActive sets the "is_active" field.
func (csu *CloudServiceUpdate) SetIsActive(b bool) *CloudServiceUpdate {
	csu.mutation.SetIsActive(b)
	return csu
}

// SetNillableIsActive sets the "is_active" field if the given value is not nil.
func (csu *CloudServiceUpdate) SetNillableIsActive(b *bool) *CloudServiceUpdate {
	if b != nil {
		csu.SetIsActive(*b)
	}
	return csu
}

// SetTenantID sets the "tenant_id" field.
func (csu *CloudServiceUpdate) SetTenantID(i int) *CloudServiceUpdate {
	csu.mutation.ResetTenantID()
	csu.mutation.SetTenantID(i)
	return csu
}

// SetNillableTenantID sets the "tenant_id" field if the given value is not nil.
func (csu *CloudServiceUpdate) SetNillableTenantID(i *int) *CloudServiceUpdate {
	if i != nil {
		csu.SetTenantID(*i)
	}
	return csu
}

// AddTenantID adds i to the "tenant_id" field.
func (csu *CloudServiceUpdate) AddTenantID(i int) *CloudServiceUpdate {
	csu.mutation.AddTenantID(i)
	return csu
}

// SetCreatedAt sets the "created_at" field.
func (csu *CloudServiceUpdate) SetCreatedAt(t time.Time) *CloudServiceUpdate {
	csu.mutation.SetCreatedAt(t)
	return csu
}

// SetNillableCreatedAt sets the "created_at" field if the given value is not nil.
func (csu *CloudServiceUpdate) SetNillableCreatedAt(t *time.Time) *CloudServiceUpdate {
	if t != nil {
		csu.SetCreatedAt(*t)
	}
	return csu
}

// SetUpdatedAt sets the "updated_at" field.
func (csu *CloudServiceUpdate) SetUpdatedAt(t time.Time) *CloudServiceUpdate {
	csu.mutation.SetUpdatedAt(t)
	return csu
}

// SetParent sets the "parent" edge to the CloudService entity.
func (csu *CloudServiceUpdate) SetParent(c *CloudService) *CloudServiceUpdate {
	return csu.SetParentID(c.ID)
}

// AddChildIDs adds the "children" edge to the CloudService entity by IDs.
func (csu *CloudServiceUpdate) AddChildIDs(ids ...int) *CloudServiceUpdate {
	csu.mutation.AddChildIDs(ids...)
	return csu
}

// AddChildren adds the "children" edges to the CloudService entity.
func (csu *CloudServiceUpdate) AddChildren(c ...*CloudService) *CloudServiceUpdate {
	ids := make([]int, len(c))
	for i := range c {
		ids[i] = c[i].ID
	}
	return csu.AddChildIDs(ids...)
}

// AddResourceIDs adds the "resources" edge to the CloudResource entity by IDs.
func (csu *CloudServiceUpdate) AddResourceIDs(ids ...int) *CloudServiceUpdate {
	csu.mutation.AddResourceIDs(ids...)
	return csu
}

// AddResources adds the "resources" edges to the CloudResource entity.
func (csu *CloudServiceUpdate) AddResources(c ...*CloudResource) *CloudServiceUpdate {
	ids := make([]int, len(c))
	for i := range c {
		ids[i] = c[i].ID
	}
	return csu.AddResourceIDs(ids...)
}

// Mutation returns the CloudServiceMutation object of the builder.
func (csu *CloudServiceUpdate) Mutation() *CloudServiceMutation {
	return csu.mutation
}

// ClearParent clears the "parent" edge to the CloudService entity.
func (csu *CloudServiceUpdate) ClearParent() *CloudServiceUpdate {
	csu.mutation.ClearParent()
	return csu
}

// ClearChildren clears all "children" edges to the CloudService entity.
func (csu *CloudServiceUpdate) ClearChildren() *CloudServiceUpdate {
	csu.mutation.ClearChildren()
	return csu
}

// RemoveChildIDs removes the "children" edge to CloudService entities by IDs.
func (csu *CloudServiceUpdate) RemoveChildIDs(ids ...int) *CloudServiceUpdate {
	csu.mutation.RemoveChildIDs(ids...)
	return csu
}

// RemoveChildren removes "children" edges to CloudService entities.
func (csu *CloudServiceUpdate) RemoveChildren(c ...*CloudService) *CloudServiceUpdate {
	ids := make([]int, len(c))
	for i := range c {
		ids[i] = c[i].ID
	}
	return csu.RemoveChildIDs(ids...)
}

// ClearResources clears all "resources" edges to the CloudResource entity.
func (csu *CloudServiceUpdate) ClearResources() *CloudServiceUpdate {
	csu.mutation.ClearResources()
	return csu
}

// RemoveResourceIDs removes the "resources" edge to CloudResource entities by IDs.
func (csu *CloudServiceUpdate) RemoveResourceIDs(ids ...int) *CloudServiceUpdate {
	csu.mutation.RemoveResourceIDs(ids...)
	return csu
}

// RemoveResources removes "resources" edges to CloudResource entities.
func (csu *CloudServiceUpdate) RemoveResources(c ...*CloudResource) *CloudServiceUpdate {
	ids := make([]int, len(c))
	for i := range c {
		ids[i] = c[i].ID
	}
	return csu.RemoveResourceIDs(ids...)
}

// Save executes the query and returns the number of nodes affected by the update operation.
func (csu *CloudServiceUpdate) Save(ctx context.Context) (int, error) {
	csu.defaults()
	return withHooks(ctx, csu.sqlSave, csu.mutation, csu.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (csu *CloudServiceUpdate) SaveX(ctx context.Context) int {
	affected, err := csu.Save(ctx)
	if err != nil {
		panic(err)
	}
	return affected
}

// Exec executes the query.
func (csu *CloudServiceUpdate) Exec(ctx context.Context) error {
	_, err := csu.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (csu *CloudServiceUpdate) ExecX(ctx context.Context) {
	if err := csu.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (csu *CloudServiceUpdate) defaults() {
	if _, ok := csu.mutation.UpdatedAt(); !ok {
		v := cloudservice.UpdateDefaultUpdatedAt()
		csu.mutation.SetUpdatedAt(v)
	}
}

// check runs all checks and user-defined validators on the builder.
func (csu *CloudServiceUpdate) check() error {
	if v, ok := csu.mutation.Provider(); ok {
		if err := cloudservice.ProviderValidator(v); err != nil {
			return &ValidationError{Name: "provider", err: fmt.Errorf(`ent: validator failed for field "CloudService.provider": %w`, err)}
		}
	}
	if v, ok := csu.mutation.ServiceCode(); ok {
		if err := cloudservice.ServiceCodeValidator(v); err != nil {
			return &ValidationError{Name: "service_code", err: fmt.Errorf(`ent: validator failed for field "CloudService.service_code": %w`, err)}
		}
	}
	if v, ok := csu.mutation.ServiceName(); ok {
		if err := cloudservice.ServiceNameValidator(v); err != nil {
			return &ValidationError{Name: "service_name", err: fmt.Errorf(`ent: validator failed for field "CloudService.service_name": %w`, err)}
		}
	}
	if v, ok := csu.mutation.ResourceTypeCode(); ok {
		if err := cloudservice.ResourceTypeCodeValidator(v); err != nil {
			return &ValidationError{Name: "resource_type_code", err: fmt.Errorf(`ent: validator failed for field "CloudService.resource_type_code": %w`, err)}
		}
	}
	if v, ok := csu.mutation.ResourceTypeName(); ok {
		if err := cloudservice.ResourceTypeNameValidator(v); err != nil {
			return &ValidationError{Name: "resource_type_name", err: fmt.Errorf(`ent: validator failed for field "CloudService.resource_type_name": %w`, err)}
		}
	}
	if v, ok := csu.mutation.TenantID(); ok {
		if err := cloudservice.TenantIDValidator(v); err != nil {
			return &ValidationError{Name: "tenant_id", err: fmt.Errorf(`ent: validator failed for field "CloudService.tenant_id": %w`, err)}
		}
	}
	return nil
}

func (csu *CloudServiceUpdate) sqlSave(ctx context.Context) (n int, err error) {
	if err := csu.check(); err != nil {
		return n, err
	}
	_spec := sqlgraph.NewUpdateSpec(cloudservice.Table, cloudservice.Columns, sqlgraph.NewFieldSpec(cloudservice.FieldID, field.TypeInt))
	if ps := csu.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := csu.mutation.Provider(); ok {
		_spec.SetField(cloudservice.FieldProvider, field.TypeString, value)
	}
	if value, ok := csu.mutation.Category(); ok {
		_spec.SetField(cloudservice.FieldCategory, field.TypeString, value)
	}
	if csu.mutation.CategoryCleared() {
		_spec.ClearField(cloudservice.FieldCategory, field.TypeString)
	}
	if value, ok := csu.mutation.ServiceCode(); ok {
		_spec.SetField(cloudservice.FieldServiceCode, field.TypeString, value)
	}
	if value, ok := csu.mutation.ServiceName(); ok {
		_spec.SetField(cloudservice.FieldServiceName, field.TypeString, value)
	}
	if value, ok := csu.mutation.ResourceTypeCode(); ok {
		_spec.SetField(cloudservice.FieldResourceTypeCode, field.TypeString, value)
	}
	if value, ok := csu.mutation.ResourceTypeName(); ok {
		_spec.SetField(cloudservice.FieldResourceTypeName, field.TypeString, value)
	}
	if value, ok := csu.mutation.APIVersion(); ok {
		_spec.SetField(cloudservice.FieldAPIVersion, field.TypeString, value)
	}
	if csu.mutation.APIVersionCleared() {
		_spec.ClearField(cloudservice.FieldAPIVersion, field.TypeString)
	}
	if value, ok := csu.mutation.AttributeSchema(); ok {
		_spec.SetField(cloudservice.FieldAttributeSchema, field.TypeJSON, value)
	}
	if csu.mutation.AttributeSchemaCleared() {
		_spec.ClearField(cloudservice.FieldAttributeSchema, field.TypeJSON)
	}
	if value, ok := csu.mutation.IsSystem(); ok {
		_spec.SetField(cloudservice.FieldIsSystem, field.TypeBool, value)
	}
	if value, ok := csu.mutation.IsActive(); ok {
		_spec.SetField(cloudservice.FieldIsActive, field.TypeBool, value)
	}
	if value, ok := csu.mutation.TenantID(); ok {
		_spec.SetField(cloudservice.FieldTenantID, field.TypeInt, value)
	}
	if value, ok := csu.mutation.AddedTenantID(); ok {
		_spec.AddField(cloudservice.FieldTenantID, field.TypeInt, value)
	}
	if value, ok := csu.mutation.CreatedAt(); ok {
		_spec.SetField(cloudservice.FieldCreatedAt, field.TypeTime, value)
	}
	if value, ok := csu.mutation.UpdatedAt(); ok {
		_spec.SetField(cloudservice.FieldUpdatedAt, field.TypeTime, value)
	}
	if csu.mutation.ParentCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   cloudservice.ParentTable,
			Columns: []string{cloudservice.ParentColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudservice.FieldID, field.TypeInt),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := csu.mutation.ParentIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   cloudservice.ParentTable,
			Columns: []string{cloudservice.ParentColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudservice.FieldID, field.TypeInt),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	if csu.mutation.ChildrenCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2M,
			Inverse: false,
			Table:   cloudservice.ChildrenTable,
			Columns: []string{cloudservice.ChildrenColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudservice.FieldID, field.TypeInt),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := csu.mutation.RemovedChildrenIDs(); len(nodes) > 0 && !csu.mutation.ChildrenCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2M,
			Inverse: false,
			Table:   cloudservice.ChildrenTable,
			Columns: []string{cloudservice.ChildrenColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudservice.FieldID, field.TypeInt),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := csu.mutation.ChildrenIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2M,
			Inverse: false,
			Table:   cloudservice.ChildrenTable,
			Columns: []string{cloudservice.ChildrenColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudservice.FieldID, field.TypeInt),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	if csu.mutation.ResourcesCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2M,
			Inverse: false,
			Table:   cloudservice.ResourcesTable,
			Columns: []string{cloudservice.ResourcesColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudresource.FieldID, field.TypeInt),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := csu.mutation.RemovedResourcesIDs(); len(nodes) > 0 && !csu.mutation.ResourcesCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2M,
			Inverse: false,
			Table:   cloudservice.ResourcesTable,
			Columns: []string{cloudservice.ResourcesColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudresource.FieldID, field.TypeInt),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := csu.mutation.ResourcesIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2M,
			Inverse: false,
			Table:   cloudservice.ResourcesTable,
			Columns: []string{cloudservice.ResourcesColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudresource.FieldID, field.TypeInt),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	if n, err = sqlgraph.UpdateNodes(ctx, csu.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{cloudservice.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return 0, err
	}
	csu.mutation.done = true
	return n, nil
}

// CloudServiceUpdateOne is the builder for updating a single CloudService entity.
type CloudServiceUpdateOne struct {
	config
	fields   []string
	hooks    []Hook
	mutation *CloudServiceMutation
}

// SetParentID sets the "parent_id" field.
func (csuo *CloudServiceUpdateOne) SetParentID(i int) *CloudServiceUpdateOne {
	csuo.mutation.SetParentID(i)
	return csuo
}

// SetNillableParentID sets the "parent_id" field if the given value is not nil.
func (csuo *CloudServiceUpdateOne) SetNillableParentID(i *int) *CloudServiceUpdateOne {
	if i != nil {
		csuo.SetParentID(*i)
	}
	return csuo
}

// ClearParentID clears the value of the "parent_id" field.
func (csuo *CloudServiceUpdateOne) ClearParentID() *CloudServiceUpdateOne {
	csuo.mutation.ClearParentID()
	return csuo
}

// SetProvider sets the "provider" field.
func (csuo *CloudServiceUpdateOne) SetProvider(s string) *CloudServiceUpdateOne {
	csuo.mutation.SetProvider(s)
	return csuo
}

// SetNillableProvider sets the "provider" field if the given value is not nil.
func (csuo *CloudServiceUpdateOne) SetNillableProvider(s *string) *CloudServiceUpdateOne {
	if s != nil {
		csuo.SetProvider(*s)
	}
	return csuo
}

// SetCategory sets the "category" field.
func (csuo *CloudServiceUpdateOne) SetCategory(s string) *CloudServiceUpdateOne {
	csuo.mutation.SetCategory(s)
	return csuo
}

// SetNillableCategory sets the "category" field if the given value is not nil.
func (csuo *CloudServiceUpdateOne) SetNillableCategory(s *string) *CloudServiceUpdateOne {
	if s != nil {
		csuo.SetCategory(*s)
	}
	return csuo
}

// ClearCategory clears the value of the "category" field.
func (csuo *CloudServiceUpdateOne) ClearCategory() *CloudServiceUpdateOne {
	csuo.mutation.ClearCategory()
	return csuo
}

// SetServiceCode sets the "service_code" field.
func (csuo *CloudServiceUpdateOne) SetServiceCode(s string) *CloudServiceUpdateOne {
	csuo.mutation.SetServiceCode(s)
	return csuo
}

// SetNillableServiceCode sets the "service_code" field if the given value is not nil.
func (csuo *CloudServiceUpdateOne) SetNillableServiceCode(s *string) *CloudServiceUpdateOne {
	if s != nil {
		csuo.SetServiceCode(*s)
	}
	return csuo
}

// SetServiceName sets the "service_name" field.
func (csuo *CloudServiceUpdateOne) SetServiceName(s string) *CloudServiceUpdateOne {
	csuo.mutation.SetServiceName(s)
	return csuo
}

// SetNillableServiceName sets the "service_name" field if the given value is not nil.
func (csuo *CloudServiceUpdateOne) SetNillableServiceName(s *string) *CloudServiceUpdateOne {
	if s != nil {
		csuo.SetServiceName(*s)
	}
	return csuo
}

// SetResourceTypeCode sets the "resource_type_code" field.
func (csuo *CloudServiceUpdateOne) SetResourceTypeCode(s string) *CloudServiceUpdateOne {
	csuo.mutation.SetResourceTypeCode(s)
	return csuo
}

// SetNillableResourceTypeCode sets the "resource_type_code" field if the given value is not nil.
func (csuo *CloudServiceUpdateOne) SetNillableResourceTypeCode(s *string) *CloudServiceUpdateOne {
	if s != nil {
		csuo.SetResourceTypeCode(*s)
	}
	return csuo
}

// SetResourceTypeName sets the "resource_type_name" field.
func (csuo *CloudServiceUpdateOne) SetResourceTypeName(s string) *CloudServiceUpdateOne {
	csuo.mutation.SetResourceTypeName(s)
	return csuo
}

// SetNillableResourceTypeName sets the "resource_type_name" field if the given value is not nil.
func (csuo *CloudServiceUpdateOne) SetNillableResourceTypeName(s *string) *CloudServiceUpdateOne {
	if s != nil {
		csuo.SetResourceTypeName(*s)
	}
	return csuo
}

// SetAPIVersion sets the "api_version" field.
func (csuo *CloudServiceUpdateOne) SetAPIVersion(s string) *CloudServiceUpdateOne {
	csuo.mutation.SetAPIVersion(s)
	return csuo
}

// SetNillableAPIVersion sets the "api_version" field if the given value is not nil.
func (csuo *CloudServiceUpdateOne) SetNillableAPIVersion(s *string) *CloudServiceUpdateOne {
	if s != nil {
		csuo.SetAPIVersion(*s)
	}
	return csuo
}

// ClearAPIVersion clears the value of the "api_version" field.
func (csuo *CloudServiceUpdateOne) ClearAPIVersion() *CloudServiceUpdateOne {
	csuo.mutation.ClearAPIVersion()
	return csuo
}

// SetAttributeSchema sets the "attribute_schema" field.
func (csuo *CloudServiceUpdateOne) SetAttributeSchema(m map[string]interface{}) *CloudServiceUpdateOne {
	csuo.mutation.SetAttributeSchema(m)
	return csuo
}

// ClearAttributeSchema clears the value of the "attribute_schema" field.
func (csuo *CloudServiceUpdateOne) ClearAttributeSchema() *CloudServiceUpdateOne {
	csuo.mutation.ClearAttributeSchema()
	return csuo
}

// SetIsSystem sets the "is_system" field.
func (csuo *CloudServiceUpdateOne) SetIsSystem(b bool) *CloudServiceUpdateOne {
	csuo.mutation.SetIsSystem(b)
	return csuo
}

// SetNillableIsSystem sets the "is_system" field if the given value is not nil.
func (csuo *CloudServiceUpdateOne) SetNillableIsSystem(b *bool) *CloudServiceUpdateOne {
	if b != nil {
		csuo.SetIsSystem(*b)
	}
	return csuo
}

// SetIsActive sets the "is_active" field.
func (csuo *CloudServiceUpdateOne) SetIsActive(b bool) *CloudServiceUpdateOne {
	csuo.mutation.SetIsActive(b)
	return csuo
}

// SetNillableIsActive sets the "is_active" field if the given value is not nil.
func (csuo *CloudServiceUpdateOne) SetNillableIsActive(b *bool) *CloudServiceUpdateOne {
	if b != nil {
		csuo.SetIsActive(*b)
	}
	return csuo
}

// SetTenantID sets the "tenant_id" field.
func (csuo *CloudServiceUpdateOne) SetTenantID(i int) *CloudServiceUpdateOne {
	csuo.mutation.ResetTenantID()
	csuo.mutation.SetTenantID(i)
	return csuo
}

// SetNillableTenantID sets the "tenant_id" field if the given value is not nil.
func (csuo *CloudServiceUpdateOne) SetNillableTenantID(i *int) *CloudServiceUpdateOne {
	if i != nil {
		csuo.SetTenantID(*i)
	}
	return csuo
}

// AddTenantID adds i to the "tenant_id" field.
func (csuo *CloudServiceUpdateOne) AddTenantID(i int) *CloudServiceUpdateOne {
	csuo.mutation.AddTenantID(i)
	return csuo
}

// SetCreatedAt sets the "created_at" field.
func (csuo *CloudServiceUpdateOne) SetCreatedAt(t time.Time) *CloudServiceUpdateOne {
	csuo.mutation.SetCreatedAt(t)
	return csuo
}

// SetNillableCreatedAt sets the "created_at" field if the given value is not nil.
func (csuo *CloudServiceUpdateOne) SetNillableCreatedAt(t *time.Time) *CloudServiceUpdateOne {
	if t != nil {
		csuo.SetCreatedAt(*t)
	}
	return csuo
}

// SetUpdatedAt sets the "updated_at" field.
func (csuo *CloudServiceUpdateOne) SetUpdatedAt(t time.Time) *CloudServiceUpdateOne {
	csuo.mutation.SetUpdatedAt(t)
	return csuo
}

// SetParent sets the "parent" edge to the CloudService entity.
func (csuo *CloudServiceUpdateOne) SetParent(c *CloudService) *CloudServiceUpdateOne {
	return csuo.SetParentID(c.ID)
}

// AddChildIDs adds the "children" edge to the CloudService entity by IDs.
func (csuo *CloudServiceUpdateOne) AddChildIDs(ids ...int) *CloudServiceUpdateOne {
	csuo.mutation.AddChildIDs(ids...)
	return csuo
}

// AddChildren adds the "children" edges to the CloudService entity.
func (csuo *CloudServiceUpdateOne) AddChildren(c ...*CloudService) *CloudServiceUpdateOne {
	ids := make([]int, len(c))
	for i := range c {
		ids[i] = c[i].ID
	}
	return csuo.AddChildIDs(ids...)
}

// AddResourceIDs adds the "resources" edge to the CloudResource entity by IDs.
func (csuo *CloudServiceUpdateOne) AddResourceIDs(ids ...int) *CloudServiceUpdateOne {
	csuo.mutation.AddResourceIDs(ids...)
	return csuo
}

// AddResources adds the "resources" edges to the CloudResource entity.
func (csuo *CloudServiceUpdateOne) AddResources(c ...*CloudResource) *CloudServiceUpdateOne {
	ids := make([]int, len(c))
	for i := range c {
		ids[i] = c[i].ID
	}
	return csuo.AddResourceIDs(ids...)
}

// Mutation returns the CloudServiceMutation object of the builder.
func (csuo *CloudServiceUpdateOne) Mutation() *CloudServiceMutation {
	return csuo.mutation
}

// ClearParent clears the "parent" edge to the CloudService entity.
func (csuo *CloudServiceUpdateOne) ClearParent() *CloudServiceUpdateOne {
	csuo.mutation.ClearParent()
	return csuo
}

// ClearChildren clears all "children" edges to the CloudService entity.
func (csuo *CloudServiceUpdateOne) ClearChildren() *CloudServiceUpdateOne {
	csuo.mutation.ClearChildren()
	return csuo
}

// RemoveChildIDs removes the "children" edge to CloudService entities by IDs.
func (csuo *CloudServiceUpdateOne) RemoveChildIDs(ids ...int) *CloudServiceUpdateOne {
	csuo.mutation.RemoveChildIDs(ids...)
	return csuo
}

// RemoveChildren removes "children" edges to CloudService entities.
func (csuo *CloudServiceUpdateOne) RemoveChildren(c ...*CloudService) *CloudServiceUpdateOne {
	ids := make([]int, len(c))
	for i := range c {
		ids[i] = c[i].ID
	}
	return csuo.RemoveChildIDs(ids...)
}

// ClearResources clears all "resources" edges to the CloudResource entity.
func (csuo *CloudServiceUpdateOne) ClearResources() *CloudServiceUpdateOne {
	csuo.mutation.ClearResources()
	return csuo
}

// RemoveResourceIDs removes the "resources" edge to CloudResource entities by IDs.
func (csuo *CloudServiceUpdateOne) RemoveResourceIDs(ids ...int) *CloudServiceUpdateOne {
	csuo.mutation.RemoveResourceIDs(ids...)
	return csuo
}

// RemoveResources removes "resources" edges to CloudResource entities.
func (csuo *CloudServiceUpdateOne) RemoveResources(c ...*CloudResource) *CloudServiceUpdateOne {
	ids := make([]int, len(c))
	for i := range c {
		ids[i] = c[i].ID
	}
	return csuo.RemoveResourceIDs(ids...)
}

// Where appends a list predicates to the CloudServiceUpdate builder.
func (csuo *CloudServiceUpdateOne) Where(ps ...predicate.CloudService) *CloudServiceUpdateOne {
	csuo.mutation.Where(ps...)
	return csuo
}

// Select allows selecting one or more fields (columns) of the returned entity.
// The default is selecting all fields defined in the entity schema.
func (csuo *CloudServiceUpdateOne) Select(field string, fields ...string) *CloudServiceUpdateOne {
	csuo.fields = append([]string{field}, fields...)
	return csuo
}

// Save executes the query and returns the updated CloudService entity.
func (csuo *CloudServiceUpdateOne) Save(ctx context.Context) (*CloudService, error) {
	csuo.defaults()
	return withHooks(ctx, csuo.sqlSave, csuo.mutation, csuo.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (csuo *CloudServiceUpdateOne) SaveX(ctx context.Context) *CloudService {
	node, err := csuo.Save(ctx)
	if err != nil {
		panic(err)
	}
	return node
}

// Exec executes the query on the entity.
func (csuo *CloudServiceUpdateOne) Exec(ctx context.Context) error {
	_, err := csuo.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (csuo *CloudServiceUpdateOne) ExecX(ctx context.Context) {
	if err := csuo.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (csuo *CloudServiceUpdateOne) defaults() {
	if _, ok := csuo.mutation.UpdatedAt(); !ok {
		v := cloudservice.UpdateDefaultUpdatedAt()
		csuo.mutation.SetUpdatedAt(v)
	}
}

// check runs all checks and user-defined validators on the builder.
func (csuo *CloudServiceUpdateOne) check() error {
	if v, ok := csuo.mutation.Provider(); ok {
		if err := cloudservice.ProviderValidator(v); err != nil {
			return &ValidationError{Name: "provider", err: fmt.Errorf(`ent: validator failed for field "CloudService.provider": %w`, err)}
		}
	}
	if v, ok := csuo.mutation.ServiceCode(); ok {
		if err := cloudservice.ServiceCodeValidator(v); err != nil {
			return &ValidationError{Name: "service_code", err: fmt.Errorf(`ent: validator failed for field "CloudService.service_code": %w`, err)}
		}
	}
	if v, ok := csuo.mutation.ServiceName(); ok {
		if err := cloudservice.ServiceNameValidator(v); err != nil {
			return &ValidationError{Name: "service_name", err: fmt.Errorf(`ent: validator failed for field "CloudService.service_name": %w`, err)}
		}
	}
	if v, ok := csuo.mutation.ResourceTypeCode(); ok {
		if err := cloudservice.ResourceTypeCodeValidator(v); err != nil {
			return &ValidationError{Name: "resource_type_code", err: fmt.Errorf(`ent: validator failed for field "CloudService.resource_type_code": %w`, err)}
		}
	}
	if v, ok := csuo.mutation.ResourceTypeName(); ok {
		if err := cloudservice.ResourceTypeNameValidator(v); err != nil {
			return &ValidationError{Name: "resource_type_name", err: fmt.Errorf(`ent: validator failed for field "CloudService.resource_type_name": %w`, err)}
		}
	}
	if v, ok := csuo.mutation.TenantID(); ok {
		if err := cloudservice.TenantIDValidator(v); err != nil {
			return &ValidationError{Name: "tenant_id", err: fmt.Errorf(`ent: validator failed for field "CloudService.tenant_id": %w`, err)}
		}
	}
	return nil
}

func (csuo *CloudServiceUpdateOne) sqlSave(ctx context.Context) (_node *CloudService, err error) {
	if err := csuo.check(); err != nil {
		return _node, err
	}
	_spec := sqlgraph.NewUpdateSpec(cloudservice.Table, cloudservice.Columns, sqlgraph.NewFieldSpec(cloudservice.FieldID, field.TypeInt))
	id, ok := csuo.mutation.ID()
	if !ok {
		return nil, &ValidationError{Name: "id", err: errors.New(`ent: missing "CloudService.id" for update`)}
	}
	_spec.Node.ID.Value = id
	if fields := csuo.fields; len(fields) > 0 {
		_spec.Node.Columns = make([]string, 0, len(fields))
		_spec.Node.Columns = append(_spec.Node.Columns, cloudservice.FieldID)
		for _, f := range fields {
			if !cloudservice.ValidColumn(f) {
				return nil, &ValidationError{Name: f, err: fmt.Errorf("ent: invalid field %q for query", f)}
			}
			if f != cloudservice.FieldID {
				_spec.Node.Columns = append(_spec.Node.Columns, f)
			}
		}
	}
	if ps := csuo.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := csuo.mutation.Provider(); ok {
		_spec.SetField(cloudservice.FieldProvider, field.TypeString, value)
	}
	if value, ok := csuo.mutation.Category(); ok {
		_spec.SetField(cloudservice.FieldCategory, field.TypeString, value)
	}
	if csuo.mutation.CategoryCleared() {
		_spec.ClearField(cloudservice.FieldCategory, field.TypeString)
	}
	if value, ok := csuo.mutation.ServiceCode(); ok {
		_spec.SetField(cloudservice.FieldServiceCode, field.TypeString, value)
	}
	if value, ok := csuo.mutation.ServiceName(); ok {
		_spec.SetField(cloudservice.FieldServiceName, field.TypeString, value)
	}
	if value, ok := csuo.mutation.ResourceTypeCode(); ok {
		_spec.SetField(cloudservice.FieldResourceTypeCode, field.TypeString, value)
	}
	if value, ok := csuo.mutation.ResourceTypeName(); ok {
		_spec.SetField(cloudservice.FieldResourceTypeName, field.TypeString, value)
	}
	if value, ok := csuo.mutation.APIVersion(); ok {
		_spec.SetField(cloudservice.FieldAPIVersion, field.TypeString, value)
	}
	if csuo.mutation.APIVersionCleared() {
		_spec.ClearField(cloudservice.FieldAPIVersion, field.TypeString)
	}
	if value, ok := csuo.mutation.AttributeSchema(); ok {
		_spec.SetField(cloudservice.FieldAttributeSchema, field.TypeJSON, value)
	}
	if csuo.mutation.AttributeSchemaCleared() {
		_spec.ClearField(cloudservice.FieldAttributeSchema, field.TypeJSON)
	}
	if value, ok := csuo.mutation.IsSystem(); ok {
		_spec.SetField(cloudservice.FieldIsSystem, field.TypeBool, value)
	}
	if value, ok := csuo.mutation.IsActive(); ok {
		_spec.SetField(cloudservice.FieldIsActive, field.TypeBool, value)
	}
	if value, ok := csuo.mutation.TenantID(); ok {
		_spec.SetField(cloudservice.FieldTenantID, field.TypeInt, value)
	}
	if value, ok := csuo.mutation.AddedTenantID(); ok {
		_spec.AddField(cloudservice.FieldTenantID, field.TypeInt, value)
	}
	if value, ok := csuo.mutation.CreatedAt(); ok {
		_spec.SetField(cloudservice.FieldCreatedAt, field.TypeTime, value)
	}
	if value, ok := csuo.mutation.UpdatedAt(); ok {
		_spec.SetField(cloudservice.FieldUpdatedAt, field.TypeTime, value)
	}
	if csuo.mutation.ParentCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   cloudservice.ParentTable,
			Columns: []string{cloudservice.ParentColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudservice.FieldID, field.TypeInt),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := csuo.mutation.ParentIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   cloudservice.ParentTable,
			Columns: []string{cloudservice.ParentColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudservice.FieldID, field.TypeInt),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	if csuo.mutation.ChildrenCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2M,
			Inverse: false,
			Table:   cloudservice.ChildrenTable,
			Columns: []string{cloudservice.ChildrenColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudservice.FieldID, field.TypeInt),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := csuo.mutation.RemovedChildrenIDs(); len(nodes) > 0 && !csuo.mutation.ChildrenCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2M,
			Inverse: false,
			Table:   cloudservice.ChildrenTable,
			Columns: []string{cloudservice.ChildrenColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudservice.FieldID, field.TypeInt),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := csuo.mutation.ChildrenIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2M,
			Inverse: false,
			Table:   cloudservice.ChildrenTable,
			Columns: []string{cloudservice.ChildrenColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudservice.FieldID, field.TypeInt),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	if csuo.mutation.ResourcesCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2M,
			Inverse: false,
			Table:   cloudservice.ResourcesTable,
			Columns: []string{cloudservice.ResourcesColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudresource.FieldID, field.TypeInt),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := csuo.mutation.RemovedResourcesIDs(); len(nodes) > 0 && !csuo.mutation.ResourcesCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2M,
			Inverse: false,
			Table:   cloudservice.ResourcesTable,
			Columns: []string{cloudservice.ResourcesColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudresource.FieldID, field.TypeInt),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := csuo.mutation.ResourcesIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.O2M,
			Inverse: false,
			Table:   cloudservice.ResourcesTable,
			Columns: []string{cloudservice.ResourcesColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(cloudresource.FieldID, field.TypeInt),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	_node = &CloudService{config: csuo.config}
	_spec.Assign = _node.assignValues
	_spec.ScanValues = _node.scanValues
	if err = sqlgraph.UpdateNode(ctx, csuo.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{cloudservice.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return nil, err
	}
	csuo.mutation.done = true
	return _node, nil
}
