# 工作流模块 - 扩展流程模板设计

## 1. 扩展模板概述

本文档补充了更多业务场景的流程模板，覆盖ITSM系统的其他重要业务领域。

### 1.1 新增模板分类

| 分类 | 模板数量 | 说明 |
|-----|---------|------|
| 权限管理类 | 3个 | 权限申请、审批、回收 |
| 资产管理类 | 3个 | 资产申请、领用、归还 |
| 知识管理类 | 2个 | 知识审核、发布 |
| SLA管理类 | 2个 | SLA违规处理、升级 |
| 发布管理类 | 2个 | 发布审批、实施 |
| 配置管理类 | 2个 | CI变更、关系维护 |
| 供应商管理类 | 2个 | 供应商评估、合同审批 |
| 培训管理类 | 2个 | 培训申请、评估 |

**总计**：18个扩展模板

## 2. 权限管理流程模板

### 2.1 权限申请审批流程

#### 2.1.1 流程描述

适用于系统访问权限、数据访问权限等权限申请的审批流程。

#### 2.1.2 流程步骤

1. **开始**：权限申请创建
2. **部门主管审批**：部门主管审批权限申请
3. **IT安全审批**：IT安全部门审批
4. **权限授予**：自动或手动授予权限
5. **通知申请人**：通知申请人权限已授予
6. **结束**：流程完成

#### 2.1.3 JSON定义

```json
{
  "name": "权限申请审批流程",
  "type": "access_control",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "权限申请",
      "type": "start"
    },
    {
      "id": "manager_approval",
      "name": "部门主管审批",
      "type": "approval",
      "assignee_rule": {
        "type": "expression",
        "expression": "${assigneeService.getManagerByDepartment(requester_department)}"
      },
      "timeout": 1440,
      "form_key": "access_request_approval_form"
    },
    {
      "id": "security_approval",
      "name": "IT安全审批",
      "type": "approval",
      "candidate_groups": ["Security_Department"],
      "timeout": 2880,
      "form_key": "security_approval_form",
      "conditional": true
    },
    {
      "id": "grant_access",
      "name": "权限授予",
      "type": "service",
      "service_type": "internal",
      "service_name": "AccessControlService",
      "method": "grantAccess",
      "timeout": 300
    },
    {
      "id": "notify_user",
      "name": "通知申请人",
      "type": "service",
      "service_type": "internal",
      "service_name": "NotificationService",
      "method": "sendAccessGrantedNotification",
      "timeout": 30
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "manager_approval",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "manager_approval",
      "to_step": "security_approval",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t3",
      "from_step": "manager_approval",
      "to_step": "end",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "rejected"
      }
    },
    {
      "id": "t4",
      "from_step": "security_approval",
      "to_step": "grant_access",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t5",
      "from_step": "grant_access",
      "to_step": "notify_user",
      "auto": true
    },
    {
      "id": "t6",
      "from_step": "notify_user",
      "to_step": "end",
      "auto": true
    }
  ],
  "variables": {
    "access_request_id": {
      "type": "integer",
      "required": true
    },
    "requester_id": {
      "type": "integer",
      "required": true
    },
    "resource_type": {
      "type": "string",
      "enum": ["system", "data", "application"]
    },
    "resource_id": {
      "type": "integer"
    },
    "access_level": {
      "type": "string",
      "enum": ["read", "write", "admin"]
    },
    "requires_security_approval": {
      "type": "boolean",
      "default": false
    }
  }
}
```

### 2.2 权限回收流程

#### 2.2.1 流程描述

适用于员工离职、调岗等场景下的权限回收流程。

#### 2.2.2 流程步骤

1. **开始**：权限回收申请
2. **确认回收范围**：确认需要回收的权限
3. **权限回收**：执行权限回收
4. **验证回收结果**：验证权限是否已回收
5. **通知相关人员**：通知权限已回收
6. **结束**：流程完成

#### 2.2.3 JSON定义

```json
{
  "name": "权限回收流程",
  "type": "access_control",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "权限回收申请",
      "type": "start"
    },
    {
      "id": "confirm_scope",
      "name": "确认回收范围",
      "type": "task",
      "candidate_groups": ["IT_Admin_Team"],
      "timeout": 1440,
      "form_key": "access_revoke_scope_form"
    },
    {
      "id": "revoke_access",
      "name": "权限回收",
      "type": "service",
      "service_type": "internal",
      "service_name": "AccessControlService",
      "method": "revokeAccess",
      "timeout": 600
    },
    {
      "id": "verify_revocation",
      "name": "验证回收结果",
      "type": "service",
      "service_type": "internal",
      "service_name": "AccessControlService",
      "method": "verifyAccessRevocation",
      "timeout": 300
    },
    {
      "id": "notify_stakeholders",
      "name": "通知相关人员",
      "type": "service",
      "service_type": "internal",
      "service_name": "NotificationService",
      "method": "sendAccessRevokedNotification",
      "timeout": 30
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "confirm_scope",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "confirm_scope",
      "to_step": "revoke_access",
      "auto": true
    },
    {
      "id": "t3",
      "from_step": "revoke_access",
      "to_step": "verify_revocation",
      "auto": true
    },
    {
      "id": "t4",
      "from_step": "verify_revocation",
      "to_step": "notify_stakeholders",
      "auto": true
    },
    {
      "id": "t5",
      "from_step": "notify_stakeholders",
      "to_step": "end",
      "auto": true
    }
  ]
}
```

## 3. 资产管理流程模板

### 3.1 资产申请流程

#### 3.1.1 流程描述

适用于IT资产（硬件、软件、设备）的申请和审批流程。

#### 3.1.2 流程步骤

1. **开始**：资产申请创建
2. **部门主管审批**：审批资产申请
3. **IT部门审批**：IT部门评估需求
4. **采购审批**：财务/采购部门审批（如需要）
5. **资产采购**：执行采购流程
6. **资产入库**：资产入库登记
7. **通知申请人**：通知申请人资产已就绪
8. **结束**：流程完成

#### 3.1.3 JSON定义

```json
{
  "name": "资产申请流程",
  "type": "asset_management",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "资产申请",
      "type": "start"
    },
    {
      "id": "manager_approval",
      "name": "部门主管审批",
      "type": "approval",
      "assignee_rule": {
        "type": "expression",
        "expression": "${assigneeService.getManagerByDepartment(requester_department)}"
      },
      "timeout": 1440
    },
    {
      "id": "it_approval",
      "name": "IT部门审批",
      "type": "approval",
      "candidate_groups": ["IT_Department"],
      "timeout": 2880
    },
    {
      "id": "purchase_approval",
      "name": "采购审批",
      "type": "approval",
      "candidate_groups": ["Finance_Department", "Procurement_Department"],
      "timeout": 2880,
      "conditional": true
    },
    {
      "id": "purchase_asset",
      "name": "资产采购",
      "type": "task",
      "candidate_groups": ["Procurement_Department"],
      "timeout": 14400
    },
    {
      "id": "asset_inbound",
      "name": "资产入库",
      "type": "task",
      "candidate_groups": ["Asset_Management_Team"],
      "timeout": 1440
    },
    {
      "id": "notify_user",
      "name": "通知申请人",
      "type": "service",
      "service_type": "internal",
      "service_name": "NotificationService",
      "method": "sendAssetReadyNotification",
      "timeout": 30
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "manager_approval",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "manager_approval",
      "to_step": "it_approval",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t3",
      "from_step": "it_approval",
      "to_step": "purchase_approval",
      "condition": {
        "type": "expression",
        "expression": "${asset_cost > 10000 || requires_purchase == true}"
      }
    },
    {
      "id": "t4",
      "from_step": "it_approval",
      "to_step": "purchase_asset",
      "condition": {
        "type": "expression",
        "expression": "${asset_cost <= 10000 && requires_purchase == false}"
      }
    },
    {
      "id": "t5",
      "from_step": "purchase_approval",
      "to_step": "purchase_asset",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t6",
      "from_step": "purchase_asset",
      "to_step": "asset_inbound",
      "auto": true
    },
    {
      "id": "t7",
      "from_step": "asset_inbound",
      "to_step": "notify_user",
      "auto": true
    },
    {
      "id": "t8",
      "from_step": "notify_user",
      "to_step": "end",
      "auto": true
    }
  ],
  "variables": {
    "asset_request_id": {
      "type": "integer",
      "required": true
    },
    "asset_type": {
      "type": "string",
      "enum": ["hardware", "software", "equipment"]
    },
    "asset_cost": {
      "type": "decimal"
    },
    "requires_purchase": {
      "type": "boolean",
      "default": true
    }
  }
}
```

### 3.2 资产领用流程

#### 3.2.1 流程描述

适用于已入库资产的领用流程。

#### 3.2.2 流程步骤

1. **开始**：资产领用申请
2. **检查库存**：检查资产库存是否充足
3. **部门审批**：部门主管审批（如需要）
4. **资产出库**：执行资产出库
5. **资产登记**：登记资产领用信息
6. **通知领用人**：通知领用人
7. **结束**：流程完成

#### 3.2.3 JSON定义

```json
{
  "name": "资产领用流程",
  "type": "asset_management",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "资产领用申请",
      "type": "start"
    },
    {
      "id": "check_inventory",
      "name": "检查库存",
      "type": "service",
      "service_type": "internal",
      "service_name": "AssetService",
      "method": "checkInventory",
      "timeout": 30
    },
    {
      "id": "manager_approval",
      "name": "部门审批",
      "type": "approval",
      "assignee_rule": {
        "type": "expression",
        "expression": "${assigneeService.getManagerByDepartment(requester_department)}"
      },
      "timeout": 1440,
      "conditional": true
    },
    {
      "id": "asset_outbound",
      "name": "资产出库",
      "type": "task",
      "candidate_groups": ["Asset_Management_Team"],
      "timeout": 1440
    },
    {
      "id": "register_asset",
      "name": "资产登记",
      "type": "service",
      "service_type": "internal",
      "service_name": "AssetService",
      "method": "registerAssetAssignment",
      "timeout": 120
    },
    {
      "id": "notify_user",
      "name": "通知领用人",
      "type": "service",
      "service_type": "internal",
      "service_name": "NotificationService",
      "method": "sendAssetAssignedNotification",
      "timeout": 30
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "check_inventory",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "check_inventory",
      "to_step": "manager_approval",
      "condition": {
        "type": "expression",
        "expression": "${inventory_available == true && asset_cost > 5000}"
      }
    },
    {
      "id": "t3",
      "from_step": "check_inventory",
      "to_step": "asset_outbound",
      "condition": {
        "type": "expression",
        "expression": "${inventory_available == true && asset_cost <= 5000}"
      }
    },
    {
      "id": "t4",
      "from_step": "manager_approval",
      "to_step": "asset_outbound",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t5",
      "from_step": "asset_outbound",
      "to_step": "register_asset",
      "auto": true
    },
    {
      "id": "t6",
      "from_step": "register_asset",
      "to_step": "notify_user",
      "auto": true
    },
    {
      "id": "t7",
      "from_step": "notify_user",
      "to_step": "end",
      "auto": true
    }
  ]
}
```

## 4. 知识管理流程模板

### 4.1 知识文章审核发布流程

#### 4.1.1 流程描述

适用于知识库文章的审核和发布流程，确保知识质量。

#### 4.1.2 流程步骤

1. **开始**：知识文章创建
2. **内容审核**：知识管理员审核内容
3. **技术审核**：技术专家审核技术准确性（如需要）
4. **发布**：发布文章到知识库
5. **通知作者**：通知作者文章已发布
6. **结束**：流程完成

#### 4.1.3 JSON定义

```json
{
  "name": "知识文章审核发布流程",
  "type": "knowledge_base",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "知识文章创建",
      "type": "start"
    },
    {
      "id": "content_review",
      "name": "内容审核",
      "type": "approval",
      "candidate_groups": ["Knowledge_Management_Team"],
      "timeout": 2880,
      "form_key": "knowledge_content_review_form"
    },
    {
      "id": "technical_review",
      "name": "技术审核",
      "type": "approval",
      "candidate_groups": ["Technical_Experts"],
      "timeout": 2880,
      "conditional": true,
      "form_key": "knowledge_technical_review_form"
    },
    {
      "id": "publish_article",
      "name": "发布文章",
      "type": "service",
      "service_type": "internal",
      "service_name": "KnowledgeService",
      "method": "publishArticle",
      "timeout": 60
    },
    {
      "id": "notify_author",
      "name": "通知作者",
      "type": "service",
      "service_type": "internal",
      "service_name": "NotificationService",
      "method": "sendArticlePublishedNotification",
      "timeout": 30
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "content_review",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "content_review",
      "to_step": "technical_review",
      "condition": {
        "type": "expression",
        "expression": "${approval_result == 'approved' && article_type == 'technical'}"
      }
    },
    {
      "id": "t3",
      "from_step": "content_review",
      "to_step": "publish_article",
      "condition": {
        "type": "expression",
        "expression": "${approval_result == 'approved' && article_type != 'technical'}"
      }
    },
    {
      "id": "t4",
      "from_step": "technical_review",
      "to_step": "publish_article",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t5",
      "from_step": "publish_article",
      "to_step": "notify_author",
      "auto": true
    },
    {
      "id": "t6",
      "from_step": "notify_author",
      "to_step": "end",
      "auto": true
    }
  ],
  "variables": {
    "article_id": {
      "type": "integer",
      "required": true
    },
    "article_type": {
      "type": "string",
      "enum": ["general", "technical", "faq", "procedure"]
    },
    "author_id": {
      "type": "integer",
      "required": true
    }
  }
}
```

## 5. SLA管理流程模板

### 5.1 SLA违规处理流程

#### 5.1.1 流程描述

适用于SLA违规后的处理流程，包括通知、升级、处理等环节。

#### 5.1.2 流程步骤

1. **开始**：SLA违规检测
2. **发送违规通知**：通知相关人员
3. **违规分析**：分析违规原因
4. **处理方案**：制定处理方案
5. **方案实施**：实施处理方案
6. **验证结果**：验证SLA是否恢复
7. **记录违规**：记录违规信息
8. **结束**：流程完成

#### 5.1.3 JSON定义

```json
{
  "name": "SLA违规处理流程",
  "type": "sla_management",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "SLA违规检测",
      "type": "start"
    },
    {
      "id": "send_violation_notice",
      "name": "发送违规通知",
      "type": "service",
      "service_type": "internal",
      "service_name": "NotificationService",
      "method": "sendSLAViolationNotification",
      "timeout": 30
    },
    {
      "id": "analyze_violation",
      "name": "违规分析",
      "type": "task",
      "candidate_groups": ["SLA_Management_Team"],
      "timeout": 1440,
      "form_key": "sla_violation_analysis_form"
    },
    {
      "id": "create_action_plan",
      "name": "处理方案",
      "type": "task",
      "candidate_groups": ["SLA_Management_Team", "IT_Support_Team"],
      "timeout": 2880,
      "form_key": "sla_action_plan_form"
    },
    {
      "id": "implement_plan",
      "name": "方案实施",
      "type": "task",
      "assignee_rule": {
        "type": "field",
        "field": "assignee_id"
      },
      "timeout": 14400
    },
    {
      "id": "verify_sla",
      "name": "验证SLA",
      "type": "service",
      "service_type": "internal",
      "service_name": "SLAService",
      "method": "verifySLACompliance",
      "timeout": 300
    },
    {
      "id": "record_violation",
      "name": "记录违规",
      "type": "service",
      "service_type": "internal",
      "service_name": "SLAService",
      "method": "recordViolation",
      "timeout": 60
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "send_violation_notice",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "send_violation_notice",
      "to_step": "analyze_violation",
      "auto": true
    },
    {
      "id": "t3",
      "from_step": "analyze_violation",
      "to_step": "create_action_plan",
      "auto": true
    },
    {
      "id": "t4",
      "from_step": "create_action_plan",
      "to_step": "implement_plan",
      "auto": true
    },
    {
      "id": "t5",
      "from_step": "implement_plan",
      "to_step": "verify_sla",
      "auto": true
    },
    {
      "id": "t6",
      "from_step": "verify_sla",
      "to_step": "record_violation",
      "auto": true
    },
    {
      "id": "t7",
      "from_step": "record_violation",
      "to_step": "end",
      "auto": true
    }
  ],
  "variables": {
    "sla_violation_id": {
      "type": "integer",
      "required": true
    },
    "ticket_id": {
      "type": "integer"
    },
    "sla_definition_id": {
      "type": "integer",
      "required": true
    },
    "violation_type": {
      "type": "string",
      "enum": ["response_time", "resolution_time", "availability"]
    },
    "violation_severity": {
      "type": "string",
      "enum": ["minor", "major", "critical"]
    }
  }
}
```

### 5.2 SLA升级流程

#### 5.2.1 流程描述

适用于SLA即将超时或已超时时的升级处理流程。

#### 5.2.2 流程步骤

1. **开始**：SLA升级触发
2. **发送升级通知**：通知相关人员
3. **升级处理**：升级处理优先级
4. **监控处理进度**：持续监控
5. **结束**：流程完成

#### 5.2.3 JSON定义

```json
{
  "name": "SLA升级流程",
  "type": "sla_management",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "SLA升级触发",
      "type": "start"
    },
    {
      "id": "send_escalation_notice",
      "name": "发送升级通知",
      "type": "service",
      "service_type": "internal",
      "service_name": "NotificationService",
      "method": "sendSLAEscalationNotification",
      "timeout": 30
    },
    {
      "id": "escalate_ticket",
      "name": "升级处理",
      "type": "service",
      "service_type": "internal",
      "service_name": "TicketService",
      "method": "escalateTicket",
      "timeout": 60
    },
    {
      "id": "monitor_progress",
      "name": "监控处理进度",
      "type": "task",
      "candidate_groups": ["SLA_Management_Team"],
      "timeout": 14400
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "send_escalation_notice",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "send_escalation_notice",
      "to_step": "escalate_ticket",
      "auto": true
    },
    {
      "id": "t3",
      "from_step": "escalate_ticket",
      "to_step": "monitor_progress",
      "auto": true
    },
    {
      "id": "t4",
      "from_step": "monitor_progress",
      "to_step": "end",
      "auto": true
    }
  ]
}
```

## 6. 发布管理流程模板

### 6.1 发布审批流程

#### 6.1.1 流程描述

适用于软件发布、系统更新的审批流程。

#### 6.1.2 流程步骤

1. **开始**：发布申请创建
2. **技术评审**：技术团队评审发布内容
3. **变更委员会审批**：变更委员会审批
4. **发布窗口确认**：确认发布窗口
5. **发布准备**：准备发布环境
6. **结束**：流程完成

#### 6.1.3 JSON定义

```json
{
  "name": "发布审批流程",
  "type": "release_management",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "发布申请",
      "type": "start"
    },
    {
      "id": "technical_review",
      "name": "技术评审",
      "type": "approval",
      "candidate_groups": ["Technical_Team", "QA_Team"],
      "timeout": 4320,
      "form_key": "release_technical_review_form"
    },
    {
      "id": "cab_approval",
      "name": "变更委员会审批",
      "type": "approval",
      "candidate_groups": ["Change_Advisory_Board"],
      "timeout": 2880,
      "form_key": "release_cab_approval_form"
    },
    {
      "id": "confirm_window",
      "name": "发布窗口确认",
      "type": "task",
      "candidate_groups": ["Release_Management_Team"],
      "timeout": 1440,
      "form_key": "release_window_form"
    },
    {
      "id": "prepare_release",
      "name": "发布准备",
      "type": "task",
      "candidate_groups": ["Release_Management_Team", "DevOps_Team"],
      "timeout": 14400
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "technical_review",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "technical_review",
      "to_step": "cab_approval",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t3",
      "from_step": "cab_approval",
      "to_step": "confirm_window",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t4",
      "from_step": "confirm_window",
      "to_step": "prepare_release",
      "auto": true
    },
    {
      "id": "t5",
      "from_step": "prepare_release",
      "to_step": "end",
      "auto": true
    }
  ],
  "variables": {
    "release_id": {
      "type": "integer",
      "required": true
    },
    "release_type": {
      "type": "string",
      "enum": ["major", "minor", "patch", "hotfix"]
    },
    "risk_level": {
      "type": "string",
      "enum": ["low", "medium", "high"]
    }
  }
}
```

### 6.2 发布实施流程

#### 6.2.1 流程描述

适用于发布实施阶段的自动化流程。

#### 6.2.2 流程步骤

1. **开始**：发布审批通过
2. **备份系统**：备份当前系统
3. **执行发布**：执行发布操作
4. **验证发布**：验证发布结果
5. **回滚判断**：判断是否需要回滚
6. **发布完成**：发布成功
7. **回滚执行**：执行回滚（如需要）
8. **结束**：流程完成

#### 6.2.3 JSON定义

```json
{
  "name": "发布实施流程",
  "type": "release_management",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "发布审批通过",
      "type": "start"
    },
    {
      "id": "backup_system",
      "name": "备份系统",
      "type": "service",
      "service_type": "internal",
      "service_name": "BackupService",
      "method": "backupSystem",
      "timeout": 1800
    },
    {
      "id": "execute_release",
      "name": "执行发布",
      "type": "service",
      "service_type": "internal",
      "service_name": "ReleaseService",
      "method": "executeRelease",
      "timeout": 3600
    },
    {
      "id": "verify_release",
      "name": "验证发布",
      "type": "service",
      "service_type": "internal",
      "service_name": "ReleaseService",
      "method": "verifyRelease",
      "timeout": 600
    },
    {
      "id": "rollback_decision",
      "name": "回滚判断",
      "type": "task",
      "candidate_groups": ["Release_Management_Team"],
      "timeout": 300
    },
    {
      "id": "release_complete",
      "name": "发布完成",
      "type": "service",
      "service_type": "internal",
      "service_name": "ReleaseService",
      "method": "completeRelease",
      "timeout": 60
    },
    {
      "id": "rollback_execute",
      "name": "执行回滚",
      "type": "service",
      "service_type": "internal",
      "service_name": "ReleaseService",
      "method": "rollbackRelease",
      "timeout": 1800
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "backup_system",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "backup_system",
      "to_step": "execute_release",
      "auto": true
    },
    {
      "id": "t3",
      "from_step": "execute_release",
      "to_step": "verify_release",
      "auto": true
    },
    {
      "id": "t4",
      "from_step": "verify_release",
      "to_step": "rollback_decision",
      "auto": true
    },
    {
      "id": "t5",
      "from_step": "rollback_decision",
      "to_step": "release_complete",
      "condition": {
        "type": "field",
        "field": "verification_result",
        "operator": "equals",
        "value": "success"
      }
    },
    {
      "id": "t6",
      "from_step": "rollback_decision",
      "to_step": "rollback_execute",
      "condition": {
        "type": "field",
        "field": "verification_result",
        "operator": "equals",
        "value": "failed"
      }
    },
    {
      "id": "t7",
      "from_step": "release_complete",
      "to_step": "end",
      "auto": true
    },
    {
      "id": "t8",
      "from_step": "rollback_execute",
      "to_step": "end",
      "auto": true
    }
  ],
  "error_handling": {
    "execute_release": {
      "on_error": "rollback",
      "rollback_step": "backup_system"
    },
    "verify_release": {
      "on_error": "rollback",
      "rollback_step": "backup_system"
    }
  }
}
```

## 7. 配置管理流程模板

### 7.1 CI变更流程

#### 7.1.1 流程描述

适用于配置项（CI）的变更流程，确保CMDB数据准确性。

#### 7.1.2 流程步骤

1. **开始**：CI变更申请
2. **变更评估**：评估变更影响
3. **变更审批**：审批CI变更
4. **执行变更**：更新CMDB
5. **验证变更**：验证变更结果
6. **结束**：流程完成

#### 7.1.3 JSON定义

```json
{
  "name": "CI变更流程",
  "type": "cmdb",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "CI变更申请",
      "type": "start"
    },
    {
      "id": "change_assessment",
      "name": "变更评估",
      "type": "task",
      "candidate_groups": ["CMDB_Management_Team"],
      "timeout": 2880,
      "form_key": "ci_change_assessment_form"
    },
    {
      "id": "change_approval",
      "name": "变更审批",
      "type": "approval",
      "candidate_groups": ["CMDB_Management_Team", "IT_Management"],
      "timeout": 2880,
      "form_key": "ci_change_approval_form"
    },
    {
      "id": "execute_change",
      "name": "执行变更",
      "type": "service",
      "service_type": "internal",
      "service_name": "CMDBService",
      "method": "updateConfigurationItem",
      "timeout": 300
    },
    {
      "id": "verify_change",
      "name": "验证变更",
      "type": "service",
      "service_type": "internal",
      "service_name": "CMDBService",
      "method": "verifyCIChange",
      "timeout": 180
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "change_assessment",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "change_assessment",
      "to_step": "change_approval",
      "auto": true
    },
    {
      "id": "t3",
      "from_step": "change_approval",
      "to_step": "execute_change",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t4",
      "from_step": "execute_change",
      "to_step": "verify_change",
      "auto": true
    },
    {
      "id": "t5",
      "from_step": "verify_change",
      "to_step": "end",
      "auto": true
    }
  ],
  "variables": {
    "ci_change_id": {
      "type": "integer",
      "required": true
    },
    "ci_id": {
      "type": "integer",
      "required": true
    },
    "change_type": {
      "type": "string",
      "enum": ["create", "update", "delete", "relationship"]
    }
  }
}
```

## 8. 供应商管理流程模板

### 8.1 供应商评估流程

#### 8.1.1 流程描述

适用于新供应商的评估和准入流程。

#### 8.1.2 流程步骤

1. **开始**：供应商申请
2. **初步评估**：初步评估供应商资质
3. **详细评估**：详细评估供应商能力
4. **评估审批**：审批评估结果
5. **供应商注册**：注册供应商信息
6. **结束**：流程完成

#### 8.1.3 JSON定义

```json
{
  "name": "供应商评估流程",
  "type": "vendor_management",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "供应商申请",
      "type": "start"
    },
    {
      "id": "initial_assessment",
      "name": "初步评估",
      "type": "task",
      "candidate_groups": ["Procurement_Team"],
      "timeout": 2880,
      "form_key": "vendor_initial_assessment_form"
    },
    {
      "id": "detailed_assessment",
      "name": "详细评估",
      "type": "task",
      "candidate_groups": ["Procurement_Team", "Technical_Team", "Finance_Team"],
      "timeout": 7200,
      "form_key": "vendor_detailed_assessment_form"
    },
    {
      "id": "assessment_approval",
      "name": "评估审批",
      "type": "approval",
      "candidate_groups": ["Management_Team"],
      "timeout": 2880,
      "form_key": "vendor_assessment_approval_form"
    },
    {
      "id": "register_vendor",
      "name": "供应商注册",
      "type": "service",
      "service_type": "internal",
      "service_name": "VendorService",
      "method": "registerVendor",
      "timeout": 300
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "initial_assessment",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "initial_assessment",
      "to_step": "detailed_assessment",
      "condition": {
        "type": "field",
        "field": "initial_assessment_result",
        "operator": "equals",
        "value": "passed"
      }
    },
    {
      "id": "t3",
      "from_step": "detailed_assessment",
      "to_step": "assessment_approval",
      "auto": true
    },
    {
      "id": "t4",
      "from_step": "assessment_approval",
      "to_step": "register_vendor",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t5",
      "from_step": "register_vendor",
      "to_step": "end",
      "auto": true
    }
  ]
}
```

### 8.2 合同审批流程

#### 8.2.1 流程描述

适用于供应商合同的审批流程。

#### 8.2.2 流程步骤

1. **开始**：合同创建
2. **法务审核**：法务部门审核合同条款
3. **财务审核**：财务部门审核合同金额
4. **管理层审批**：管理层最终审批
5. **合同签署**：执行合同签署
6. **结束**：流程完成

#### 8.2.3 JSON定义

```json
{
  "name": "合同审批流程",
  "type": "vendor_management",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "合同创建",
      "type": "start"
    },
    {
      "id": "legal_review",
      "name": "法务审核",
      "type": "approval",
      "candidate_groups": ["Legal_Department"],
      "timeout": 4320,
      "form_key": "contract_legal_review_form"
    },
    {
      "id": "finance_review",
      "name": "财务审核",
      "type": "approval",
      "candidate_groups": ["Finance_Department"],
      "timeout": 4320,
      "form_key": "contract_finance_review_form"
    },
    {
      "id": "management_approval",
      "name": "管理层审批",
      "type": "approval",
      "candidate_groups": ["Management_Team"],
      "timeout": 2880,
      "form_key": "contract_management_approval_form"
    },
    {
      "id": "sign_contract",
      "name": "合同签署",
      "type": "task",
      "candidate_groups": ["Procurement_Team"],
      "timeout": 14400
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "legal_review",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "legal_review",
      "to_step": "finance_review",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t3",
      "from_step": "finance_review",
      "to_step": "management_approval",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t4",
      "from_step": "management_approval",
      "to_step": "sign_contract",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t5",
      "from_step": "sign_contract",
      "to_step": "end",
      "auto": true
    }
  ],
  "variables": {
    "contract_id": {
      "type": "integer",
      "required": true
    },
    "contract_amount": {
      "type": "decimal"
    },
    "vendor_id": {
      "type": "integer",
      "required": true
    }
  }
}
```

## 9. 培训管理流程模板

### 9.1 培训申请流程

#### 9.1.1 流程描述

适用于员工培训申请的审批流程。

#### 9.1.2 流程步骤

1. **开始**：培训申请创建
2. **部门审批**：部门主管审批
3. **HR审批**：HR部门审批
4. **培训安排**：安排培训时间和地点
5. **通知学员**：通知学员培训信息
6. **结束**：流程完成

#### 9.1.3 JSON定义

```json
{
  "name": "培训申请流程",
  "type": "training_management",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "培训申请",
      "type": "start"
    },
    {
      "id": "department_approval",
      "name": "部门审批",
      "type": "approval",
      "assignee_rule": {
        "type": "expression",
        "expression": "${assigneeService.getManagerByDepartment(requester_department)}"
      },
      "timeout": 1440,
      "form_key": "training_department_approval_form"
    },
    {
      "id": "hr_approval",
      "name": "HR审批",
      "type": "approval",
      "candidate_groups": ["HR_Department"],
      "timeout": 2880,
      "form_key": "training_hr_approval_form"
    },
    {
      "id": "arrange_training",
      "name": "培训安排",
      "type": "task",
      "candidate_groups": ["Training_Team"],
      "timeout": 2880,
      "form_key": "training_arrangement_form"
    },
    {
      "id": "notify_trainees",
      "name": "通知学员",
      "type": "service",
      "service_type": "internal",
      "service_name": "NotificationService",
      "method": "sendTrainingNotification",
      "timeout": 30
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "department_approval",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "department_approval",
      "to_step": "hr_approval",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t3",
      "from_step": "hr_approval",
      "to_step": "arrange_training",
      "condition": {
        "type": "field",
        "field": "approval_result",
        "operator": "equals",
        "value": "approved"
      }
    },
    {
      "id": "t4",
      "from_step": "arrange_training",
      "to_step": "notify_trainees",
      "auto": true
    },
    {
      "id": "t5",
      "from_step": "notify_trainees",
      "to_step": "end",
      "auto": true
    }
  ],
  "variables": {
    "training_request_id": {
      "type": "integer",
      "required": true
    },
    "training_type": {
      "type": "string",
      "enum": ["internal", "external", "online"]
    },
    "training_cost": {
      "type": "decimal"
    }
  }
}
```

### 9.2 培训评估流程

#### 9.2.1 流程描述

适用于培训完成后的评估流程。

#### 9.2.2 流程步骤

1. **开始**：培训完成
2. **学员评估**：学员填写培训评估
3. **讲师评估**：讲师评估学员表现
4. **培训总结**：生成培训总结报告
5. **结束**：流程完成

#### 9.2.3 JSON定义

```json
{
  "name": "培训评估流程",
  "type": "training_management",
  "version": "1.0.0",
  "steps": [
    {
      "id": "start",
      "name": "培训完成",
      "type": "start"
    },
    {
      "id": "trainee_evaluation",
      "name": "学员评估",
      "type": "task",
      "assignee_rule": {
        "type": "field",
        "field": "trainee_id"
      },
      "timeout": 1440,
      "form_key": "trainee_evaluation_form"
    },
    {
      "id": "instructor_evaluation",
      "name": "讲师评估",
      "type": "task",
      "assignee_rule": {
        "type": "field",
        "field": "instructor_id"
      },
      "timeout": 1440,
      "form_key": "instructor_evaluation_form"
    },
    {
      "id": "generate_summary",
      "name": "培训总结",
      "type": "service",
      "service_type": "internal",
      "service_name": "TrainingService",
      "method": "generateTrainingSummary",
      "timeout": 300
    },
    {
      "id": "end",
      "name": "结束",
      "type": "end"
    }
  ],
  "transitions": [
    {
      "id": "t1",
      "from_step": "start",
      "to_step": "trainee_evaluation",
      "auto": true
    },
    {
      "id": "t2",
      "from_step": "trainee_evaluation",
      "to_step": "instructor_evaluation",
      "auto": true
    },
    {
      "id": "t3",
      "from_step": "instructor_evaluation",
      "to_step": "generate_summary",
      "auto": true
    },
    {
      "id": "t4",
      "from_step": "generate_summary",
      "to_step": "end",
      "auto": true
    }
  ]
}
```

## 10. 模板使用统计

### 10.1 模板分类统计

| 分类 | 模板数量 | 平均复杂度 | 平均步骤数 |
|-----|---------|-----------|-----------|
| 工单管理 | 3 | 中等 | 5 |
| 变更管理 | 2 | 中等 | 6 |
| 服务请求 | 2 | 中等 | 6 |
| 事件管理 | 1 | 中等 | 6 |
| 问题管理 | 1 | 复杂 | 8 |
| 权限管理 | 2 | 中等 | 6 |
| 资产管理 | 2 | 中等 | 7 |
| 知识管理 | 1 | 简单 | 6 |
| SLA管理 | 2 | 中等 | 7 |
| 发布管理 | 2 | 复杂 | 6 |
| 配置管理 | 1 | 中等 | 6 |
| 供应商管理 | 2 | 中等 | 6 |
| 培训管理 | 2 | 简单 | 5 |

**总计**：28个流程模板

### 10.2 模板复杂度分布

- **简单模板**（3-4步）：4个
- **中等模板**（5-7步）：20个
- **复杂模板**（8+步）：4个

## 11. 模板最佳实践

### 11.1 模板选择指南

| 业务场景 | 推荐模板 | 复杂度 | 说明 |
|---------|---------|--------|------|
| 普通权限申请 | 权限申请审批流程 | 中等 | 标准审批流程 |
| 员工离职 | 权限回收流程 | 中等 | 自动化回收 |
| 硬件申请 | 资产申请流程 | 中等 | 包含采购环节 |
| 资产领用 | 资产领用流程 | 中等 | 快速领用 |
| 知识发布 | 知识文章审核发布流程 | 简单 | 质量保证 |
| SLA违规 | SLA违规处理流程 | 中等 | 完整处理流程 |
| 软件发布 | 发布审批流程 | 中等 | 标准发布流程 |
| CI更新 | CI变更流程 | 中等 | 确保数据准确 |
| 新供应商 | 供应商评估流程 | 中等 | 完整评估 |
| 培训申请 | 培训申请流程 | 简单 | 标准审批 |

### 11.2 模板配置建议

1. **超时设置**：根据实际业务处理时间设置
2. **分配规则**：使用表达式实现动态分配
3. **条件判断**：简化条件表达式，提高可读性
4. **错误处理**：配置合理的错误处理策略
5. **通知配置**：确保关键节点都有通知

---

**文档版本**：V1.0  
**创建日期**：2025-12-17  
**最后更新**：2025-12-17  
**维护人**：产品团队
