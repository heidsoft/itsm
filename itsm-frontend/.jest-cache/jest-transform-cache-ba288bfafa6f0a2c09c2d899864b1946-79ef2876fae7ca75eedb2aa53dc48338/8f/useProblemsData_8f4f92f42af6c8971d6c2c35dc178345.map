{"version":3,"names":["cov_1py3g65ub5","actualCoverage","s","useProblemsData","f","problems","setProblems","_react","useState","loading","setLoading","filter","setFilter","searchText","setSearchText","pagination","setPagination","current","pageSize","total","stats","setStats","open","inProgress","resolved","useEffect","fetchProblems","fetchStats","params","page","page_size","b","Object","assign","status","keyword","response","_problemservice","problemService","listProblems","prev","_antd","message","error","console","log","handleTableChange"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/app/(main)/problems/hooks/useProblemsData.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport {\n  problemService,\n  Problem,\n  ProblemStatus,\n  ListProblemsParams,\n} from '@/lib/services/problem-service';\nimport { message } from 'antd';\n\nexport const useProblemsData = () => {\n  const [problems, setProblems] = useState<Problem[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [filter, setFilter] = useState<string>('');\n  const [searchText, setSearchText] = useState('');\n  const [pagination, setPagination] = useState({\n    current: 1,\n    pageSize: 10,\n    total: 0,\n  });\n  const [stats, setStats] = useState({\n    total: 0,\n    open: 0,\n    inProgress: 0,\n    resolved: 0,\n  });\n\n  useEffect(() => {\n    fetchProblems();\n    fetchStats();\n  }, [pagination.current, pagination.pageSize, filter, searchText]);\n\n  const fetchProblems = async () => {\n    setLoading(true);\n    try {\n      const params: ListProblemsParams = {\n        page: pagination.current,\n        page_size: pagination.pageSize,\n      };\n\n      if (filter) {\n        Object.assign(params, { status: filter as ProblemStatus });\n      }\n\n      if (searchText) {\n        Object.assign(params, { keyword: searchText });\n      }\n\n      const response = await problemService.listProblems(params);\n      setProblems(response.problems);\n      setPagination(prev => ({ ...prev, total: response.total }));\n    } catch {\n      message.error('获取问题列表失败');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchStats = async () => {\n    try {\n      // TODO: 实现统计数据获取\n      console.log('获取统计数据');\n    } catch {\n      message.error('获取统计数据失败');\n    }\n  };\n\n  const handleTableChange = (page: number, pageSize?: number) => {\n    setPagination(prev => ({\n      ...prev,\n      current: page,\n      pageSize: pageSize || prev.pageSize,\n    }));\n  };\n\n  return {\n    problems,\n    loading,\n    filter,\n    setFilter,\n    searchText,\n    setSearchText,\n    pagination,\n    handleTableChange,\n    stats,\n    fetchProblems,\n  };\n};\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAYS;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAAAA,cAAA,GAAAE,CAAA;;;;;;+BADI;;;;;;WAAAC,eAAA;;;;;kCATuB;;;kCAM7B;;;kCACiB;AAAA;AAAAH,cAAA,GAAAE,CAAA;AAEjB,MAAMC,eAAA,GAAkBA,CAAA;EAAA;EAAAH,cAAA,GAAAI,CAAA;EAC7B,MAAM,CAACC,QAAA,EAAUC,WAAA,CAAY;EAAA;EAAA,CAAAN,cAAA,GAAAE,CAAA,OAAG,IAAAK,MAAA,CAAAC,QAAQ,EAAY,EAAE;EACtD,MAAM,CAACC,OAAA,EAASC,UAAA,CAAW;EAAA;EAAA,CAAAV,cAAA,GAAAE,CAAA,OAAG,IAAAK,MAAA,CAAAC,QAAQ,EAAC;EACvC,MAAM,CAACG,MAAA,EAAQC,SAAA,CAAU;EAAA;EAAA,CAAAZ,cAAA,GAAAE,CAAA,OAAG,IAAAK,MAAA,CAAAC,QAAQ,EAAS;EAC7C,MAAM,CAACK,UAAA,EAAYC,aAAA,CAAc;EAAA;EAAA,CAAAd,cAAA,GAAAE,CAAA,QAAG,IAAAK,MAAA,CAAAC,QAAQ,EAAC;EAC7C,MAAM,CAACO,UAAA,EAAYC,aAAA,CAAc;EAAA;EAAA,CAAAhB,cAAA,GAAAE,CAAA,QAAG,IAAAK,MAAA,CAAAC,QAAQ,EAAC;IAC3CS,OAAA,EAAS;IACTC,QAAA,EAAU;IACVC,KAAA,EAAO;EACT;EACA,MAAM,CAACC,KAAA,EAAOC,QAAA,CAAS;EAAA;EAAA,CAAArB,cAAA,GAAAE,CAAA,QAAG,IAAAK,MAAA,CAAAC,QAAQ,EAAC;IACjCW,KAAA,EAAO;IACPG,IAAA,EAAM;IACNC,UAAA,EAAY;IACZC,QAAA,EAAU;EACZ;EAAA;EAAAxB,cAAA,GAAAE,CAAA;EAEA,IAAAK,MAAA,CAAAkB,SAAS,EAAC;IAAA;IAAAzB,cAAA,GAAAI,CAAA;IAAAJ,cAAA,GAAAE,CAAA;IACRwB,aAAA;IAAA;IAAA1B,cAAA,GAAAE,CAAA;IACAyB,UAAA;EACF,GAAG,CAACZ,UAAA,CAAWE,OAAO,EAAEF,UAAA,CAAWG,QAAQ,EAAEP,MAAA,EAAQE,UAAA,CAAW;EAAA;EAAAb,cAAA,GAAAE,CAAA;EAEhE,MAAMwB,aAAA,GAAgB,MAAAA,CAAA;IAAA;IAAA1B,cAAA,GAAAI,CAAA;IAAAJ,cAAA,GAAAE,CAAA;IACpBQ,UAAA,CAAW;IAAA;IAAAV,cAAA,GAAAE,CAAA;IACX,IAAI;MACF,MAAM0B,MAAA;MAAA;MAAA,CAAA5B,cAAA,GAAAE,CAAA,QAA6B;QACjC2B,IAAA,EAAMd,UAAA,CAAWE,OAAO;QACxBa,SAAA,EAAWf,UAAA,CAAWG;MACxB;MAAA;MAAAlB,cAAA,GAAAE,CAAA;MAEA,IAAIS,MAAA,EAAQ;QAAA;QAAAX,cAAA,GAAA+B,CAAA;QAAA/B,cAAA,GAAAE,CAAA;QACV8B,MAAA,CAAOC,MAAM,CAACL,MAAA,EAAQ;UAAEM,MAAA,EAAQvB;QAAwB;MAC1D;MAAA;MAAA;QAAAX,cAAA,GAAA+B,CAAA;MAAA;MAAA/B,cAAA,GAAAE,CAAA;MAEA,IAAIW,UAAA,EAAY;QAAA;QAAAb,cAAA,GAAA+B,CAAA;QAAA/B,cAAA,GAAAE,CAAA;QACd8B,MAAA,CAAOC,MAAM,CAACL,MAAA,EAAQ;UAAEO,OAAA,EAAStB;QAAW;MAC9C;MAAA;MAAA;QAAAb,cAAA,GAAA+B,CAAA;MAAA;MAEA,MAAMK,QAAA;MAAA;MAAA,CAAApC,cAAA,GAAAE,CAAA,QAAW,MAAMmC,eAAA,CAAAC,cAAc,CAACC,YAAY,CAACX,MAAA;MAAA;MAAA5B,cAAA,GAAAE,CAAA;MACnDI,WAAA,CAAY8B,QAAA,CAAS/B,QAAQ;MAAA;MAAAL,cAAA,GAAAE,CAAA;MAC7Bc,aAAA,CAAcwB,IAAA,IAAS;QAAA;QAAAxC,cAAA,GAAAI,CAAA;QAAAJ,cAAA,GAAAE,CAAA;QAAA;UAAE,GAAGsC,IAAI;UAAErB,KAAA,EAAOiB,QAAA,CAASjB;QAAM;MAAA;IAC1D,EAAE,MAAM;MAAA;MAAAnB,cAAA,GAAAE,CAAA;MACNuC,KAAA,CAAAC,OAAO,CAACC,KAAK,CAAC;IAChB,UAAU;MAAA;MAAA3C,cAAA,GAAAE,CAAA;MACRQ,UAAA,CAAW;IACb;EACF;EAAA;EAAAV,cAAA,GAAAE,CAAA;EAEA,MAAMyB,UAAA,GAAa,MAAAA,CAAA;IAAA;IAAA3B,cAAA,GAAAI,CAAA;IAAAJ,cAAA,GAAAE,CAAA;IACjB,IAAI;MAAA;MAAAF,cAAA,GAAAE,CAAA;MACF;MACA0C,OAAA,CAAQC,GAAG,CAAC;IACd,EAAE,MAAM;MAAA;MAAA7C,cAAA,GAAAE,CAAA;MACNuC,KAAA,CAAAC,OAAO,CAACC,KAAK,CAAC;IAChB;EACF;EAAA;EAAA3C,cAAA,GAAAE,CAAA;EAEA,MAAM4C,iBAAA,GAAoBA,CAACjB,IAAA,EAAcX,QAAA;IAAA;IAAAlB,cAAA,GAAAI,CAAA;IAAAJ,cAAA,GAAAE,CAAA;IACvCc,aAAA,CAAcwB,IAAA,IAAS;MAAA;MAAAxC,cAAA,GAAAI,CAAA;MAAAJ,cAAA,GAAAE,CAAA;MAAA;QACrB,GAAGsC,IAAI;QACPvB,OAAA,EAASY,IAAA;QACTX,QAAA;QAAU;QAAA,CAAAlB,cAAA,GAAA+B,CAAA,UAAAb,QAAA;QAAA;QAAA,CAAAlB,cAAA,GAAA+B,CAAA,UAAYS,IAAA,CAAKtB,QAAQ;MACrC;IAAA;EACF;EAAA;EAAAlB,cAAA,GAAAE,CAAA;EAEA,OAAO;IACLG,QAAA;IACAI,OAAA;IACAE,MAAA;IACAC,SAAA;IACAC,UAAA;IACAC,aAAA;IACAC,UAAA;IACA+B,iBAAA;IACA1B,KAAA;IACAM;EACF;AACF","ignoreList":[]}