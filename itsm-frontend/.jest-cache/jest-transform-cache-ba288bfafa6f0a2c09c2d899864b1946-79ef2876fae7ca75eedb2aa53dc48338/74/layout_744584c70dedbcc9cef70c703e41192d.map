{"version":3,"names":["MainLayout","Content","cov_27p8v9vd7o","s","_antd","Layout","children","f","collapsed","setCollapsed","_react","useState","mounted","setMounted","isMobile","setIsMobile","pathname","_navigation","usePathname","router","useRouter","useEffect","b","_authservice","AuthService","isAuthenticated","push","handleResize","mobile","window","innerWidth","addEventListener","removeEventListener","handleContentClick","_jsxruntime","jsx","ConfigProvider","locale","_zh_CN","default","jsxs","App","style","minHeight","background","paddingLeft","_layoutconfig","LAYOUT_CONFIG","sider","collapsedWidth","width","transition","_Sidebar","Sidebar","onCollapse","_Header","Header","showBreadcrumb","onClick","content","boxShadow","minWidth","maxWidth","overflowX","className","padding","paddingMobile","textAlign","color","fontSize","Date","getFullYear","position","top","left","right","bottom","backgroundColor","zIndex"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/app/(main)/layout.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { Layout, ConfigProvider, App } from 'antd';\nimport zhCN from 'antd/locale/zh_CN';\nimport { usePathname, useRouter } from 'next/navigation';\nimport { Header } from '@/components/layout/Header';\nimport { Sidebar } from '@/components/layout/Sidebar';\nimport { AuthService } from '@/lib/services/auth-service';\nimport { LAYOUT_CONFIG } from '@/config/layout.config';\n\nconst { Content } = Layout;\n\n/**\n * 主应用布局\n * 包含 Header、Sidebar 和 Content 区域\n * 需要用户认证才能访问\n */\nexport default function MainLayout({\n  children,\n}: Readonly<{\n  children: React.ReactNode;\n}>) {\n  const [collapsed, setCollapsed] = useState(false);\n  const [mounted, setMounted] = useState(false);\n  const [isMobile, setIsMobile] = useState(false);\n  const pathname = usePathname();\n  const router = useRouter();\n\n  // 处理客户端挂载\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  // 认证检查\n  useEffect(() => {\n    if (mounted && !AuthService.isAuthenticated()) {\n      router.push('/login');\n    }\n  }, [mounted, router]);\n\n  // 响应式布局：在移动端自动折叠侧边栏\n  useEffect(() => {\n    const handleResize = () => {\n      const mobile = window.innerWidth < 768;\n      setIsMobile(mobile);\n      if (mobile) {\n        setCollapsed(true);\n      }\n    };\n\n    handleResize();\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // 在移动端，点击内容区域时折叠侧边栏\n  const handleContentClick = () => {\n    if (isMobile && !collapsed) {\n      setCollapsed(true);\n    }\n  };\n\n  // 未挂载时显示 loading（避免服务端渲染问题）\n  if (!mounted) {\n    return null;\n  }\n\n  // 根据官方布局模式，使用单一容器控制侧边栏占位\n  return (\n    <ConfigProvider locale={zhCN}>\n      <App>\n        <Layout\n          style={{\n            minHeight: '100vh',\n            background: '#f5f7fb',\n            paddingLeft: isMobile\n              ? 0\n              : collapsed\n                ? LAYOUT_CONFIG.sider.collapsedWidth\n                : LAYOUT_CONFIG.sider.width,\n            transition: 'padding-left 0.2s ease',\n          }}\n        >\n          {/* 侧边栏 */}\n          <Sidebar collapsed={collapsed} onCollapse={setCollapsed} />\n\n          {/* 主区域 */}\n          <Layout style={{ background: '#f5f7fb', minHeight: '100vh' }}>\n            {/* 顶部导航栏 */}\n            <Header collapsed={collapsed} onCollapse={setCollapsed} showBreadcrumb={true} />\n\n            {/* 内容区域 */}\n            <Content\n              onClick={handleContentClick}\n              style={{\n                background: '#f5f7fb',\n                minHeight: LAYOUT_CONFIG.content.minHeight,\n                boxShadow: 'none',\n                width: 'auto',\n                minWidth: 0,\n                maxWidth: '100%',\n                overflowX: 'hidden',\n              }}\n            >\n              <div\n                className='main-content'\n                style={{\n                  padding: isMobile ? `${LAYOUT_CONFIG.content.paddingMobile}px` : '16px',\n                }}\n              >\n                {children}\n              </div>\n            </Content>\n\n            {/* 页脚（可选） */}\n            <footer\n              style={{\n                textAlign: 'center',\n                padding: '16px',\n                background: 'transparent',\n                color: '#9ca3af',\n                fontSize: '12px',\n              }}\n            >\n              ITSM Platform ©{new Date().getFullYear()} - IT服务管理平台\n            </footer>\n          </Layout>\n        </Layout>\n\n        {/* 移动端遮罩层 */}\n        {!collapsed && isMobile && (\n          <div\n            onClick={() => setCollapsed(true)}\n            style={{\n              position: 'fixed',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              backgroundColor: 'rgba(0, 0, 0, 0.45)',\n              zIndex: LAYOUT_CONFIG.zIndex.sider - 1,\n            }}\n          />\n        )}\n      </App>\n    </ConfigProvider>\n  );\n}\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAaA;;;;;AAKA;;;;;;WAAwBA,UAAA;;;;;;;;yEAhBmB;;;kCACC;;;wEAC3B;;;kCACsB;;;kCAChB;;;kCACC;;;mCACI;;;mCACE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAE9B,MAAM;EAAEC;AAAO,CAAE;AAAA;AAAA,CAAAC,cAAA,GAAAC,CAAA,QAAGC,KAAA,CAAAC,MAAM;AAOX,SAASL,WAAW;EACjCM;AAAQ,CAGR;EAAA;EAAAJ,cAAA,GAAAK,CAAA;EACA,MAAM,CAACC,SAAA,EAAWC,YAAA,CAAa;EAAA;EAAA,CAAAP,cAAA,GAAAC,CAAA,QAAG,IAAAO,MAAA,CAAAC,QAAQ,EAAC;EAC3C,MAAM,CAACC,OAAA,EAASC,UAAA,CAAW;EAAA;EAAA,CAAAX,cAAA,GAAAC,CAAA,QAAG,IAAAO,MAAA,CAAAC,QAAQ,EAAC;EACvC,MAAM,CAACG,QAAA,EAAUC,WAAA,CAAY;EAAA;EAAA,CAAAb,cAAA,GAAAC,CAAA,QAAG,IAAAO,MAAA,CAAAC,QAAQ,EAAC;EACzC,MAAMK,QAAA;EAAA;EAAA,CAAAd,cAAA,GAAAC,CAAA,QAAW,IAAAc,WAAA,CAAAC,WAAW;EAC5B,MAAMC,MAAA;EAAA;EAAA,CAAAjB,cAAA,GAAAC,CAAA,QAAS,IAAAc,WAAA,CAAAG,SAAS;EAExB;EAAA;EAAAlB,cAAA,GAAAC,CAAA;EACA,IAAAO,MAAA,CAAAW,SAAS,EAAC;IAAA;IAAAnB,cAAA,GAAAK,CAAA;IAAAL,cAAA,GAAAC,CAAA;IACRU,UAAA,CAAW;EACb,GAAG,EAAE;EAEL;EAAA;EAAAX,cAAA,GAAAC,CAAA;EACA,IAAAO,MAAA,CAAAW,SAAS,EAAC;IAAA;IAAAnB,cAAA,GAAAK,CAAA;IAAAL,cAAA,GAAAC,CAAA;IACR;IAAI;IAAA,CAAAD,cAAA,GAAAoB,CAAA,WAAAV,OAAA;IAAA;IAAA,CAAAV,cAAA,GAAAoB,CAAA,WAAW,CAACC,YAAA,CAAAC,WAAW,CAACC,eAAe,KAAI;MAAA;MAAAvB,cAAA,GAAAoB,CAAA;MAAApB,cAAA,GAAAC,CAAA;MAC7CgB,MAAA,CAAOO,IAAI,CAAC;IACd;IAAA;IAAA;MAAAxB,cAAA,GAAAoB,CAAA;IAAA;EACF,GAAG,CAACV,OAAA,EAASO,MAAA,CAAO;EAEpB;EAAA;EAAAjB,cAAA,GAAAC,CAAA;EACA,IAAAO,MAAA,CAAAW,SAAS,EAAC;IAAA;IAAAnB,cAAA,GAAAK,CAAA;IAAAL,cAAA,GAAAC,CAAA;IACR,MAAMwB,YAAA,GAAeA,CAAA;MAAA;MAAAzB,cAAA,GAAAK,CAAA;MACnB,MAAMqB,MAAA;MAAA;MAAA,CAAA1B,cAAA,GAAAC,CAAA,QAAS0B,MAAA,CAAOC,UAAU,GAAG;MAAA;MAAA5B,cAAA,GAAAC,CAAA;MACnCY,WAAA,CAAYa,MAAA;MAAA;MAAA1B,cAAA,GAAAC,CAAA;MACZ,IAAIyB,MAAA,EAAQ;QAAA;QAAA1B,cAAA,GAAAoB,CAAA;QAAApB,cAAA,GAAAC,CAAA;QACVM,YAAA,CAAa;MACf;MAAA;MAAA;QAAAP,cAAA,GAAAoB,CAAA;MAAA;IACF;IAAA;IAAApB,cAAA,GAAAC,CAAA;IAEAwB,YAAA;IAAA;IAAAzB,cAAA,GAAAC,CAAA;IACA0B,MAAA,CAAOE,gBAAgB,CAAC,UAAUJ,YAAA;IAAA;IAAAzB,cAAA,GAAAC,CAAA;IAClC,OAAO,MAAM;MAAA;MAAAD,cAAA,GAAAK,CAAA;MAAAL,cAAA,GAAAC,CAAA;MAAA,OAAA0B,MAAA,CAAOG,mBAAmB,CAAC,UAAUL,YAAA;IAAA;EACpD,GAAG,EAAE;EAEL;EAAA;EAAAzB,cAAA,GAAAC,CAAA;EACA,MAAM8B,kBAAA,GAAqBA,CAAA;IAAA;IAAA/B,cAAA,GAAAK,CAAA;IAAAL,cAAA,GAAAC,CAAA;IACzB;IAAI;IAAA,CAAAD,cAAA,GAAAoB,CAAA,WAAAR,QAAA;IAAA;IAAA,CAAAZ,cAAA,GAAAoB,CAAA,WAAY,CAACd,SAAA,GAAW;MAAA;MAAAN,cAAA,GAAAoB,CAAA;MAAApB,cAAA,GAAAC,CAAA;MAC1BM,YAAA,CAAa;IACf;IAAA;IAAA;MAAAP,cAAA,GAAAoB,CAAA;IAAA;EACF;EAEA;EAAA;EAAApB,cAAA,GAAAC,CAAA;EACA,IAAI,CAACS,OAAA,EAAS;IAAA;IAAAV,cAAA,GAAAoB,CAAA;IAAApB,cAAA,GAAAC,CAAA;IACZ,OAAO;EACT;EAAA;EAAA;IAAAD,cAAA,GAAAoB,CAAA;EAAA;EAEA;EAAApB,cAAA,GAAAC,CAAA;EACA,oBACE,IAAA+B,WAAA,CAAAC,GAAA,EAAC/B,KAAA,CAAAgC,cAAc;IAACC,MAAA,EAAQC,MAAA,CAAAC,OAAI;cAC1B,iBAAAL,WAAA,CAAAM,IAAA,EAACpC,KAAA,CAAAqC,GAAG;8BACF,IAAAP,WAAA,CAAAM,IAAA,EAACpC,KAAA,CAAAC,MAAM;QACLqC,KAAA,EAAO;UACLC,SAAA,EAAW;UACXC,UAAA,EAAY;UACZC,WAAA,EAAa/B,QAAA;UAAA;UAAA,CAAAZ,cAAA,GAAAoB,CAAA,WACT;UAAA;UAAA,CAAApB,cAAA,GAAAoB,CAAA,WACAd,SAAA;UAAA;UAAA,CAAAN,cAAA,GAAAoB,CAAA,WACEwB,aAAA,CAAAC,aAAa,CAACC,KAAK,CAACC,cAAc;UAAA;UAAA,CAAA/C,cAAA,GAAAoB,CAAA,WAClCwB,aAAA,CAAAC,aAAa,CAACC,KAAK,CAACE,KAAK;UAC/BC,UAAA,EAAY;QACd;gCAGA,IAAAjB,WAAA,CAAAC,GAAA,EAACiB,QAAA,CAAAC,OAAO;UAAC7C,SAAA,EAAWA,SAAA;UAAW8C,UAAA,EAAY7C;yBAG3C,IAAAyB,WAAA,CAAAM,IAAA,EAACpC,KAAA,CAAAC,MAAM;UAACqC,KAAA,EAAO;YAAEE,UAAA,EAAY;YAAWD,SAAA,EAAW;UAAQ;kCAEzD,IAAAT,WAAA,CAAAC,GAAA,EAACoB,OAAA,CAAAC,MAAM;YAAChD,SAAA,EAAWA,SAAA;YAAW8C,UAAA,EAAY7C,YAAA;YAAcgD,cAAA,EAAgB;2BAGxE,IAAAvB,WAAA,CAAAC,GAAA,EAAClC,OAAA;YACCyD,OAAA,EAASzB,kBAAA;YACTS,KAAA,EAAO;cACLE,UAAA,EAAY;cACZD,SAAA,EAAWG,aAAA,CAAAC,aAAa,CAACY,OAAO,CAAChB,SAAS;cAC1CiB,SAAA,EAAW;cACXV,KAAA,EAAO;cACPW,QAAA,EAAU;cACVC,QAAA,EAAU;cACVC,SAAA,EAAW;YACb;sBAEA,iBAAA7B,WAAA,CAAAC,GAAA,EAAC;cACC6B,SAAA,EAAU;cACVtB,KAAA,EAAO;gBACLuB,OAAA,EAASnD,QAAA;gBAAA;gBAAA,CAAAZ,cAAA,GAAAoB,CAAA,WAAW,GAAGwB,aAAA,CAAAC,aAAa,CAACY,OAAO,CAACO,aAAa,IAAI;gBAAA;gBAAA,CAAAhE,cAAA,GAAAoB,CAAA,WAAG;cACnE;wBAEChB;;2BAKL,IAAA4B,WAAA,CAAAM,IAAA,EAAC;YACCE,KAAA,EAAO;cACLyB,SAAA,EAAW;cACXF,OAAA,EAAS;cACTrB,UAAA,EAAY;cACZwB,KAAA,EAAO;cACPC,QAAA,EAAU;YACZ;uBACD,sBACiB,IAAIC,IAAA,GAAOC,WAAW,IAAG;;;;MAM9C;MAAA,CAAArE,cAAA,GAAAoB,CAAA,YAACd,SAAA;MAAA;MAAA,CAAAN,cAAA,GAAAoB,CAAA,WAAaR,QAAA;MAAA;MAAA,CAAAZ,cAAA,GAAAoB,CAAA,wBACb,IAAAY,WAAA,CAAAC,GAAA,EAAC;QACCuB,OAAA,EAASA,CAAA,KAAM;UAAA;UAAAxD,cAAA,GAAAK,CAAA;UAAAL,cAAA,GAAAC,CAAA;UAAA,OAAAM,YAAA,CAAa;QAAA;QAC5BiC,KAAA,EAAO;UACL8B,QAAA,EAAU;UACVC,GAAA,EAAK;UACLC,IAAA,EAAM;UACNC,KAAA,EAAO;UACPC,MAAA,EAAQ;UACRC,eAAA,EAAiB;UACjBC,MAAA,EAAQhC,aAAA,CAAAC,aAAa,CAAC+B,MAAM,CAAC9B,KAAK,GAAG;QACvC;;;;AAMZ","ignoreList":[]}