{"version":3,"names":["cov_2d7wz4na27","actualCoverage","s","userPreferences","defaultPreferences","theme","language","timezone","dateFormat","pageSize","sidebarCollapsed","dashboardLayout","notifications","email","browser","mobile","types","tableSettings","UserPreferencesManager","constructor","f","listeners","preferences","loadPreferences","window","b","saved","localStorage","getItem","JSON","parse","savePreferences","setItem","stringify","notifyListeners","get","update","updates","updateTableSettings","tableId","settings","subscribe","listener","push","filter","l","forEach","reset"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/app/lib/user-preferences.ts"],"sourcesContent":["interface UserPreferences {\n  theme: 'light' | 'dark' | 'auto';\n  language: 'zh-CN' | 'en-US';\n  timezone: string;\n  dateFormat: string;\n  pageSize: number;\n  sidebarCollapsed: boolean;\n  dashboardLayout: string[];\n  notifications: {\n    email: boolean;\n    browser: boolean;\n    mobile: boolean;\n    types: string[];\n  };\n  tableSettings: Record<string, {\n    columns: string[];\n    sortBy?: string;\n    sortOrder?: 'asc' | 'desc';\n  }>;\n}\n\nconst defaultPreferences: UserPreferences = {\n  theme: 'light',\n  language: 'zh-CN',\n  timezone: 'Asia/Shanghai',\n  dateFormat: 'YYYY-MM-DD HH:mm:ss',\n  pageSize: 20,\n  sidebarCollapsed: false,\n  dashboardLayout: ['kpi', 'charts', 'recent-tickets'],\n  notifications: {\n    email: true,\n    browser: true,\n    mobile: false,\n    types: ['ticket', 'approval', 'alert']\n  },\n  tableSettings: {}\n};\n\nclass UserPreferencesManager {\n  private preferences: UserPreferences;\n  private listeners: ((preferences: UserPreferences) => void)[] = [];\n\n  constructor() {\n    this.preferences = this.loadPreferences();\n  }\n\n  private loadPreferences(): UserPreferences {\n    if (typeof window === 'undefined') return defaultPreferences;\n    \n    try {\n      const saved = localStorage.getItem('user_preferences');\n      return saved ? { ...defaultPreferences, ...JSON.parse(saved) } : defaultPreferences;\n    } catch {\n      return defaultPreferences;\n    }\n  }\n\n  private savePreferences() {\n    if (typeof window === 'undefined') return;\n    localStorage.setItem('user_preferences', JSON.stringify(this.preferences));\n    this.notifyListeners();\n  }\n\n  get(): UserPreferences {\n    return { ...this.preferences };\n  }\n\n  update(updates: Partial<UserPreferences>) {\n    this.preferences = { ...this.preferences, ...updates };\n    this.savePreferences();\n  }\n\n  updateTableSettings(tableId: string, settings: UserPreferences['tableSettings'][string]) {\n    this.preferences.tableSettings[tableId] = settings;\n    this.savePreferences();\n  }\n\n  subscribe(listener: (preferences: UserPreferences) => void) {\n    this.listeners.push(listener);\n    return () => {\n      this.listeners = this.listeners.filter(l => l !== listener);\n    };\n  }\n\n  private notifyListeners() {\n    this.listeners.forEach(listener => listener(this.preferences));\n  }\n\n  reset() {\n    this.preferences = { ...defaultPreferences };\n    this.savePreferences();\n  }\n}\n\nexport const userPreferences = new UserPreferencesManager();"],"mappings":"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","ignoreList":[]}