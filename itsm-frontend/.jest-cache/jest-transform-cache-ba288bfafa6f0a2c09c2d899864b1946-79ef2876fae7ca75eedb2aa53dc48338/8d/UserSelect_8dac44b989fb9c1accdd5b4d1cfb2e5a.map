{"version":3,"names":["UserSelect","Option","cov_rseyx7ibt","s","_antd","Select","value","onChange","mode","b","placeholder","style","disabled","allowClear","f","users","setUsers","_react","useState","loading","setLoading","searchValue","setSearchValue","fetchUsers","search","response","_userapi","UserApi","getUsers","page","page_size","error","console","useEffect","handleSearch","filteredUsers","useMemo","lowerSearch","toLowerCase","filter","user","name","includes","username","email","_jsxruntime","jsx","showSearch","filterOption","onSearch","notFoundContent","Spin","size","optionLabelProp","map","id","label","jsxs","className","Avatar","icon","_lucidereact","User"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/components/common/UserSelect.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { Select, Avatar, Spin } from 'antd';\nimport { UserApi } from '@/lib/api/user-api';\nimport type { User } from '@/lib/api/user-api';\nimport { User as UserIcon } from 'lucide-react';\n\nconst { Option } = Select;\n\ninterface UserSelectProps {\n  value?: number[];\n  onChange?: (userIds: number[]) => void;\n  mode?: 'multiple' | 'tags';\n  placeholder?: string;\n  style?: React.CSSProperties;\n  disabled?: boolean;\n  allowClear?: boolean;\n}\n\nexport const UserSelect: React.FC<UserSelectProps> = ({\n  value,\n  onChange,\n  mode = 'multiple',\n  placeholder = '选择用户',\n  style,\n  disabled = false,\n  allowClear = true,\n}) => {\n  const [users, setUsers] = useState<User[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [searchValue, setSearchValue] = useState('');\n\n  // 获取用户列表\n  const fetchUsers = async (search?: string) => {\n    try {\n      setLoading(true);\n      const response = await UserApi.getUsers({\n        page: 1,\n        page_size: 100,\n        search: search || '',\n      });\n      setUsers(response.users || []);\n    } catch (error) {\n      console.error('Failed to fetch users:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchUsers();\n  }, []);\n\n  // 搜索用户\n  const handleSearch = (value: string) => {\n    setSearchValue(value);\n    if (value) {\n      fetchUsers(value);\n    } else {\n      fetchUsers();\n    }\n  };\n\n  // 过滤用户\n  const filteredUsers = useMemo(() => {\n    if (!searchValue) return users;\n    const lowerSearch = searchValue.toLowerCase();\n    return users.filter(\n      user =>\n        user.name?.toLowerCase().includes(lowerSearch) ||\n        user.username?.toLowerCase().includes(lowerSearch) ||\n        user.email?.toLowerCase().includes(lowerSearch)\n    );\n  }, [users, searchValue]);\n\n  return (\n    <Select\n      mode={mode}\n      value={value}\n      onChange={onChange}\n      placeholder={placeholder}\n      style={style}\n      disabled={disabled}\n      allowClear={allowClear}\n      showSearch\n      filterOption={false}\n      onSearch={handleSearch}\n      notFoundContent={loading ? <Spin size=\"small\" /> : '未找到用户'}\n      optionLabelProp=\"label\"\n    >\n      {filteredUsers.map(user => (\n        <Option key={user.id} value={user.id} label={user.name || user.username}>\n          <div className=\"flex items-center space-x-2\">\n            <Avatar size=\"small\" icon={<UserIcon size={14} />}>\n              {user.name?.[0] || user.username?.[0]}\n            </Avatar>\n            <div className=\"flex flex-col\">\n              <span className=\"text-sm font-medium\">{user.name || user.username}</span>\n              {user.email && (\n                <span className=\"text-xs text-gray-500\">{user.email}</span>\n              )}\n            </div>\n          </div>\n        </Option>\n      ))}\n    </Select>\n  );\n};\n\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}