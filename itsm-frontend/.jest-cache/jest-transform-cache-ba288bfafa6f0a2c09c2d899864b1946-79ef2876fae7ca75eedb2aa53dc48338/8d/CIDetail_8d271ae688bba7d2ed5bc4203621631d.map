{"version":3,"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/modules/cmdb/components/CIDetail.tsx"],"sourcesContent":["'use client';\n\n/**\n * 配置项 (CI) 详情组件\n */\n\nimport React, { useState, useEffect } from 'react';\nimport {\n    Card, Descriptions, Tag, Button,\n    Skeleton, Result, Divider, List, Typography,\n    Tabs, Space, Breadcrumb, Empty, message\n} from 'antd';\nimport { ArrowLeftOutlined, ClusterOutlined, HistoryOutlined } from '@ant-design/icons';\nimport { useParams, useRouter } from 'next/navigation';\nimport dayjs from 'dayjs';\n\nimport { CMDBApi } from '../api';\nimport { CIStatus, CIStatusLabels } from '../constants';\nimport type { ConfigurationItem, CIType } from '../types';\n\nconst { Title, Text } = Typography;\nconst { TabPane } = Tabs;\n\nconst statusColors: Record<string, string> = {\n    [CIStatus.ACTIVE]: 'green',\n    [CIStatus.INACTIVE]: 'default',\n    [CIStatus.MAINTENANCE]: 'orange',\n    [CIStatus.DECOMMISSIONED]: 'red',\n};\n\nconst CIDetail: React.FC = () => {\n    const { id } = useParams() as { id: string };\n    const router = useRouter();\n    const [loading, setLoading] = useState(true);\n    const [ci, setCi] = useState<ConfigurationItem | null>(null);\n    const [types, setTypes] = useState<CIType[]>([]);\n\n    useEffect(() => {\n        if (id) {\n            loadDetail();\n        }\n    }, [id]);\n\n    const loadDetail = async () => {\n        setLoading(true);\n        try {\n            const [ciData, typeData] = await Promise.all([\n                CMDBApi.getCI(id!),\n                CMDBApi.getTypes()\n            ]);\n            setCi(ciData);\n            setTypes(typeData || []);\n        } catch (error) {\n            console.error(error);\n            message.error('加载资产详情失败');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    if (loading) return <Card><Skeleton active /></Card>;\n\n    if (!ci) {\n        return (\n            <Card>\n                <Result\n                    status=\"404\"\n                    title=\"404\"\n                    subTitle=\"抱歉，您访问的配置项不存在\"\n                    extra={<Button type=\"primary\" onClick={() => router.push('/cmdb')}>返回列表</Button>}\n                />\n            </Card>\n        );\n    }\n\n    const typeInfo = types.find(t => t.id === ci.ci_type_id);\n\n    return (\n        <div style={{ padding: '0 0 24px' }}>\n            <Breadcrumb\n                style={{ marginBottom: 16 }}\n                items={[\n                    { title: '首页' },\n                    { title: '配置管理' },\n                    { title: <a onClick={() => router.push('/cmdb')}>配置项列表</a> },\n                    { title: '资产详情' },\n                ]}\n            />\n\n            <Card>\n                <div style={{ marginBottom: 24 }}>\n                    <Button\n                        icon={<ArrowLeftOutlined />}\n                        onClick={() => router.push('/cmdb')}\n                        style={{ marginBottom: 16 }}\n                    >\n                        返回列表\n                    </Button>\n                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>\n                        <Space direction=\"vertical\" size={0}>\n                            <Title level={3} style={{ margin: 0 }}>{ci.name}</Title>\n                            <Text type=\"secondary\">配置项 ID: {ci.id}</Text>\n                        </Space>\n                        <Tag color={statusColors[ci.status]} style={{ padding: '4px 12px', fontSize: 14 }}>\n                            {CIStatusLabels[ci.status] || ci.status}\n                        </Tag>\n                    </div>\n                </div>\n\n                <Tabs defaultActiveKey=\"1\">\n                    <TabPane tab=\"基础信息\" key=\"1\">\n                        <Descriptions bordered column={2}>\n                            <Descriptions.Item label=\"资产分类\">{typeInfo?.name || `类型 ${ci.ci_type_id}`}</Descriptions.Item>\n                            <Descriptions.Item label=\"资产标签\">{ci.asset_tag || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"序列号\">{ci.serial_number || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"型号\">{ci.model || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"厂商\">{ci.vendor || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"所在位置\">{ci.location || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"环境\">{ci.environment || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"重要性\">{ci.criticality || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"分配给\">{ci.assigned_to || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"拥有者\">{ci.owned_by || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"发现源\">{ci.discovery_source || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"数据来源\">{ci.source || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"云厂商\">{ci.cloud_provider || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"云账号\">{ci.cloud_account_id || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"Region\">{ci.cloud_region || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"Zone\">{ci.cloud_zone || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"云资源ID\">{ci.cloud_resource_id || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"云资源类型\">{ci.cloud_resource_type || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"同步状态\">{ci.cloud_sync_status || '-'}</Descriptions.Item>\n                            <Descriptions.Item label=\"同步时间\">\n                                {ci.cloud_sync_time ? dayjs(ci.cloud_sync_time).format('YYYY-MM-DD HH:mm:ss') : '-'}\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"所属租户\">{ci.tenant_id}</Descriptions.Item>\n                            <Descriptions.Item label=\"创建时间\">{dayjs(ci.created_at).format('YYYY-MM-DD HH:mm:ss')}</Descriptions.Item>\n                            <Descriptions.Item label=\"最后更新\">{dayjs(ci.updated_at).format('YYYY-MM-DD HH:mm:ss')}</Descriptions.Item>\n                            <Descriptions.Item label=\"描述\" span={2}>{ci.description || '无'}</Descriptions.Item>\n                        </Descriptions>\n                    </TabPane>\n\n                    <TabPane tab={<span><ClusterOutlined /> 拓扑关系</span>} key=\"2\">\n                        <Empty description=\"暂无关联资产信息\" style={{ margin: '40px 0' }} />\n                    </TabPane>\n\n                    <TabPane tab={<span><HistoryOutlined /> 变更历史</span>} key=\"3\">\n                        <Empty description=\"暂无历史审计记录\" style={{ margin: '40px 0' }} />\n                    </TabPane>\n                </Tabs>\n            </Card>\n        </div>\n    );\n};\n\nexport default CIDetail;\n"],"names":["Title","Text","Typography","TabPane","Tabs","statusColors","CIStatus","ACTIVE","INACTIVE","MAINTENANCE","DECOMMISSIONED","CIDetail","id","useParams","router","useRouter","loading","setLoading","useState","ci","setCi","types","setTypes","useEffect","loadDetail","ciData","typeData","Promise","all","CMDBApi","getCI","getTypes","error","console","message","Card","Skeleton","active","Result","status","title","subTitle","extra","Button","type","onClick","push","typeInfo","find","t","ci_type_id","div","style","padding","Breadcrumb","marginBottom","items","a","icon","ArrowLeftOutlined","display","justifyContent","alignItems","Space","direction","size","level","margin","name","Tag","color","fontSize","CIStatusLabels","defaultActiveKey","tab","Descriptions","bordered","column","Item","label","asset_tag","serial_number","model","vendor","location","environment","criticality","assigned_to","owned_by","discovery_source","source","cloud_provider","cloud_account_id","cloud_region","cloud_zone","cloud_resource_id","cloud_resource_type","cloud_sync_status","cloud_sync_time","dayjs","format","tenant_id","created_at","updated_at","span","description","ClusterOutlined","Empty","HistoryOutlined"],"mappings":"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"}