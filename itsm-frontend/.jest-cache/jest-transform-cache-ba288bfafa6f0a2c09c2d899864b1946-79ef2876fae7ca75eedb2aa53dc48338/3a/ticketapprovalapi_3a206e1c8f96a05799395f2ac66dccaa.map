{"version":3,"names":["cov_2f473hjjeg","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","s","f","b","inputSourceMap","version","sources","sourcesContent","names","mappings","_coverageSchema","coverage","actualCoverage","TicketApprovalApi","getWorkflows","params","_httpclient","httpClient","get","createWorkflow","data","post","updateWorkflow","id","put","deleteWorkflow","delete","getApprovalRecords","submitApproval"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/lib/api/ticket-approval-api.ts"],"sourcesContent":["/**\n * 工单审批流程 API 服务\n */\n\nimport { httpClient } from './http-client';\n\nexport interface ApprovalWorkflow {\n  id: number;\n  name: string;\n  description: string;\n  ticket_type?: string;\n  priority?: string;\n  nodes: ApprovalNode[];\n  is_active: boolean;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface ApprovalNode {\n  id: string;\n  level: number;\n  name: string;\n  approver_type: 'user' | 'role' | 'department' | 'dynamic';\n  approver_ids: number[];\n  approver_names: string[];\n  approval_mode: 'sequential' | 'parallel' | 'any' | 'all';\n  minimum_approvals?: number;\n  timeout_hours?: number;\n  conditions?: Array<{\n    field: string;\n    operator: 'equals' | 'not_equals' | 'greater_than' | 'less_than' | 'contains';\n    value: any;\n  }>;\n  allow_reject: boolean;\n  allow_delegate: boolean;\n  reject_action: 'end' | 'return' | 'custom';\n  return_to_level?: number;\n}\n\nexport interface ApprovalRecord {\n  id: number;\n  ticket_id: number;\n  ticket_number: string;\n  ticket_title: string;\n  workflow_id: number;\n  workflow_name: string;\n  current_level: number;\n  total_levels: number;\n  approver_id: number;\n  approver_name: string;\n  status: 'pending' | 'approved' | 'rejected' | 'delegated' | 'timeout';\n  action?: string;\n  comment?: string;\n  created_at: string;\n  processed_at?: string;\n}\n\nexport class TicketApprovalApi {\n  // 获取审批工作流列表\n  static async getWorkflows(params?: {\n    ticket_type?: string;\n    priority?: string;\n    is_active?: boolean;\n    page?: number;\n    page_size?: number;\n  }): Promise<{\n    items: ApprovalWorkflow[];\n    total: number;\n    page: number;\n    page_size: number;\n  }> {\n    return httpClient.get('/api/tickets/approval/workflows', params);\n  }\n\n  // 创建审批工作流\n  static async createWorkflow(data: Partial<ApprovalWorkflow>): Promise<ApprovalWorkflow> {\n    return httpClient.post<ApprovalWorkflow>('/api/tickets/approval/workflows', data);\n  }\n\n  // 更新审批工作流\n  static async updateWorkflow(id: number, data: Partial<ApprovalWorkflow>): Promise<ApprovalWorkflow> {\n    return httpClient.put<ApprovalWorkflow>(`/api/tickets/approval/workflows/${id}`, data);\n  }\n\n  // 删除审批工作流\n  static async deleteWorkflow(id: number): Promise<void> {\n    return httpClient.delete(`/api/tickets/approval/workflows/${id}`);\n  }\n\n  // 获取审批记录\n  static async getApprovalRecords(params?: {\n    ticket_id?: number;\n    workflow_id?: number;\n    status?: string;\n    page?: number;\n    page_size?: number;\n  }): Promise<{\n    items: ApprovalRecord[];\n    total: number;\n    page: number;\n    page_size: number;\n  }> {\n    return httpClient.get('/api/tickets/approval/records', params);\n  }\n\n  // 提交审批\n  static async submitApproval(data: {\n    ticket_id: number;\n    approval_id: number;\n    action: 'approve' | 'reject' | 'delegate';\n    comment: string;\n    delegate_to_user_id?: number;\n  }): Promise<void> {\n    return httpClient.post('/api/tickets/approval/submit', data);\n  }\n}\n\n"],"mappings":"AAAA;;GAEC;;AAAA;AAAA,SAAAA,eAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,MAAA,OAAAC,QAAA;EAAA,IAAAC,GAAA;EAAA,IAAAC,YAAA;IAAAL,IAAA;IAAAM,YAAA;MAAA;QAAAC,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;IAAA;IAAAE,KAAA;MAAA;QAAAC,IAAA;QAAAC,IAAA;UAAAN,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAK,GAAA;UAAAP,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAD,IAAA;MAAA;MAAA;QAAAI,IAAA;QAAAC,IAAA;UAAAN,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAK,GAAA;UAAAP,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAD,IAAA;MAAA;MAAA;QAAAI,IAAA;QAAAC,IAAA;UAAAN,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAK,GAAA;UAAAP,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAD,IAAA;MAAA;MAAA;QAAAI,IAAA;QAAAC,IAAA;UAAAN,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAK,GAAA;UAAAP,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAD,IAAA;MAAA;MAAA;QAAAI,IAAA;QAAAC,IAAA;UAAAN,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAK,GAAA;UAAAP,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAD,IAAA;MAAA;MAAA;QAAAI,IAAA;QAAAC,IAAA;UAAAN,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAK,GAAA;UAAAP,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAD,IAAA;MAAA;MAAA;QAAAI,IAAA;QAAAC,IAAA;UAAAN,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAK,GAAA;UAAAP,KAAA;YAAAC,IAAA;YAAAC,MAAA;UAAA;UAAAC,GAAA;YAAAF,IAAA;YAAAC,MAAA;UAAA;QAAA;QAAAD,IAAA;MAAA;IAAA;IAAAO,SAAA;IAAAC,CAAA;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;IAAA;IAAAC,CAAA;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;IAAA;IAAAC,CAAA;IAAAC,cAAA;MAAAC,OAAA;MAAAC,OAAA;MAAAC,cAAA;MAAAC,KAAA;MAAAC,QAAA;IAAA;IAAAC,eAAA;IAAAxB,IAAA;EAAA;EAAA,IAAAyB,QAAA,GAAAxB,MAAA,CAAAE,GAAA,MAAAF,MAAA,CAAAE,GAAA;EAAA,KAAAsB,QAAA,CAAA1B,IAAA,KAAA0B,QAAA,CAAA1B,IAAA,EAAAC,IAAA,KAAAA,IAAA;IAAAyB,QAAA,CAAA1B,IAAA,IAAAK,YAAA;EAAA;EAAA,IAAAsB,cAAA,GAAAD,QAAA,CAAA1B,IAAA;EAAA;IAyDC;IAAAD,cAAA,YAAAA,CAAA;MAAA,OAAA4B,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAA5B,cAAA;AAAAA,cAAA,GAAAiB,CAAA;;;;;;+BAFW;;;;;;WAAAY,iBAAA;;;;;kCArDc;AAqDpB,MAAMA,iBAAA;EACX;EACA,aAAaC,aAAaC,MAMzB,EAKE;IAAA;IAAA/B,cAAA,GAAAkB,CAAA;IAAAlB,cAAA,GAAAiB,CAAA;IACD,OAAOe,WAAA,CAAAC,UAAU,CAACC,GAAG,CAAC,mCAAmCH,MAAA;EAC3D;EAEA;EACA,aAAaI,eAAeC,IAA+B,EAA6B;IAAA;IAAApC,cAAA,GAAAkB,CAAA;IAAAlB,cAAA,GAAAiB,CAAA;IACtF,OAAOe,WAAA,CAAAC,UAAU,CAACI,IAAI,CAAmB,mCAAmCD,IAAA;EAC9E;EAEA;EACA,aAAaE,eAAeC,EAAU,EAAEH,IAA+B,EAA6B;IAAA;IAAApC,cAAA,GAAAkB,CAAA;IAAAlB,cAAA,GAAAiB,CAAA;IAClG,OAAOe,WAAA,CAAAC,UAAU,CAACO,GAAG,CAAmB,mCAAmCD,EAAA,EAAI,EAAEH,IAAA;EACnF;EAEA;EACA,aAAaK,eAAeF,EAAU,EAAiB;IAAA;IAAAvC,cAAA,GAAAkB,CAAA;IAAAlB,cAAA,GAAAiB,CAAA;IACrD,OAAOe,WAAA,CAAAC,UAAU,CAACS,MAAM,CAAC,mCAAmCH,EAAA,EAAI;EAClE;EAEA;EACA,aAAaI,mBAAmBZ,MAM/B,EAKE;IAAA;IAAA/B,cAAA,GAAAkB,CAAA;IAAAlB,cAAA,GAAAiB,CAAA;IACD,OAAOe,WAAA,CAAAC,UAAU,CAACC,GAAG,CAAC,iCAAiCH,MAAA;EACzD;EAEA;EACA,aAAaa,eAAeR,IAM3B,EAAiB;IAAA;IAAApC,cAAA,GAAAkB,CAAA;IAAAlB,cAAA,GAAAiB,CAAA;IAChB,OAAOe,WAAA,CAAAC,UAAU,CAACI,IAAI,CAAC,gCAAgCD,IAAA;EACzD;AACF","ignoreList":[]}