{"version":3,"names":["cov_12k13s5yig","actualCoverage","s","AuthGuard","f","PermissionGuard","RoleGuard","withRouteGuard","children","requireAuth","b","requiredPermissions","requiredRole","fallback","redirectTo","router","_navigation","useRouter","isAuthenticated","user","isLoading","hasPermission","hasRole","_authstore","useAuthStore","isInitializing","setIsInitializing","_react","useState","useEffect","initializeAuth","token","_tokenstorage","getAccessToken","userInfo","window","localStorage","getItem","JSON","parse","login","getState","id","name","code","type","status","created_at","Date","toISOString","updated_at","e","console","error","push","_jsxruntime","jsx","className","_LoadingSpinner","LoadingSpinner","size","Fragment","jsxs","onClick","preventDefault","setTimeout","back","length","hasAllPermissions","every","permission","permissions","role","requireAll","checkPermissions","some","roles","checkRoles","Component","options","WrappedComponent","props","displayName"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/components/auth/AuthGuard.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuthStore } from '@/lib/store/auth-store';\nimport { LoadingSpinner } from '@/components/ui/LoadingSpinner';\nimport { getAccessToken } from '@/lib/auth/token-storage';\n\ninterface AuthGuardProps {\n  children: React.ReactNode;\n  requireAuth?: boolean;\n  requiredPermissions?: string[];\n  requiredRole?: string;\n  fallback?: React.ReactNode;\n  redirectTo?: string;\n}\n\n/**\n * 认证守卫组件\n * 用于保护需要认证的页面和组件\n */\nexport const AuthGuard: React.FC<AuthGuardProps> = ({\n  children,\n  requireAuth = true,\n  requiredPermissions = [],\n  requiredRole,\n  fallback,\n  redirectTo = '/login',\n}) => {\n  const router = useRouter();\n  const { isAuthenticated, user, isLoading, hasPermission, hasRole } = useAuthStore();\n  const [isInitializing, setIsInitializing] = useState(true);\n\n  useEffect(() => {\n    const initializeAuth = async () => {\n      try {\n        // 检查localStorage中是否有认证信息\n        const token = getAccessToken();\n\n        if (token) {\n          // 如果有token，尝试恢复状态\n          const userInfo = typeof window !== 'undefined' ? localStorage.getItem('user_info') : null;\n          if (userInfo) {\n            try {\n              const user = JSON.parse(userInfo);\n              // 更新store状态\n              const { login } = useAuthStore.getState();\n              login(user, token, {\n                id: 1,\n                name: '默认租户',\n                code: 'default',\n                type: 'trial',\n                status: 'active',\n                created_at: new Date().toISOString(),\n                updated_at: new Date().toISOString(),\n              });\n            } catch (e) {\n              console.error('Failed to restore user info:', e);\n            }\n          }\n        }\n\n        setIsInitializing(false);\n      } catch (error) {\n        console.error('Auth initialization failed:', error);\n        setIsInitializing(false);\n      }\n    };\n\n    initializeAuth();\n  }, [isAuthenticated, user]);\n\n  // 处理未认证重定向\n  useEffect(() => {\n    if (requireAuth && !isAuthenticated && !fallback) {\n      router.push(redirectTo);\n    }\n  }, [requireAuth, isAuthenticated, fallback, router, redirectTo]);\n\n  // 正在初始化或加载中\n  if (isInitializing || isLoading) {\n    return (\n      <div className='flex items-center justify-center min-h-screen'>\n        <LoadingSpinner size='lg' />\n      </div>\n    );\n  }\n\n  // 不需要认证，直接渲染子组件\n  if (!requireAuth) {\n    return <>{children}</>;\n  }\n\n  if (requireAuth && (!isAuthenticated || !user)) {\n    if (fallback) {\n      return <>{fallback}</>;\n    }\n\n    // 重定向处理\n    return (\n      <div className='flex items-center justify-center min-h-screen'>\n        <LoadingSpinner size='lg' />\n      </div>\n    );\n  }\n\n  // 检查角色权限\n  if (requiredRole && !hasRole(requiredRole)) {\n    return (\n      <div className='flex items-center justify-center min-h-screen'>\n        <div className='text-center'>\n          <h2 className='text-2xl font-bold text-gray-900 mb-4'>访问被拒绝</h2>\n          <p className='text-gray-600 mb-6'>您没有访问此页面的权限</p>\n          <button\n            onClick={e => {\n              e.preventDefault();\n              setTimeout(() => router.back(), 0);\n            }}\n            className='px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700'\n          >\n            返回上一页\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // 检查具体权限\n  if (requiredPermissions.length > 0) {\n    const hasAllPermissions = requiredPermissions.every(permission => hasPermission(permission));\n\n    if (!hasAllPermissions) {\n      return (\n        <div className='flex items-center justify-center min-h-screen'>\n          <div className='text-center'>\n            <h2 className='text-2xl font-bold text-gray-900 mb-4'>权限不足</h2>\n            <p className='text-gray-600 mb-6'>您没有执行此操作的权限</p>\n            <button\n              onClick={e => {\n                e.preventDefault();\n                setTimeout(() => router.back(), 0);\n              }}\n              className='px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700'\n            >\n              返回上一页\n            </button>\n          </div>\n        </div>\n      );\n    }\n  }\n\n  // 通过所有检查，渲染子组件\n  return <>{children}</>;\n};\n\n/**\n * 权限检查组件\n * 用于在组件内部进行权限控制\n */\ninterface PermissionGuardProps {\n  children: React.ReactNode;\n  permissions?: string[];\n  role?: string;\n  fallback?: React.ReactNode;\n  requireAll?: boolean; // 是否需要所有权限，默认为 true\n}\n\nexport const PermissionGuard: React.FC<PermissionGuardProps> = ({\n  children,\n  permissions = [],\n  role,\n  fallback = null,\n  requireAll = true,\n}) => {\n  const { hasPermission, hasRole } = useAuthStore();\n\n  // 检查角色\n  if (role && !hasRole(role)) {\n    return <>{fallback}</>;\n  }\n\n  // 检查权限\n  if (permissions.length > 0) {\n    const checkPermissions = requireAll\n      ? permissions.every(permission => hasPermission(permission))\n      : permissions.some(permission => hasPermission(permission));\n\n    if (!checkPermissions) {\n      return <>{fallback}</>;\n    }\n  }\n\n  return <>{children}</>;\n};\n\n/**\n * 角色检查组件\n * 用于基于角色显示不同内容\n */\ninterface RoleGuardProps {\n  children: React.ReactNode;\n  roles: string[];\n  fallback?: React.ReactNode;\n  requireAll?: boolean;\n}\n\nexport const RoleGuard: React.FC<RoleGuardProps> = ({\n  children,\n  roles,\n  fallback = null,\n  requireAll = false,\n}) => {\n  const { hasRole } = useAuthStore();\n\n  const checkRoles = requireAll\n    ? roles.every(role => hasRole(role))\n    : roles.some(role => hasRole(role));\n\n  if (!checkRoles) {\n    return <>{fallback}</>;\n  }\n\n  return <>{children}</>;\n};\n\n/**\n * 高阶组件：为组件添加路由守卫\n */\nexport function withRouteGuard<P extends object>(\n  Component: React.ComponentType<P>,\n  options: {\n    requireAuth?: boolean;\n    requiredPermissions?: string[];\n    requiredRole?: string;\n  } = {}\n) {\n  const WrappedComponent = (props: P) => {\n    return (\n      <AuthGuard\n        requireAuth={options.requireAuth}\n        requiredPermissions={options.requiredPermissions}\n        requiredRole={options.requiredRole}\n      >\n        <Component {...props} />\n      </AuthGuard>\n    );\n  };\n\n  WrappedComponent.displayName = `withRouteGuard(${Component.displayName || Component.name})`;\n\n  return WrappedComponent;\n}\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}