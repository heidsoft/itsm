{"version":3,"names":["cov_2pbtxmuo0h","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","s","f","b","inputSourceMap","version","sources","sourcesContent","names","mappings","_coverageSchema","coverage","actualCoverage","TicketAutomationRuleApi","listRules","_httpclient","httpClient","get","getRule","ruleId","createRule","data","post","updateRule","put","deleteRule","delete","testRule","rule_id","ticket_id"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/lib/api/ticket-automation-rule-api.ts"],"sourcesContent":["/**\n * 工单自动化规则API\n * 提供自动化规则的创建、查询、更新、删除和测试功能\n */\n\nimport { httpClient } from './http-client';\n\nexport interface AutomationRule {\n  id: number;\n  name: string;\n  description?: string;\n  priority: number;\n  conditions: Array<{\n    field: string;\n    operator: string;\n    value: any;\n  }>;\n  actions: Array<{\n    type: string;\n    [key: string]: any;\n  }>;\n  is_active: boolean;\n  execution_count: number;\n  last_executed_at?: string;\n  created_by: number;\n  creator?: {\n    id: number;\n    username: string;\n    name: string;\n    email: string;\n    role: string;\n  };\n  tenant_id: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface CreateAutomationRuleRequest {\n  name: string;\n  description?: string;\n  priority: number;\n  conditions: Array<{\n    field: string;\n    operator: string;\n    value: any;\n  }>;\n  actions: Array<{\n    type: string;\n    [key: string]: any;\n  }>;\n  is_active: boolean;\n}\n\nexport interface UpdateAutomationRuleRequest {\n  name?: string;\n  description?: string;\n  priority?: number;\n  conditions?: Array<{\n    field: string;\n    operator: string;\n    value: any;\n  }>;\n  actions?: Array<{\n    type: string;\n    [key: string]: any;\n  }>;\n  is_active?: boolean;\n}\n\nexport interface TestAutomationRuleRequest {\n  rule_id: number;\n  ticket_id: number;\n}\n\nexport interface TestAutomationRuleResponse {\n  matched: boolean;\n  actions?: string[];\n  reason?: string;\n  error?: string;\n}\n\nexport interface ListAutomationRulesResponse {\n  rules: AutomationRule[];\n  total: number;\n}\n\nexport class TicketAutomationRuleApi {\n  /**\n   * 获取自动化规则列表\n   */\n  static async listRules(): Promise<ListAutomationRulesResponse> {\n    return httpClient.get<ListAutomationRulesResponse>('/api/v1/tickets/automation-rules');\n  }\n\n  /**\n   * 获取自动化规则详情\n   */\n  static async getRule(ruleId: number): Promise<AutomationRule> {\n    return httpClient.get<AutomationRule>(`/api/v1/tickets/automation-rules/${ruleId}`);\n  }\n\n  /**\n   * 创建自动化规则\n   */\n  static async createRule(data: CreateAutomationRuleRequest): Promise<AutomationRule> {\n    return httpClient.post<AutomationRule>('/api/v1/tickets/automation-rules', data);\n  }\n\n  /**\n   * 更新自动化规则\n   */\n  static async updateRule(ruleId: number, data: UpdateAutomationRuleRequest): Promise<AutomationRule> {\n    return httpClient.put<AutomationRule>(`/api/v1/tickets/automation-rules/${ruleId}`, data);\n  }\n\n  /**\n   * 删除自动化规则\n   */\n  static async deleteRule(ruleId: number): Promise<void> {\n    return httpClient.delete(`/api/v1/tickets/automation-rules/${ruleId}`);\n  }\n\n  /**\n   * 测试自动化规则\n   */\n  static async testRule(data: TestAutomationRuleRequest): Promise<TestAutomationRuleResponse> {\n    return httpClient.post<TestAutomationRuleResponse>(`/api/v1/tickets/automation-rules/${data.rule_id}/test`, {\n      ticket_id: data.ticket_id,\n    });\n  }\n}\n\n"],"mappings":"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","ignoreList":[]}