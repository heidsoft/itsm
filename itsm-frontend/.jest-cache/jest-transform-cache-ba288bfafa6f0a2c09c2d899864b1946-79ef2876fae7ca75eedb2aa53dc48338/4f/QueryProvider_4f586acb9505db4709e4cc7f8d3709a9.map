{"version":3,"names":["QueryProvider","ReactQueryDevtools","cov_q0kfen0u9","s","b","window","process","env","NODE_ENV","_react","lazy","f","Promise","resolve","then","_interop_require_wildcard","require","module","default","createQueryClient","_reactquery","QueryClient","defaultOptions","queries","staleTime","gcTime","retry","retryDelay","attemptIndex","Math","min","refetchOnWindowFocus","refetchOnReconnect","mutations","children","queryClient","useState","mounted","setMounted","useEffect","_jsxruntime","jsxs","QueryClientProvider","client","jsx","Suspense","fallback","initialIsOpen"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/app/lib/providers/QueryProvider.tsx"],"sourcesContent":["'use client';\n\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\nimport { ReactNode, useState, lazy, Suspense, useEffect } from 'react';\n\n// 动态导入ReactQueryDevtools，只在开发环境中使用\n// 使用 disableHydrationWarning 防止 SSR 水合错误\nconst ReactQueryDevtools =\n  typeof window !== 'undefined' && process.env.NODE_ENV === 'development'\n    ? lazy(() =>\n        import('@tanstack/react-query-devtools').then(module => ({\n          default: module.ReactQueryDevtools,\n        }))\n      )\n    : null;\n\n// 创建QueryClient实例\nconst createQueryClient = () => {\n  return new QueryClient({\n    defaultOptions: {\n      queries: {\n        // 数据缓存时间（5分钟）\n        staleTime: 5 * 60 * 1000,\n        // 缓存保留时间（10分钟）\n        gcTime: 10 * 60 * 1000,\n        // 重试次数\n        retry: 3,\n        // 重试延迟\n        retryDelay: attemptIndex => Math.min(1000 * 2 ** attemptIndex, 30000),\n        // 窗口失焦时不重新获取数据\n        refetchOnWindowFocus: false,\n        // 网络重连时重新获取数据\n        refetchOnReconnect: true,\n      },\n      mutations: {\n        // 失败时重试\n        retry: 1,\n        // 重试延迟\n        retryDelay: 1000,\n      },\n    },\n  });\n};\n\ninterface QueryProviderProps {\n  children: ReactNode;\n}\n\nexport const QueryProvider: React.FC<QueryProviderProps> = ({ children }) => {\n  const [queryClient] = useState(() => createQueryClient());\n  const [mounted, setMounted] = useState(false);\n\n  // 使用 useEffect 确保只在客户端挂载\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      {children}\n      {mounted && typeof window !== 'undefined' && ReactQueryDevtools && (\n        <Suspense fallback={null}>\n          <ReactQueryDevtools initialIsOpen={false} />\n        </Suspense>\n      )}\n    </QueryClientProvider>\n  );\n};\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAgDa;;;;;;WAAAA,aAAA;;;;;;;;iCA9CoC;;;iCACc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAE/D;AACA;AACA,MAAMC,kBAAA;AAAA;AAAA,CAAAC,aAAA,GAAAC,CAAA;AACJ;AAAA,CAAAD,aAAA,GAAAE,CAAA,kBAAOC,MAAA,KAAW;AAAA;AAAA,CAAAH,aAAA,GAAAE,CAAA,WAAeE,OAAA,CAAQC,GAAG,CAACC,QAAQ,KAAK;AAAA;AAAA,cAAAN,aAAA,GAAAE,CAAA,WACtD,IAAAK,MAAA,CAAAC,IAAI,EAAC,MACH;EAAA;EAAAR,aAAA,GAAAS,CAAA;EAAAT,aAAA,GAAAC,CAAA;EAAA,OAAAS,OAAA,CAAAC,OAAA,GAAAC,IAAA;IAAA;IAAAZ,aAAA,GAAAS,CAAA;IAAAT,aAAA,GAAAC,CAAA;IAAA,oBAAAY,yBAAA,CAAAC,OAAA,CAAO;EAAA,GAAkCF,IAAI,CAACG,MAAA,IAAW;IAAA;IAAAf,aAAA,GAAAS,CAAA;IAAAT,aAAA,GAAAC,CAAA;IAAA;MACvDe,OAAA,EAASD,MAAA,CAAOhB;IAClB;EAAA;AAAA;AAAA;AAAA,CAAAC,aAAA,GAAAE,CAAA,WAEF;AAEN;AAAA;AAAAF,aAAA,GAAAC,CAAA;AACA,MAAMgB,iBAAA,GAAoBA,CAAA;EAAA;EAAAjB,aAAA,GAAAS,CAAA;EAAAT,aAAA,GAAAC,CAAA;EACxB,OAAO,IAAIiB,WAAA,CAAAC,WAAW,CAAC;IACrBC,cAAA,EAAgB;MACdC,OAAA,EAAS;QACP;QACAC,SAAA,EAAW,IAAI,KAAK;QACpB;QACAC,MAAA,EAAQ,KAAK,KAAK;QAClB;QACAC,KAAA,EAAO;QACP;QACAC,UAAA,EAAYC,YAAA,IAAgB;UAAA;UAAA1B,aAAA,GAAAS,CAAA;UAAAT,aAAA,GAAAC,CAAA;UAAA,OAAA0B,IAAA,CAAKC,GAAG,CAAC,OAAO,KAAKF,YAAA,EAAc;QAAA;QAC/D;QACAG,oBAAA,EAAsB;QACtB;QACAC,kBAAA,EAAoB;MACtB;MACAC,SAAA,EAAW;QACT;QACAP,KAAA,EAAO;QACP;QACAC,UAAA,EAAY;MACd;IACF;EACF;AACF;AAAA;AAAAzB,aAAA,GAAAC,CAAA;AAMO,MAAMH,aAAA,GAA8CA,CAAC;EAAEkC;AAAQ,CAAE;EAAA;EAAAhC,aAAA,GAAAS,CAAA;EACtE,MAAM,CAACwB,WAAA,CAAY;EAAA;EAAA,CAAAjC,aAAA,GAAAC,CAAA,QAAG,IAAAM,MAAA,CAAA2B,QAAQ,EAAC,MAAM;IAAA;IAAAlC,aAAA,GAAAS,CAAA;IAAAT,aAAA,GAAAC,CAAA;IAAA,OAAAgB,iBAAA;EAAA;EACrC,MAAM,CAACkB,OAAA,EAASC,UAAA,CAAW;EAAA;EAAA,CAAApC,aAAA,GAAAC,CAAA,QAAG,IAAAM,MAAA,CAAA2B,QAAQ,EAAC;EAEvC;EAAA;EAAAlC,aAAA,GAAAC,CAAA;EACA,IAAAM,MAAA,CAAA8B,SAAS,EAAC;IAAA;IAAArC,aAAA,GAAAS,CAAA;IAAAT,aAAA,GAAAC,CAAA;IACRmC,UAAA,CAAW;EACb,GAAG,EAAE;EAAA;EAAApC,aAAA,GAAAC,CAAA;EAEL,oBACE,IAAAqC,WAAA,CAAAC,IAAA,EAACrB,WAAA,CAAAsB,mBAAmB;IAACC,MAAA,EAAQR,WAAA;eAC1BD,QAAA;IACA;IAAA,CAAAhC,aAAA,GAAAE,CAAA,WAAAiC,OAAA;IAAA;IAAA,CAAAnC,aAAA,GAAAE,CAAA,WAAW,OAAOC,MAAA,KAAW;IAAA;IAAA,CAAAH,aAAA,GAAAE,CAAA,WAAeH,kBAAA;IAAA;IAAA,CAAAC,aAAA,GAAAE,CAAA,wBAC3C,IAAAoC,WAAA,CAAAI,GAAA,EAACnC,MAAA,CAAAoC,QAAQ;MAACC,QAAA,EAAU;gBAClB,iBAAAN,WAAA,CAAAI,GAAA,EAAC3C,kBAAA;QAAmB8C,aAAA,EAAe;;;;AAK7C","ignoreList":[]}