{"version":3,"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/__tests__/pages/cmdb-page.test.tsx"],"sourcesContent":["/**\n * CMDB 页面测试\n */\n\nimport React from 'react';\nimport { render, screen, fireEvent, waitFor, act } from '@testing-library/react';\nimport '@testing-library/jest-dom';\n\nimport CIList from '@/modules/cmdb/components/CIList';\nimport CIDetail from '@/modules/cmdb/components/CIDetail';\nimport CreateCIPage from '@/app/(main)/cmdb/cis/create/page';\nimport { CMDBApi } from '@/modules/cmdb/api';\nimport type { ConfigurationItem, CIType } from '@/modules/cmdb/types';\n\nconst mockPush = jest.fn();\nconst mockBack = jest.fn();\nvar modalConfirmSpy: jest.Mock;\nlet formValues: Record<string, unknown> = {};\n\njest.mock('next/navigation', () => ({\n  useRouter: () => ({\n    push: mockPush,\n    back: mockBack,\n    replace: jest.fn(),\n    prefetch: jest.fn(),\n  }),\n  useParams: () => ({ id: '1' }),\n}));\n\njest.mock('antd', () => {\n  const actual = jest.requireActual('antd');\n  const React = jest.requireActual('react');\n  modalConfirmSpy = jest.fn();\n  formValues = {};\n  const FormContext = React.createContext({\n    values: {},\n    setValues: () => {},\n  });\n\n  const Form = ({ children, onFinish }: any) => {\n    const [values, setValues] = React.useState<Record<string, unknown>>({});\n    const handleSubmit = (event: React.FormEvent) => {\n      event.preventDefault();\n      onFinish?.(values);\n    };\n\n    return (\n      <form onSubmit={handleSubmit}>\n        <FormContext.Provider value={{ values, setValues }}>\n          {children}\n        </FormContext.Provider>\n      </form>\n    );\n  };\n\n  Form.Item = ({ label, name, children }: any) => {\n    const context = React.useContext(FormContext);\n    if (!React.isValidElement(children)) {\n      return label ? (\n        <label>\n          {label}\n          {children}\n        </label>\n      ) : (\n        <>{children}</>\n      );\n    }\n\n    const handleChange = (event: any) => {\n      const value = event?.target?.value ?? event;\n      context.setValues((prev: Record<string, unknown>) => {\n        formValues = { ...prev, [name]: value };\n        return formValues;\n      });\n      children.props.onChange?.(event);\n    };\n\n    const inputElement = React.cloneElement(children, {\n      'aria-label': label,\n      name,\n      value: context.values[name] ?? '',\n      onChange: handleChange,\n    });\n\n    return label ? <label>{label}{inputElement}</label> : inputElement;\n  };\n\n  Form.useForm = () => [\n    {\n      getFieldsValue: () => ({ ...formValues }),\n      resetFields: jest.fn(() => {\n        formValues = {};\n      }),\n      setFieldsValue: jest.fn((values: Record<string, unknown>) => {\n        formValues = { ...formValues, ...values };\n      }),\n    },\n  ];\n\n  const Input = ({ allowClear, ...rest }: any) => <input {...rest} />;\n  Input.TextArea = ({ allowClear, ...rest }: any) => <textarea {...rest} />;\n\n  const Select = ({\n    children,\n    onChange,\n    value,\n    allowClear,\n    loading,\n    placeholder,\n    style,\n    ...rest\n  }: any) => (\n    <select\n      {...rest}\n      value={value ?? ''}\n      onChange={(event) => onChange?.(event.target.value)}\n    >\n      {children}\n    </select>\n  );\n  Select.Option = ({ value, children }: any) => <option value={value}>{children}</option>;\n\n  const Button = ({\n    children,\n    onClick,\n    htmlType,\n    danger,\n    type,\n    loading,\n    ...rest\n  }: any) => (\n    <button\n      type={htmlType === 'submit' ? 'submit' : 'button'}\n      onClick={onClick}\n      data-danger={danger ? 'true' : undefined}\n      data-variant={type || undefined}\n      {...rest}\n    >\n      {children}\n    </button>\n  );\n\n  const Table = ({ dataSource = [], columns = [], loading, pagination, ...rest }: any) => (\n    <div>\n      {pagination?.onChange && (\n        <button\n          type=\"button\"\n          data-testid=\"pagination-next\"\n          onClick={() => pagination.onChange(2, pagination.pageSize || 10)}\n        >\n          Next\n        </button>\n      )}\n      {dataSource.map((record: any, rowIndex: number) => (\n        <div key={record.id ?? rowIndex}>\n          {columns.map((column: any, colIndex: number) => {\n            const value = record[column.dataIndex];\n            const content = column.render ? column.render(value, record) : value;\n            return <div key={column.key ?? column.dataIndex ?? colIndex}>{content}</div>;\n          })}\n        </div>\n      ))}\n    </div>\n  );\n\n  const Tabs = ({ children }: any) => <div>{children}</div>;\n  Tabs.TabPane = ({ children }: any) => <div>{children}</div>;\n\n  const Descriptions = ({ children }: any) => <div>{children}</div>;\n  Descriptions.Item = ({ label, children }: any) => (\n    <div>\n      <span>{label}</span>\n      {children}\n    </div>\n  );\n\n  const Card = ({ children }: any) => <div>{children}</div>;\n  const Space = ({ children }: any) => <div>{children}</div>;\n  const Breadcrumb = ({ items = [] }: any) => (\n    <nav>\n      {items.map((item: any, index: number) => (\n        <span key={index}>{item.title}</span>\n      ))}\n    </nav>\n  );\n  const Tag = ({ children }: any) => <span>{children}</span>;\n  const Skeleton = ({ children }: any) => <div>{children}</div>;\n  const Result = ({ title, subTitle, extra }: any) => (\n    <div>\n      <div>{title}</div>\n      <div>{subTitle}</div>\n      {extra}\n    </div>\n  );\n  const Empty = ({ description }: any) => <div>{description}</div>;\n  const Tooltip = ({ children }: any) => <span>{children}</span>;\n\n  return {\n    ...actual,\n    Button,\n    Card,\n    Breadcrumb,\n    Descriptions,\n    Empty,\n    Form,\n    Input,\n    Modal: {\n      ...actual.Modal,\n      confirm: modalConfirmSpy,\n    },\n    Select,\n    Skeleton,\n    Space,\n    Table,\n    Tabs,\n    Tag,\n    Tooltip,\n    Result,\n    message: {\n      success: jest.fn(),\n      error: jest.fn(),\n      warning: jest.fn(),\n      info: jest.fn(),\n    },\n  };\n});\n\njest.mock('@/modules/cmdb/api', () => ({\n  CMDBApi: {\n    getCIs: jest.fn(),\n    getCI: jest.fn(),\n    getTypes: jest.fn(),\n    createCI: jest.fn(),\n    deleteCI: jest.fn(),\n  },\n}));\n\nconst mockTypes: CIType[] = [\n  {\n    id: 1,\n    name: '服务器',\n    description: '',\n    is_active: true,\n    tenant_id: 1,\n  },\n];\n\nconst mockItem: ConfigurationItem = {\n  id: 1,\n  name: '应用服务器-01',\n  description: '测试资产',\n  type: 'server',\n  status: 'active',\n  ci_type_id: 1,\n  tenant_id: 1,\n  created_at: '2024-01-01T00:00:00Z',\n  updated_at: '2024-01-01T00:00:00Z',\n};\n\ndescribe('CMDB 页面', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    if (modalConfirmSpy) {\n      modalConfirmSpy.mockClear();\n    }\n    (CMDBApi.getTypes as jest.Mock).mockResolvedValue(mockTypes);\n    (CMDBApi.getCIs as jest.Mock).mockResolvedValue({\n      items: [mockItem],\n      total: 1,\n      page: 1,\n      size: 10,\n    });\n    (CMDBApi.getCI as jest.Mock).mockResolvedValue(mockItem);\n    (CMDBApi.createCI as jest.Mock).mockResolvedValue(mockItem);\n    (CMDBApi.deleteCI as jest.Mock).mockResolvedValue(undefined);\n  });\n\n  it('CI 列表应展示资产并支持跳转', async () => {\n    render(<CIList />);\n\n    await screen.findByText('应用服务器-01');\n\n    fireEvent.click(screen.getByRole('button', { name: '应用服务器-01' }));\n    expect(mockPush).toHaveBeenCalledWith('/cmdb/cis/1');\n  });\n\n  it('CI 列表筛选触发数据刷新', async () => {\n    render(<CIList />);\n\n    await screen.findByText('应用服务器-01');\n\n    fireEvent.change(screen.getByPlaceholderText('搜索名称/序列号'), {\n      target: { value: 'server' },\n    });\n    const queryButton = screen.getByText('查询').closest('button');\n    fireEvent.click(queryButton as HTMLElement);\n\n    await waitFor(() => {\n      expect(CMDBApi.getCIs).toHaveBeenCalledTimes(2);\n    });\n  });\n\n  it('CI 列表筛选条件应传递到请求', async () => {\n    render(<CIList />);\n\n    await screen.findByText('应用服务器-01');\n\n    fireEvent.change(screen.getByPlaceholderText('搜索名称/序列号'), {\n      target: { value: 'db' },\n    });\n    fireEvent.change(screen.getByLabelText('资产类型'), {\n      target: { value: '1' },\n    });\n    fireEvent.change(screen.getByLabelText('状态'), {\n      target: { value: 'inactive' },\n    });\n\n    const queryButton = screen.getByText('查询').closest('button');\n    fireEvent.click(queryButton as HTMLElement);\n\n    await waitFor(() => {\n      const lastCall = (CMDBApi.getCIs as jest.Mock).mock.calls.at(-1);\n      expect(lastCall?.[0]).toEqual(\n        expect.objectContaining({\n          search: 'db',\n          ci_type_id: '1',\n          status: 'inactive',\n        })\n      );\n    });\n  });\n\n  it('分页切换应触发请求', async () => {\n    render(<CIList />);\n\n    await screen.findByText('应用服务器-01');\n    fireEvent.click(screen.getByTestId('pagination-next'));\n\n    await waitFor(() => {\n      expect(CMDBApi.getCIs).toHaveBeenCalledTimes(2);\n    });\n  });\n\n  it('刷新按钮应重新拉取数据', async () => {\n    render(<CIList />);\n\n    await screen.findByText('应用服务器-01');\n    fireEvent.click(screen.getByRole('button', { name: '刷新' }));\n\n    await waitFor(() => {\n      expect(CMDBApi.getCIs).toHaveBeenCalledTimes(2);\n    });\n  });\n\n  it('列表为空时不应展示资产名称', async () => {\n    (CMDBApi.getCIs as jest.Mock).mockResolvedValueOnce({\n      items: [],\n      total: 0,\n      page: 1,\n      size: 10,\n    });\n    render(<CIList />);\n\n    await waitFor(() => {\n      expect(CMDBApi.getCIs).toHaveBeenCalled();\n    });\n    expect(screen.queryByText('应用服务器-01')).not.toBeInTheDocument();\n  });\n\n  it('删除失败应提示错误', async () => {\n    const antd = require('antd');\n    modalConfirmSpy.mockImplementation(({ onOk }: { onOk?: () => void }) => {\n      onOk?.();\n    });\n    (CMDBApi.deleteCI as jest.Mock).mockRejectedValueOnce(new Error('删除失败'));\n    render(<CIList />);\n\n    await screen.findByText('应用服务器-01');\n    fireEvent.click(screen.getByRole('button', { name: '删除' }));\n\n    await waitFor(() => {\n      expect(antd.message.error).toHaveBeenCalled();\n    });\n  });\n\n  it('CI 删除应弹出确认并调用删除接口', async () => {\n    modalConfirmSpy.mockImplementation(({ onOk }: { onOk?: () => void }) => {\n      onOk?.();\n    });\n    render(<CIList />);\n\n    await screen.findByText('应用服务器-01');\n\n    fireEvent.click(screen.getByRole('button', { name: '删除' }));\n    await waitFor(() => {\n      expect(CMDBApi.deleteCI).toHaveBeenCalledWith(1);\n    });\n  });\n\n  it('CI 详情应展示资产信息', async () => {\n    render(<CIDetail />);\n\n    await waitFor(() => {\n      expect(screen.getByText('应用服务器-01')).toBeInTheDocument();\n    });\n    expect(screen.getByText(/配置项 ID: 1/)).toBeInTheDocument();\n  });\n\n  it('CI 详情加载失败应显示 404', async () => {\n    const antd = require('antd');\n    (CMDBApi.getCI as jest.Mock).mockRejectedValueOnce(new Error('not found'));\n    render(<CIDetail />);\n\n    await waitFor(() => {\n      expect(antd.message.error).toHaveBeenCalled();\n    });\n    expect(screen.getByText('404')).toBeInTheDocument();\n  });\n\n  it('创建 CI 表单应提交并返回列表', async () => {\n    render(<CreateCIPage />);\n\n    await waitFor(() => {\n      expect(CMDBApi.getTypes).toHaveBeenCalled();\n    });\n\n    fireEvent.change(screen.getByLabelText('资产名称'), {\n      target: { value: '新资产' },\n    });\n\n    fireEvent.change(screen.getByLabelText('资产类型'), {\n      target: { value: '1' },\n    });\n\n    fireEvent.change(screen.getByLabelText('状态'), {\n      target: { value: 'active' },\n    });\n\n    const form = document.querySelector('form');\n    fireEvent.submit(form as HTMLFormElement);\n\n    await waitFor(() => {\n      expect(CMDBApi.createCI).toHaveBeenCalled();\n    });\n    expect(mockPush).toHaveBeenCalledWith('/cmdb');\n  });\n\n  it('创建 CI 表单应校验扩展属性 JSON', async () => {\n    const antd = require('antd');\n    render(<CreateCIPage />);\n\n    await waitFor(() => {\n      expect(CMDBApi.getTypes).toHaveBeenCalled();\n    });\n\n    fireEvent.change(screen.getByLabelText('资产名称'), {\n      target: { value: '新资产' },\n    });\n    fireEvent.change(screen.getByLabelText('资产类型'), {\n      target: { value: '1' },\n    });\n    fireEvent.change(screen.getByLabelText('状态'), {\n      target: { value: 'active' },\n    });\n    fireEvent.change(screen.getByLabelText('扩展属性'), {\n      target: { value: '{bad json' },\n    });\n\n    await waitFor(() => {\n      expect(screen.getByLabelText('扩展属性')).toHaveValue('{bad json');\n    });\n\n    fireEvent.click(screen.getByRole('button', { name: '保存' }));\n\n    await waitFor(() => {\n      expect(CMDBApi.createCI).not.toHaveBeenCalled();\n    });\n    expect(mockPush).not.toHaveBeenCalled();\n  });\n});\n"],"names":["jest","mock","useRouter","push","mockPush","back","mockBack","replace","fn","prefetch","useParams","id","actual","requireActual","React","modalConfirmSpy","formValues","FormContext","createContext","values","setValues","Form","children","onFinish","useState","handleSubmit","event","preventDefault","form","onSubmit","Provider","value","Item","label","name","context","useContext","isValidElement","handleChange","target","prev","props","onChange","inputElement","cloneElement","useForm","getFieldsValue","resetFields","setFieldsValue","Input","allowClear","rest","input","TextArea","textarea","Select","loading","placeholder","style","select","Option","option","Button","onClick","htmlType","danger","type","button","data-danger","undefined","data-variant","Table","dataSource","columns","pagination","div","data-testid","pageSize","map","record","rowIndex","column","colIndex","dataIndex","content","render","key","Tabs","TabPane","Descriptions","span","Card","Space","Breadcrumb","items","nav","item","index","title","Tag","Skeleton","Result","subTitle","extra","Empty","description","Tooltip","Modal","confirm","message","success","error","warning","info","CMDBApi","getCIs","getCI","getTypes","createCI","deleteCI","mockTypes","is_active","tenant_id","mockItem","status","ci_type_id","created_at","updated_at","describe","beforeEach","clearAllMocks","mockClear","mockResolvedValue","total","page","size","it","CIList","screen","findByText","fireEvent","click","getByRole","expect","toHaveBeenCalledWith","change","getByPlaceholderText","queryButton","getByText","closest","waitFor","toHaveBeenCalledTimes","getByLabelText","lastCall","calls","at","toEqual","objectContaining","search","getByTestId","mockResolvedValueOnce","toHaveBeenCalled","queryByText","not","toBeInTheDocument","antd","require","mockImplementation","onOk","mockRejectedValueOnce","Error","CIDetail","CreateCIPage","document","querySelector","submit","toHaveValue"],"mappings":"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"}