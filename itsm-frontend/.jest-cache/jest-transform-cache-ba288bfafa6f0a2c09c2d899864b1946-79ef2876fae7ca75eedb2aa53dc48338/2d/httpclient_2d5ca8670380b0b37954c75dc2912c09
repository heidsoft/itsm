ba1d186ebd7683fe61f89a092bd9cdd9
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    default: function() {
        return _default;
    },
    httpClient: function() {
        return httpClient;
    }
});
const _apiconfig = require("../../app/lib/api-config");
const _security = require("../security");
const _env = require("../env");
class HttpClient {
    constructor(baseURL = _apiconfig.API_BASE_URL){
        this.token = null;
        this.tenantId = null;
        this.tenantCode = null;
        this.baseURL = process.env.NEXT_PUBLIC_API_URL || baseURL;
        this.timeout = parseInt(process.env.NEXT_PUBLIC_API_TIMEOUT || '30000');
        // Get token and tenant ID from localStorage
        if (typeof window !== 'undefined') {
            this.token = localStorage.getItem('access_token'); // Changed to access_token
            const storedTenantId = localStorage.getItem('current_tenant_id');
            this.tenantId = storedTenantId ? parseInt(storedTenantId) : null;
            this.tenantCode = localStorage.getItem('current_tenant_code') || null;
        }
    }
    setToken(token) {
        this.token = token;
        if (typeof window !== 'undefined') {
            localStorage.setItem('access_token', token); // Changed to access_token
            // 同步更新 Cookie，有效期 15 分钟
            document.cookie = `auth-token=${token}; path=/; max-age=900; SameSite=Lax`;
        }
    }
    clearToken() {
        this.token = null;
        if (typeof window !== 'undefined') {
            localStorage.removeItem('access_token'); // Changed to access_token
            // 清除 Cookie
            document.cookie = 'auth-token=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
            document.cookie = 'refresh-token=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        }
    }
    setTenantId(tenantId) {
        this.tenantId = tenantId;
        if (typeof window !== 'undefined') {
            if (tenantId) {
                localStorage.setItem('current_tenant_id', tenantId.toString());
            } else {
                localStorage.removeItem('current_tenant_id');
            }
        }
    }
    setTenantCode(code) {
        this.tenantCode = code;
        _env.logger.info('HttpClient.setTenantCode:', code);
        if (typeof window !== 'undefined') {
            if (code) {
                localStorage.setItem('current_tenant_code', code);
            } else {
                localStorage.removeItem('current_tenant_code');
            }
        }
    }
    // Get tenant code
    getTenantCode() {
        return this.tenantCode;
    }
    getTenantId() {
        return this.tenantId;
    }
    getAuthToken() {
        return this.token;
    }
    // Backward-compat helpers (some legacy code expects these)
    getToken() {
        return this.getAuthToken();
    }
    getBaseURL() {
        return this.baseURL;
    }
    getHeaders() {
        // Set secure request headers
        const csrfToken = _security.security.csrf.getTokenFromMeta();
        const headers = {
            ..._security.security.network.getSecureHeaders(csrfToken || undefined)
        };
        // Dynamically get the latest token and tenantId
        const currentToken = typeof window !== 'undefined' ? localStorage.getItem('access_token') : this.token;
        const currentTenantId = typeof window !== 'undefined' ? localStorage.getItem('current_tenant_id') : this.tenantId;
        if (currentToken) {
            headers['Authorization'] = `Bearer ${currentToken}`;
        }
        if (currentTenantId) {
            headers['X-Tenant-ID'] = currentTenantId.toString();
        }
        const currentTenantCode = typeof window !== 'undefined' ? localStorage.getItem('current_tenant_code') : this.tenantCode;
        if (currentTenantCode) {
            headers['X-Tenant-Code'] = currentTenantCode;
        }
        return headers;
    }
    // Independent token refresh method to avoid circular dependencies
    async refreshTokenInternal() {
        const refreshToken = typeof window !== 'undefined' ? localStorage.getItem('refresh_token') : null;
        if (!refreshToken) {
            return false;
        }
        try {
            const response = await fetch(`${this.baseURL}/api/v1/refresh-token`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    refresh_token: refreshToken
                })
            });
            if (response.ok) {
                const data = await response.json();
                if (data.code === 0) {
                    // Update access token
                    this.setToken(data.data.access_token);
                    // Also update instance variable
                    this.token = data.data.access_token;
                    return true;
                }
            }
            return false;
        } catch (error) {
            _env.logger.error('Token refresh failed:', error);
            return false;
        }
    }
    // Core request method using fetch API (internal)
    async requestInternal(endpoint, config) {
        const url = `${this.baseURL}${endpoint}`;
        const headers = this.getHeaders();
        const requestConfig = {
            method: config.method,
            headers: {
                ...headers,
                ...config.headers
            },
            body: config.body
        };
        _env.logger.debug('HTTP Client Request:', {
            url,
            method: config.method,
            headers,
            body: config.body
        });
        // 在开发模式下，如果后端服务不可用，使用模拟数据
        if (process.env.NODE_ENV === 'development' && this.baseURL.includes('localhost')) {
            _env.logger.warn('开发模式：正在连接到后端服务，如果后端服务未运行，将显示错误');
        }
        try {
            const controller = new AbortController();
            const timeoutId = setTimeout(()=>controller.abort(), this.timeout);
            const response = await fetch(url, {
                ...requestConfig,
                signal: controller.signal
            });
            clearTimeout(timeoutId);
            _env.logger.debug('HTTP Client Response:', {
                status: response.status,
                statusText: response.statusText,
                headers: response.headers ? Object.fromEntries(response.headers.entries()) : {}
            });
            // If 401 error, try to refresh token
            if (response.status === 401) {
                const refreshSuccess = await this.refreshTokenInternal();
                if (refreshSuccess) {
                    // Retry original request
                    const retryConfig = {
                        ...requestConfig,
                        headers: {
                            ...this.getHeaders(),
                            ...config.headers
                        }
                    };
                    const retryResponse = await fetch(url, retryConfig);
                    if (!retryResponse.ok) {
                        const rid = retryResponse.headers.get('X-Request-Id') || '';
                        const suffix = rid ? ` [RID: ${rid}]` : '';
                        throw new Error(`HTTP error! status: ${retryResponse.status}${suffix}`);
                    }
                    const retryData = await retryResponse.json();
                    _env.logger.debug('HTTP Client Retry Response Data:', retryData);
                    // Check response code
                    if (retryData.code !== 0) {
                        const rid = retryResponse.headers.get('X-Request-Id') || '';
                        const suffix = rid ? ` [RID: ${rid}]` : '';
                        throw new Error((retryData.message || 'Request failed') + suffix);
                    }
                    return retryData.data;
                } else {
                    // Refresh failed, clear token and redirect to login
                    this.clearToken();
                    if (typeof window !== 'undefined') {
                        localStorage.removeItem('refresh_token');
                        window.location.href = '/login';
                    }
                    throw new Error('Authentication failed');
                }
            }
            if (!response.ok) {
                const rid = response.headers.get('X-Request-Id') || '';
                const suffix = rid ? ` [RID: ${rid}]` : '';
                throw new Error(`HTTP error! status: ${response.status}${suffix}`);
            }
            const responseData = await response.json();
            _env.logger.debug('HTTP Client Raw Response Data:', responseData);
            // Check response code
            if (responseData.code !== 0) {
                const rid = response.headers && response.headers.get('X-Request-Id') || '';
                const suffix = rid ? ` [RID: ${rid}]` : '';
                throw new Error((responseData.message || 'Request failed') + suffix);
            }
            return responseData.data;
        } catch (error) {
            _env.logger.error('Request failed:', error);
            if (error instanceof Error) {
                if (error.name === 'AbortError') {
                    throw new Error('请求超时，请稍后重试');
                }
                if (error.message.includes('fetch')) {
                    throw new Error('无法连接到服务器，请检查网络连接和后端服务是否运行');
                }
                throw error;
            }
            throw new Error('未知错误发生');
        }
    }
    async request(arg1, arg2) {
        // Axios-like style: request({ url, method, data, headers, responseType })
        if (typeof arg1 === 'object' && arg1 && 'url' in arg1) {
            const cfg = arg1;
            const method = cfg.method || 'GET';
            let endpoint = cfg.url;
            if (cfg.params) {
                const qs = new URLSearchParams();
                Object.entries(cfg.params).forEach(([k, v])=>{
                    if (v !== undefined && v !== null) qs.append(k, String(v));
                });
                const q = qs.toString();
                if (q) endpoint += (endpoint.includes('?') ? '&' : '?') + q;
            }
            let body = undefined;
            if (cfg.data !== undefined) {
                if (cfg.data instanceof FormData) body = cfg.data;
                else body = JSON.stringify(cfg.data);
            }
            const data = cfg.responseType === 'blob' ? await (async ()=>{
                const url = `${this.baseURL}${endpoint}`;
                const headers = {
                    ...this.getHeaders(),
                    ...cfg.headers || {}
                };
                if (body instanceof FormData) delete headers['Content-Type'];
                else headers['Content-Type'] = headers['Content-Type'] || 'application/json';
                const res = await fetch(url, {
                    method,
                    headers,
                    body: body
                });
                if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
                return await res.blob();
            })() : await this.requestInternal(endpoint, {
                method,
                headers: cfg.headers,
                body: body
            });
            return data;
        }
        // Fetch-like style: request('/path', { ... })
        const endpoint = arg1;
        const cfg = arg2 || {};
        return this.requestInternal(endpoint, {
            method: cfg.method || 'GET',
            headers: cfg.headers,
            body: cfg.body,
            timeout: cfg.timeout
        });
    }
    async get(endpoint, params) {
        let url = endpoint;
        if (params) {
            const searchParams = new URLSearchParams();
            Object.entries(params).forEach(([key, value])=>{
                if (value !== undefined && value !== null) {
                    searchParams.append(key, String(value));
                }
            });
            url += `?${searchParams.toString()}`;
        }
        return this.requestInternal(url, {
            method: 'GET'
        });
    }
    async post(endpoint, data, config) {
        // 如果是 FormData，直接传递，不进行 JSON.stringify
        if (data instanceof FormData) {
            const url = `${this.baseURL}${endpoint}`;
            const headers = this.getHeaders();
            // FormData 上传时，不要设置 Content-Type，让浏览器自动设置（包含 boundary）
            delete headers['Content-Type'];
            // 如果支持上传进度，使用 XMLHttpRequest
            if (config?.onUploadProgress) {
                return new Promise((resolve, reject)=>{
                    const xhr = new XMLHttpRequest();
                    xhr.upload.addEventListener('progress', (event)=>{
                        if (event.lengthComputable && config.onUploadProgress) {
                            const progress = Math.round(event.loaded * 100 / event.total);
                            config.onUploadProgress(progress);
                        }
                    });
                    xhr.addEventListener('load', ()=>{
                        if (xhr.status >= 200 && xhr.status < 300) {
                            try {
                                const response = JSON.parse(xhr.responseText);
                                if (response.code === 0) {
                                    resolve(response.data);
                                } else {
                                    reject(new Error(response.message || 'Request failed'));
                                }
                            } catch (error) {
                                reject(new Error('Failed to parse response'));
                            }
                        } else {
                            reject(new Error(`HTTP error! status: ${xhr.status}`));
                        }
                    });
                    xhr.addEventListener('error', ()=>{
                        reject(new Error('Network error'));
                    });
                    xhr.open('POST', url);
                    Object.entries(headers).forEach(([key, value])=>{
                        if (key !== 'Content-Type') {
                            xhr.setRequestHeader(key, value);
                        }
                    });
                    xhr.send(data);
                });
            }
            // 不支持进度时，使用 fetch
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    ...headers,
                    ...config?.headers || {}
                },
                body: data
            });
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            if (config?.responseType === 'blob') {
                return await response.blob();
            }
            const responseData = await response.json();
            if (responseData.code !== 0) {
                throw new Error(responseData.message || 'Request failed');
            }
            return responseData.data;
        }
        return this.requestInternal(endpoint, {
            method: 'POST',
            body: data ? JSON.stringify(data) : undefined,
            headers: config?.headers
        });
    }
    async put(endpoint, data) {
        return this.requestInternal(endpoint, {
            method: 'PUT',
            body: data ? JSON.stringify(data) : undefined
        });
    }
    async patch(endpoint, data) {
        return this.requestInternal(endpoint, {
            method: 'PATCH',
            body: data ? JSON.stringify(data) : undefined
        });
    }
    async delete(endpoint, data) {
        return this.requestInternal(endpoint, {
            method: 'DELETE',
            body: data ? JSON.stringify(data) : undefined
        });
    }
    // 分页查询方法
    async getPaginated(endpoint, params) {
        const queryParams = new URLSearchParams();
        if (params) {
            Object.entries(params).forEach(([key, value])=>{
                if (value !== undefined && value !== null) {
                    if (key === 'filters' && typeof value === 'object') {
                        Object.entries(value).forEach(([filterKey, filterValue])=>{
                            if (filterValue !== undefined && filterValue !== null) {
                                queryParams.append(`filters[${filterKey}]`, String(filterValue));
                            }
                        });
                    } else {
                        queryParams.append(key, String(value));
                    }
                }
            });
        }
        const url = queryParams.toString() ? `${endpoint}?${queryParams.toString()}` : endpoint;
        return this.get(url);
    }
    // 批量操作方法
    async batchOperation(endpoint, operation, data) {
        return this.post(endpoint, {
            operation,
            data
        });
    }
    // 文件上传方法
    async uploadFile(endpoint, file, onProgress) {
        const formData = new FormData();
        formData.append('file', file);
        return new Promise((resolve, reject)=>{
            const xhr = new XMLHttpRequest();
            xhr.upload.addEventListener('progress', (event)=>{
                if (event.lengthComputable && onProgress) {
                    const progress = event.loaded / event.total * 100;
                    onProgress(progress);
                }
            });
            xhr.addEventListener('load', ()=>{
                if (xhr.status >= 200 && xhr.status < 300) {
                    try {
                        const response = JSON.parse(xhr.responseText);
                        resolve(response);
                    } catch (error) {
                        reject(new Error('Invalid response format'));
                    }
                } else {
                    reject(new Error(`Upload failed: ${xhr.statusText}`));
                }
            });
            xhr.addEventListener('error', ()=>{
                reject(new Error('Upload failed'));
            });
            xhr.open('POST', endpoint);
            // 添加认证头
            const token = this.getAuthToken();
            if (token) {
                xhr.setRequestHeader('Authorization', `Bearer ${token}`);
            }
            xhr.send(formData);
        });
    }
}
const httpClient = new HttpClient();
const _default = HttpClient;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9oZWlkc29mdC9Eb3dubG9hZHMvcmVzZWFyY2gvaXRzbS9pdHNtLWZyb250ZW5kL3NyYy9saWIvYXBpL2h0dHAtY2xpZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFQSV9CQVNFX1VSTCB9IGZyb20gJ0AvYXBwL2xpYi9hcGktY29uZmlnJztcbmltcG9ydCB7IHNlY3VyaXR5IH0gZnJvbSAnQC9saWIvc2VjdXJpdHknO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnQC9saWIvZW52JztcblxuLy8gUmVxdWVzdCBjb25maWd1cmF0aW9uIGludGVyZmFjZVxuZXhwb3J0IGludGVyZmFjZSBSZXF1ZXN0Q29uZmlnIHtcbiAgbWV0aG9kPzogJ0dFVCcgfCAnUE9TVCcgfCAnUFVUJyB8ICdERUxFVEUnIHwgJ1BBVENIJztcbiAgaGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gIGJvZHk/OiBCb2R5SW5pdCB8IG51bGw7XG4gIHRpbWVvdXQ/OiBudW1iZXI7XG59XG5cbi8vIEF4aW9zLWxpa2UgcmVxdWVzdCBjb25maWcgdXNlZCBieSBzb21lIGxlZ2FjeSBBUEkgbW9kdWxlc1xuZXhwb3J0IGludGVyZmFjZSBBeGlvc0xpa2VSZXF1ZXN0Q29uZmlnIHtcbiAgbWV0aG9kPzogJ0dFVCcgfCAnUE9TVCcgfCAnUFVUJyB8ICdERUxFVEUnIHwgJ1BBVENIJztcbiAgdXJsOiBzdHJpbmc7XG4gIHBhcmFtcz86IG9iamVjdDtcbiAgZGF0YT86IHVua25vd247XG4gIGhlYWRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICByZXNwb25zZVR5cGU/OiAnanNvbicgfCAnYmxvYic7XG59XG5cbi8vIEFQSSByZXNwb25zZSBpbnRlcmZhY2VcbmludGVyZmFjZSBBcGlSZXNwb25zZTxUPiB7XG4gIGNvZGU6IG51bWJlcjtcbiAgbWVzc2FnZTogc3RyaW5nO1xuICBkYXRhOiBUO1xufVxuXG5jbGFzcyBIdHRwQ2xpZW50IHtcbiAgcHJpdmF0ZSBiYXNlVVJMOiBzdHJpbmc7XG4gIHByaXZhdGUgdG9rZW46IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHRlbmFudElkOiBudW1iZXIgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSB0ZW5hbnRDb2RlOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSByZWFkb25seSB0aW1lb3V0OiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IoYmFzZVVSTDogc3RyaW5nID0gQVBJX0JBU0VfVVJMKSB7XG4gICAgdGhpcy5iYXNlVVJMID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBJX1VSTCB8fCBiYXNlVVJMO1xuICAgIHRoaXMudGltZW91dCA9IHBhcnNlSW50KHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FQSV9USU1FT1VUIHx8ICczMDAwMCcpO1xuICAgIC8vIEdldCB0b2tlbiBhbmQgdGVuYW50IElEIGZyb20gbG9jYWxTdG9yYWdlXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aGlzLnRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FjY2Vzc190b2tlbicpOyAvLyBDaGFuZ2VkIHRvIGFjY2Vzc190b2tlblxuICAgICAgY29uc3Qgc3RvcmVkVGVuYW50SWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF90ZW5hbnRfaWQnKTtcbiAgICAgIHRoaXMudGVuYW50SWQgPSBzdG9yZWRUZW5hbnRJZCA/IHBhcnNlSW50KHN0b3JlZFRlbmFudElkKSA6IG51bGw7XG4gICAgICB0aGlzLnRlbmFudENvZGUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF90ZW5hbnRfY29kZScpIHx8IG51bGw7XG4gICAgfVxuICB9XG5cbiAgc2V0VG9rZW4odG9rZW46IHN0cmluZykge1xuICAgIHRoaXMudG9rZW4gPSB0b2tlbjtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY2Nlc3NfdG9rZW4nLCB0b2tlbik7IC8vIENoYW5nZWQgdG8gYWNjZXNzX3Rva2VuXG4gICAgICAvLyDlkIzmraXmm7TmlrAgQ29va2ll77yM5pyJ5pWI5pyfIDE1IOWIhumSn1xuICAgICAgZG9jdW1lbnQuY29va2llID0gYGF1dGgtdG9rZW49JHt0b2tlbn07IHBhdGg9LzsgbWF4LWFnZT05MDA7IFNhbWVTaXRlPUxheGA7XG4gICAgfVxuICB9XG5cbiAgY2xlYXJUb2tlbigpIHtcbiAgICB0aGlzLnRva2VuID0gbnVsbDtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhY2Nlc3NfdG9rZW4nKTsgLy8gQ2hhbmdlZCB0byBhY2Nlc3NfdG9rZW5cbiAgICAgIC8vIOa4hemZpCBDb29raWVcbiAgICAgIGRvY3VtZW50LmNvb2tpZSA9ICdhdXRoLXRva2VuPTsgcGF0aD0vOyBleHBpcmVzPVRodSwgMDEgSmFuIDE5NzAgMDA6MDA6MDEgR01UOyc7XG4gICAgICBkb2N1bWVudC5jb29raWUgPSAncmVmcmVzaC10b2tlbj07IHBhdGg9LzsgZXhwaXJlcz1UaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAxIEdNVDsnO1xuICAgIH1cbiAgfVxuXG4gIHNldFRlbmFudElkKHRlbmFudElkOiBudW1iZXIgfCBudWxsKSB7XG4gICAgdGhpcy50ZW5hbnRJZCA9IHRlbmFudElkO1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgaWYgKHRlbmFudElkKSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjdXJyZW50X3RlbmFudF9pZCcsIHRlbmFudElkLnRvU3RyaW5nKCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2N1cnJlbnRfdGVuYW50X2lkJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgc2V0VGVuYW50Q29kZShjb2RlOiBzdHJpbmcgfCBudWxsKSB7XG4gICAgdGhpcy50ZW5hbnRDb2RlID0gY29kZTtcbiAgICBsb2dnZXIuaW5mbygnSHR0cENsaWVudC5zZXRUZW5hbnRDb2RlOicsIGNvZGUpO1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgaWYgKGNvZGUpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2N1cnJlbnRfdGVuYW50X2NvZGUnLCBjb2RlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdjdXJyZW50X3RlbmFudF9jb2RlJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IHRlbmFudCBjb2RlXG4gIGdldFRlbmFudENvZGUoKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMudGVuYW50Q29kZTtcbiAgfVxuXG4gIGdldFRlbmFudElkKCk6IG51bWJlciB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLnRlbmFudElkO1xuICB9XG5cbiAgZ2V0QXV0aFRva2VuKCk6IHN0cmluZyB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLnRva2VuO1xuICB9XG5cbiAgLy8gQmFja3dhcmQtY29tcGF0IGhlbHBlcnMgKHNvbWUgbGVnYWN5IGNvZGUgZXhwZWN0cyB0aGVzZSlcbiAgZ2V0VG9rZW4oKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXV0aFRva2VuKCk7XG4gIH1cblxuICBnZXRCYXNlVVJMKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuYmFzZVVSTDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0SGVhZGVycygpOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHtcbiAgICAvLyBTZXQgc2VjdXJlIHJlcXVlc3QgaGVhZGVyc1xuICAgIGNvbnN0IGNzcmZUb2tlbiA9IHNlY3VyaXR5LmNzcmYuZ2V0VG9rZW5Gcm9tTWV0YSgpO1xuICAgIGNvbnN0IGhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICAuLi5zZWN1cml0eS5uZXR3b3JrLmdldFNlY3VyZUhlYWRlcnMoY3NyZlRva2VuIHx8IHVuZGVmaW5lZCksXG4gICAgfTtcblxuICAgIC8vIER5bmFtaWNhbGx5IGdldCB0aGUgbGF0ZXN0IHRva2VuIGFuZCB0ZW5hbnRJZFxuICAgIGNvbnN0IGN1cnJlbnRUb2tlbiA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FjY2Vzc190b2tlbicpIDogdGhpcy50b2tlbjtcbiAgICBjb25zdCBjdXJyZW50VGVuYW50SWQgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjdXJyZW50X3RlbmFudF9pZCcpIDogdGhpcy50ZW5hbnRJZDtcblxuICAgIGlmIChjdXJyZW50VG9rZW4pIHtcbiAgICAgIGhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9IGBCZWFyZXIgJHtjdXJyZW50VG9rZW59YDtcbiAgICB9XG5cbiAgICBpZiAoY3VycmVudFRlbmFudElkKSB7XG4gICAgICBoZWFkZXJzWydYLVRlbmFudC1JRCddID0gY3VycmVudFRlbmFudElkLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIGNvbnN0IGN1cnJlbnRUZW5hbnRDb2RlID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF90ZW5hbnRfY29kZScpIDogdGhpcy50ZW5hbnRDb2RlO1xuICAgIGlmIChjdXJyZW50VGVuYW50Q29kZSkge1xuICAgICAgaGVhZGVyc1snWC1UZW5hbnQtQ29kZSddID0gY3VycmVudFRlbmFudENvZGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGhlYWRlcnM7XG4gIH1cblxuICAvLyBJbmRlcGVuZGVudCB0b2tlbiByZWZyZXNoIG1ldGhvZCB0byBhdm9pZCBjaXJjdWxhciBkZXBlbmRlbmNpZXNcbiAgcHJpdmF0ZSBhc3luYyByZWZyZXNoVG9rZW5JbnRlcm5hbCgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCByZWZyZXNoVG9rZW4gPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyZWZyZXNoX3Rva2VuJykgOiBudWxsO1xuICAgIGlmICghcmVmcmVzaFRva2VuKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5iYXNlVVJMfS9hcGkvdjEvcmVmcmVzaC10b2tlbmAsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgcmVmcmVzaF90b2tlbjogcmVmcmVzaFRva2VuLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgaWYgKGRhdGEuY29kZSA9PT0gMCkge1xuICAgICAgICAgIC8vIFVwZGF0ZSBhY2Nlc3MgdG9rZW5cbiAgICAgICAgICB0aGlzLnNldFRva2VuKGRhdGEuZGF0YS5hY2Nlc3NfdG9rZW4pO1xuICAgICAgICAgIC8vIEFsc28gdXBkYXRlIGluc3RhbmNlIHZhcmlhYmxlXG4gICAgICAgICAgdGhpcy50b2tlbiA9IGRhdGEuZGF0YS5hY2Nlc3NfdG9rZW47XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdUb2tlbiByZWZyZXNoIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLy8gQ29yZSByZXF1ZXN0IG1ldGhvZCB1c2luZyBmZXRjaCBBUEkgKGludGVybmFsKVxuICBwcml2YXRlIGFzeW5jIHJlcXVlc3RJbnRlcm5hbDxUPihlbmRwb2ludDogc3RyaW5nLCBjb25maWc6IFJlcXVlc3RDb25maWcpOiBQcm9taXNlPFQ+IHtcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVUkx9JHtlbmRwb2ludH1gO1xuICAgIGNvbnN0IGhlYWRlcnMgPSB0aGlzLmdldEhlYWRlcnMoKTtcbiAgICBjb25zdCByZXF1ZXN0Q29uZmlnOiBSZXF1ZXN0SW5pdCA9IHtcbiAgICAgIG1ldGhvZDogY29uZmlnLm1ldGhvZCxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgLi4uaGVhZGVycyxcbiAgICAgICAgLi4uY29uZmlnLmhlYWRlcnMsXG4gICAgICB9LFxuICAgICAgYm9keTogY29uZmlnLmJvZHksXG4gICAgfTtcblxuICAgIGxvZ2dlci5kZWJ1ZygnSFRUUCBDbGllbnQgUmVxdWVzdDonLCB7XG4gICAgICB1cmwsXG4gICAgICBtZXRob2Q6IGNvbmZpZy5tZXRob2QsXG4gICAgICBoZWFkZXJzLFxuICAgICAgYm9keTogY29uZmlnLmJvZHlcbiAgICB9KTtcblxuICAgIC8vIOWcqOW8gOWPkeaooeW8j+S4i++8jOWmguaenOWQjuerr+acjeWKoeS4jeWPr+eUqO+8jOS9v+eUqOaooeaLn+aVsOaNrlxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyAmJiB0aGlzLmJhc2VVUkwuaW5jbHVkZXMoJ2xvY2FsaG9zdCcpKSB7XG4gICAgICBsb2dnZXIud2Fybign5byA5Y+R5qih5byP77ya5q2j5Zyo6L+e5o6l5Yiw5ZCO56uv5pyN5Yqh77yM5aaC5p6c5ZCO56uv5pyN5Yqh5pyq6L+Q6KGM77yM5bCG5pi+56S66ZSZ6K+vJyk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgICBjb25zdCB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgdGhpcy50aW1lb3V0KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgLi4ucmVxdWVzdENvbmZpZyxcbiAgICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgIFxuICAgICAgbG9nZ2VyLmRlYnVnKCdIVFRQIENsaWVudCBSZXNwb25zZTonLCB7XG4gICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICBzdGF0dXNUZXh0OiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICBoZWFkZXJzOiByZXNwb25zZS5oZWFkZXJzID8gT2JqZWN0LmZyb21FbnRyaWVzKHJlc3BvbnNlLmhlYWRlcnMuZW50cmllcygpKSA6IHt9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gSWYgNDAxIGVycm9yLCB0cnkgdG8gcmVmcmVzaCB0b2tlblxuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgIGNvbnN0IHJlZnJlc2hTdWNjZXNzID0gYXdhaXQgdGhpcy5yZWZyZXNoVG9rZW5JbnRlcm5hbCgpO1xuICAgICAgICBpZiAocmVmcmVzaFN1Y2Nlc3MpIHtcbiAgICAgICAgICAvLyBSZXRyeSBvcmlnaW5hbCByZXF1ZXN0XG4gICAgICAgICAgY29uc3QgcmV0cnlDb25maWc6IFJlcXVlc3RJbml0ID0ge1xuICAgICAgICAgICAgLi4ucmVxdWVzdENvbmZpZyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgLi4udGhpcy5nZXRIZWFkZXJzKCksXG4gICAgICAgICAgICAgIC4uLmNvbmZpZy5oZWFkZXJzLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9O1xuICAgICAgICAgIGNvbnN0IHJldHJ5UmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHJldHJ5Q29uZmlnKTtcbiAgICAgICAgICBpZiAoIXJldHJ5UmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIGNvbnN0IHJpZCA9IHJldHJ5UmVzcG9uc2UuaGVhZGVycy5nZXQoJ1gtUmVxdWVzdC1JZCcpIHx8ICcnO1xuICAgICAgICAgICAgY29uc3Qgc3VmZml4ID0gcmlkID8gYCBbUklEOiAke3JpZH1dYCA6ICcnO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBzdGF0dXM6ICR7cmV0cnlSZXNwb25zZS5zdGF0dXN9JHtzdWZmaXh9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHJldHJ5RGF0YSA9IGF3YWl0IHJldHJ5UmVzcG9uc2UuanNvbigpIGFzIEFwaVJlc3BvbnNlPFQ+O1xuICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnSFRUUCBDbGllbnQgUmV0cnkgUmVzcG9uc2UgRGF0YTonLCByZXRyeURhdGEpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIENoZWNrIHJlc3BvbnNlIGNvZGVcbiAgICAgICAgICBpZiAocmV0cnlEYXRhLmNvZGUgIT09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHJpZCA9IHJldHJ5UmVzcG9uc2UuaGVhZGVycy5nZXQoJ1gtUmVxdWVzdC1JZCcpIHx8ICcnO1xuICAgICAgICAgICAgY29uc3Qgc3VmZml4ID0gcmlkID8gYCBbUklEOiAke3JpZH1dYCA6ICcnO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKChyZXRyeURhdGEubWVzc2FnZSB8fCAnUmVxdWVzdCBmYWlsZWQnKSArIHN1ZmZpeCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiByZXRyeURhdGEuZGF0YTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBSZWZyZXNoIGZhaWxlZCwgY2xlYXIgdG9rZW4gYW5kIHJlZGlyZWN0IHRvIGxvZ2luXG4gICAgICAgICAgdGhpcy5jbGVhclRva2VuKCk7XG4gICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgncmVmcmVzaF90b2tlbicpO1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL2xvZ2luJztcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBdXRoZW50aWNhdGlvbiBmYWlsZWQnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IHJpZCA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdYLVJlcXVlc3QtSWQnKSB8fCAnJztcbiAgICAgICAgY29uc3Qgc3VmZml4ID0gcmlkID8gYCBbUklEOiAke3JpZH1dYCA6ICcnO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9JHtzdWZmaXh9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKSBhcyBBcGlSZXNwb25zZTxUPjtcbiAgICAgIGxvZ2dlci5kZWJ1ZygnSFRUUCBDbGllbnQgUmF3IFJlc3BvbnNlIERhdGE6JywgcmVzcG9uc2VEYXRhKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgcmVzcG9uc2UgY29kZVxuICAgICAgaWYgKHJlc3BvbnNlRGF0YS5jb2RlICE9PSAwKSB7XG4gICAgICAgIGNvbnN0IHJpZCA9IChyZXNwb25zZS5oZWFkZXJzICYmIHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdYLVJlcXVlc3QtSWQnKSkgfHwgJyc7XG4gICAgICAgIGNvbnN0IHN1ZmZpeCA9IHJpZCA/IGAgW1JJRDogJHtyaWR9XWAgOiAnJztcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKChyZXNwb25zZURhdGEubWVzc2FnZSB8fCAnUmVxdWVzdCBmYWlsZWQnKSArIHN1ZmZpeCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiByZXNwb25zZURhdGEuZGF0YTtcbiAgICB9IGNhdGNoIChlcnJvcjogdW5rbm93bikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdSZXF1ZXN0IGZhaWxlZDonLCBlcnJvcik7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfor7fmsYLotoXml7bvvIzor7fnqI3lkI7ph43or5UnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnZmV0Y2gnKSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcign5peg5rOV6L+e5o6l5Yiw5pyN5Yqh5Zmo77yM6K+35qOA5p+l572R57uc6L+e5o6l5ZKM5ZCO56uv5pyN5Yqh5piv5ZCm6L+Q6KGMJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+acquefpemUmeivr+WPkeeUnycpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVbmlmaWVkIHJlcXVlc3QgbWV0aG9kLlxuICAgKiBTdXBwb3J0czpcbiAgICogLSByZXF1ZXN0KCcvcGF0aCcsIHsgbWV0aG9kLCBoZWFkZXJzLCBib2R5IH0pXG4gICAqIC0gcmVxdWVzdCh7IG1ldGhvZCwgdXJsLCBkYXRhLCBoZWFkZXJzLCByZXNwb25zZVR5cGUgfSlcbiAgICovXG4gIGFzeW5jIHJlcXVlc3Q8VCA9IGFueT4oZW5kcG9pbnQ6IHN0cmluZywgY29uZmlnPzogUGFydGlhbDxSZXF1ZXN0Q29uZmlnPik6IFByb21pc2U8VD47XG4gIGFzeW5jIHJlcXVlc3Q8VCA9IGFueT4oY29uZmlnOiBBeGlvc0xpa2VSZXF1ZXN0Q29uZmlnKTogUHJvbWlzZTxUPjtcbiAgYXN5bmMgcmVxdWVzdDxUID0gYW55PihcbiAgICBhcmcxOiBzdHJpbmcgfCBBeGlvc0xpa2VSZXF1ZXN0Q29uZmlnLFxuICAgIGFyZzI/OiBQYXJ0aWFsPFJlcXVlc3RDb25maWc+XG4gICk6IFByb21pc2U8VD4ge1xuICAgIC8vIEF4aW9zLWxpa2Ugc3R5bGU6IHJlcXVlc3QoeyB1cmwsIG1ldGhvZCwgZGF0YSwgaGVhZGVycywgcmVzcG9uc2VUeXBlIH0pXG4gICAgaWYgKHR5cGVvZiBhcmcxID09PSAnb2JqZWN0JyAmJiBhcmcxICYmICd1cmwnIGluIGFyZzEpIHtcbiAgICAgIGNvbnN0IGNmZyA9IGFyZzEgYXMgQXhpb3NMaWtlUmVxdWVzdENvbmZpZztcbiAgICAgIGNvbnN0IG1ldGhvZCA9IGNmZy5tZXRob2QgfHwgJ0dFVCc7XG4gICAgICBsZXQgZW5kcG9pbnQgPSBjZmcudXJsO1xuICAgICAgaWYgKGNmZy5wYXJhbXMpIHtcbiAgICAgICAgY29uc3QgcXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gICAgICAgIE9iamVjdC5lbnRyaWVzKGNmZy5wYXJhbXMgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pLmZvckVhY2goKFtrLCB2XSkgPT4ge1xuICAgICAgICAgIGlmICh2ICE9PSB1bmRlZmluZWQgJiYgdiAhPT0gbnVsbCkgcXMuYXBwZW5kKGssIFN0cmluZyh2KSk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBxID0gcXMudG9TdHJpbmcoKTtcbiAgICAgICAgaWYgKHEpIGVuZHBvaW50ICs9IChlbmRwb2ludC5pbmNsdWRlcygnPycpID8gJyYnIDogJz8nKSArIHE7XG4gICAgICB9XG5cbiAgICAgIGxldCBib2R5OiBCb2R5SW5pdCB8IG51bGwgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgICBpZiAoY2ZnLmRhdGEgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAoY2ZnLmRhdGEgaW5zdGFuY2VvZiBGb3JtRGF0YSkgYm9keSA9IGNmZy5kYXRhO1xuICAgICAgICBlbHNlIGJvZHkgPSBKU09OLnN0cmluZ2lmeShjZmcuZGF0YSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPVxuICAgICAgICBjZmcucmVzcG9uc2VUeXBlID09PSAnYmxvYidcbiAgICAgICAgICA/IC8vIGJsb2IgcGFzc3Rocm91Z2hcbiAgICAgICAgICAgIGF3YWl0IChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHVybCA9IGAke3RoaXMuYmFzZVVSTH0ke2VuZHBvaW50fWA7XG4gICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7IC4uLnRoaXMuZ2V0SGVhZGVycygpLCAuLi4oY2ZnLmhlYWRlcnMgfHwge30pIH07XG4gICAgICAgICAgICAgIGlmIChib2R5IGluc3RhbmNlb2YgRm9ybURhdGEpIGRlbGV0ZSAoaGVhZGVycyBhcyBhbnkpWydDb250ZW50LVR5cGUnXTtcbiAgICAgICAgICAgICAgZWxzZSBoZWFkZXJzWydDb250ZW50LVR5cGUnXSA9IGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddIHx8ICdhcHBsaWNhdGlvbi9qc29uJztcbiAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godXJsLCB7IG1ldGhvZCwgaGVhZGVycywgYm9keTogYm9keSBhcyBhbnkgfSk7XG4gICAgICAgICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICAgICAgICByZXR1cm4gKGF3YWl0IHJlcy5ibG9iKCkpIGFzIGFueTtcbiAgICAgICAgICAgIH0pKClcbiAgICAgICAgICA6IGF3YWl0IHRoaXMucmVxdWVzdEludGVybmFsPFQ+KGVuZHBvaW50LCB7XG4gICAgICAgICAgICAgIG1ldGhvZCxcbiAgICAgICAgICAgICAgaGVhZGVyczogY2ZnLmhlYWRlcnMsXG4gICAgICAgICAgICAgIGJvZHk6IGJvZHkgYXMgYW55LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBkYXRhIGFzIFQ7XG4gICAgfVxuXG4gICAgLy8gRmV0Y2gtbGlrZSBzdHlsZTogcmVxdWVzdCgnL3BhdGgnLCB7IC4uLiB9KVxuICAgIGNvbnN0IGVuZHBvaW50ID0gYXJnMSBhcyBzdHJpbmc7XG4gICAgY29uc3QgY2ZnID0gYXJnMiB8fCB7fTtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0SW50ZXJuYWw8VD4oZW5kcG9pbnQsIHtcbiAgICAgIG1ldGhvZDogY2ZnLm1ldGhvZCB8fCAnR0VUJyxcbiAgICAgIGhlYWRlcnM6IGNmZy5oZWFkZXJzLFxuICAgICAgYm9keTogY2ZnLmJvZHkgYXMgYW55LFxuICAgICAgdGltZW91dDogY2ZnLnRpbWVvdXQsXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBnZXQ8VD4oZW5kcG9pbnQ6IHN0cmluZywgcGFyYW1zPzogb2JqZWN0KTogUHJvbWlzZTxUPiB7XG4gICAgbGV0IHVybCA9IGVuZHBvaW50O1xuICAgIGlmIChwYXJhbXMpIHtcbiAgICAgIGNvbnN0IHNlYXJjaFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgICAgIE9iamVjdC5lbnRyaWVzKHBhcmFtcyBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgc2VhcmNoUGFyYW1zLmFwcGVuZChrZXksIFN0cmluZyh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHVybCArPSBgPyR7c2VhcmNoUGFyYW1zLnRvU3RyaW5nKCl9YDtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdEludGVybmFsPFQ+KHVybCwge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHBvc3Q8VCA9IGFueT4oXG4gICAgZW5kcG9pbnQ6IHN0cmluZyxcbiAgICBkYXRhPzogdW5rbm93bixcbiAgICBjb25maWc/OiB7XG4gICAgICBvblVwbG9hZFByb2dyZXNzPzogKHByb2dyZXNzOiBudW1iZXIpID0+IHZvaWQ7XG4gICAgICBoZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgICAgIHJlc3BvbnNlVHlwZT86ICdqc29uJyB8ICdibG9iJztcbiAgICB9XG4gICk6IFByb21pc2U8VD4ge1xuICAgIC8vIOWmguaenOaYryBGb3JtRGF0Ye+8jOebtOaOpeS8oOmAku+8jOS4jei/m+ihjCBKU09OLnN0cmluZ2lmeVxuICAgIGlmIChkYXRhIGluc3RhbmNlb2YgRm9ybURhdGEpIHtcbiAgICAgIGNvbnN0IHVybCA9IGAke3RoaXMuYmFzZVVSTH0ke2VuZHBvaW50fWA7XG4gICAgICBjb25zdCBoZWFkZXJzID0gdGhpcy5nZXRIZWFkZXJzKCk7XG4gICAgICAvLyBGb3JtRGF0YSDkuIrkvKDml7bvvIzkuI3opoHorr7nva4gQ29udGVudC1UeXBl77yM6K6p5rWP6KeI5Zmo6Ieq5Yqo6K6+572u77yI5YyF5ZCrIGJvdW5kYXJ577yJXG4gICAgICBkZWxldGUgaGVhZGVyc1snQ29udGVudC1UeXBlJ107XG4gICAgICBcbiAgICAgIC8vIOWmguaenOaUr+aMgeS4iuS8oOi/m+W6pu+8jOS9v+eUqCBYTUxIdHRwUmVxdWVzdFxuICAgICAgaWYgKGNvbmZpZz8ub25VcGxvYWRQcm9ncmVzcykge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8VD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICAgIFxuICAgICAgICAgIHhoci51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldmVudC5sZW5ndGhDb21wdXRhYmxlICYmIGNvbmZpZy5vblVwbG9hZFByb2dyZXNzKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzID0gTWF0aC5yb3VuZCgoZXZlbnQubG9hZGVkICogMTAwKSAvIGV2ZW50LnRvdGFsKTtcbiAgICAgICAgICAgICAgY29uZmlnLm9uVXBsb2FkUHJvZ3Jlc3MocHJvZ3Jlc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPCAzMDApIHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCkgYXMgQXBpUmVzcG9uc2U8VD47XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmNvZGUgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IocmVzcG9uc2UubWVzc2FnZSB8fCAnUmVxdWVzdCBmYWlsZWQnKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSByZXNwb25zZScpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihgSFRUUCBlcnJvciEgc3RhdHVzOiAke3hoci5zdGF0dXN9YCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsICgpID0+IHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgeGhyLm9wZW4oJ1BPU1QnLCB1cmwpO1xuICAgICAgICAgIE9iamVjdC5lbnRyaWVzKGhlYWRlcnMpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICAgICAgaWYgKGtleSAhPT0gJ0NvbnRlbnQtVHlwZScpIHtcbiAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgeGhyLnNlbmQoZGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDkuI3mlK/mjIHov5vluqbml7bvvIzkvb/nlKggZmV0Y2hcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgLi4uaGVhZGVycyxcbiAgICAgICAgICAuLi4oY29uZmlnPy5oZWFkZXJzIHx8IHt9KSxcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogZGF0YSxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGNvbmZpZz8ucmVzcG9uc2VUeXBlID09PSAnYmxvYicpIHtcbiAgICAgICAgcmV0dXJuIChhd2FpdCByZXNwb25zZS5ibG9iKCkpIGFzIGFueTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzcG9uc2VEYXRhID0gKGF3YWl0IHJlc3BvbnNlLmpzb24oKSkgYXMgQXBpUmVzcG9uc2U8VD47XG4gICAgICBpZiAocmVzcG9uc2VEYXRhLmNvZGUgIT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3BvbnNlRGF0YS5tZXNzYWdlIHx8ICdSZXF1ZXN0IGZhaWxlZCcpO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gcmVzcG9uc2VEYXRhLmRhdGE7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0aGlzLnJlcXVlc3RJbnRlcm5hbDxUPihlbmRwb2ludCwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBib2R5OiBkYXRhID8gSlNPTi5zdHJpbmdpZnkoZGF0YSkgOiB1bmRlZmluZWQsXG4gICAgICBoZWFkZXJzOiBjb25maWc/LmhlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBwdXQ8VD4oZW5kcG9pbnQ6IHN0cmluZywgZGF0YT86IHVua25vd24pOiBQcm9taXNlPFQ+IHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0SW50ZXJuYWw8VD4oZW5kcG9pbnQsIHtcbiAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICBib2R5OiBkYXRhID8gSlNPTi5zdHJpbmdpZnkoZGF0YSkgOiB1bmRlZmluZWQsXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBwYXRjaDxUPihlbmRwb2ludDogc3RyaW5nLCBkYXRhPzogdW5rbm93bik6IFByb21pc2U8VD4ge1xuICAgIHJldHVybiB0aGlzLnJlcXVlc3RJbnRlcm5hbDxUPihlbmRwb2ludCwge1xuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgYm9keTogZGF0YSA/IEpTT04uc3RyaW5naWZ5KGRhdGEpIDogdW5kZWZpbmVkLFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlPFQgPSBhbnk+KGVuZHBvaW50OiBzdHJpbmcsIGRhdGE/OiB1bmtub3duKTogUHJvbWlzZTxUPiB7XG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdEludGVybmFsPFQ+KGVuZHBvaW50LCB7XG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgYm9keTogZGF0YSA/IEpTT04uc3RyaW5naWZ5KGRhdGEpIDogdW5kZWZpbmVkLFxuICAgIH0pO1xuICB9XG5cbiAgLy8g5YiG6aG15p+l6K+i5pa55rOVXG4gIGFzeW5jIGdldFBhZ2luYXRlZDxUPihcbiAgICBlbmRwb2ludDogc3RyaW5nLCBcbiAgICBwYXJhbXM/OiB7XG4gICAgICBwYWdlPzogbnVtYmVyO1xuICAgICAgcGFnZVNpemU/OiBudW1iZXI7XG4gICAgICBzb3J0Qnk/OiBzdHJpbmc7XG4gICAgICBzb3J0T3JkZXI/OiAnYXNjJyB8ICdkZXNjJztcbiAgICAgIGZpbHRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICAgIH1cbiAgKTogUHJvbWlzZTx7XG4gICAgZGF0YTogVFtdO1xuICAgIHRvdGFsOiBudW1iZXI7XG4gICAgcGFnZTogbnVtYmVyO1xuICAgIHBhZ2VTaXplOiBudW1iZXI7XG4gICAgdG90YWxQYWdlczogbnVtYmVyO1xuICB9PiB7XG4gICAgY29uc3QgcXVlcnlQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gICAgaWYgKHBhcmFtcykge1xuICAgICAgT2JqZWN0LmVudHJpZXMocGFyYW1zKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICBpZiAoa2V5ID09PSAnZmlsdGVycycgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgT2JqZWN0LmVudHJpZXModmFsdWUpLmZvckVhY2goKFtmaWx0ZXJLZXksIGZpbHRlclZhbHVlXSkgPT4ge1xuICAgICAgICAgICAgICBpZiAoZmlsdGVyVmFsdWUgIT09IHVuZGVmaW5lZCAmJiBmaWx0ZXJWYWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW1zLmFwcGVuZChgZmlsdGVyc1ske2ZpbHRlcktleX1dYCwgU3RyaW5nKGZpbHRlclZhbHVlKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBxdWVyeVBhcmFtcy5hcHBlbmQoa2V5LCBTdHJpbmcodmFsdWUpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCB1cmwgPSBxdWVyeVBhcmFtcy50b1N0cmluZygpIFxuICAgICAgPyBgJHtlbmRwb2ludH0/JHtxdWVyeVBhcmFtcy50b1N0cmluZygpfWAgXG4gICAgICA6IGVuZHBvaW50O1xuICAgICAgXG4gICAgcmV0dXJuIHRoaXMuZ2V0KHVybCk7XG4gIH1cblxuICAvLyDmibnph4/mk43kvZzmlrnms5VcbiAgYXN5bmMgYmF0Y2hPcGVyYXRpb248VD4oXG4gICAgZW5kcG9pbnQ6IHN0cmluZywgXG4gICAgb3BlcmF0aW9uOiBzdHJpbmcsIFxuICAgIGRhdGE6IGFueVtdXG4gICk6IFByb21pc2U8VFtdPiB7XG4gICAgcmV0dXJuIHRoaXMucG9zdDxUW10+KGVuZHBvaW50LCB7XG4gICAgICBvcGVyYXRpb24sXG4gICAgICBkYXRhXG4gICAgfSk7XG4gIH1cblxuICAvLyDmlofku7bkuIrkvKDmlrnms5VcbiAgYXN5bmMgdXBsb2FkRmlsZShcbiAgICBlbmRwb2ludDogc3RyaW5nLCBcbiAgICBmaWxlOiBGaWxlLCBcbiAgICBvblByb2dyZXNzPzogKHByb2dyZXNzOiBudW1iZXIpID0+IHZvaWRcbiAgKTogUHJvbWlzZTx7XG4gICAgdXJsOiBzdHJpbmc7XG4gICAgZmlsZW5hbWU6IHN0cmluZztcbiAgICBzaXplOiBudW1iZXI7XG4gIH0+IHtcbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIGZpbGUpO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgXG4gICAgICB4aHIudXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgKGV2ZW50KSA9PiB7XG4gICAgICAgIGlmIChldmVudC5sZW5ndGhDb21wdXRhYmxlICYmIG9uUHJvZ3Jlc3MpIHtcbiAgICAgICAgICBjb25zdCBwcm9ncmVzcyA9IChldmVudC5sb2FkZWQgLyBldmVudC50b3RhbCkgKiAxMDA7XG4gICAgICAgICAgb25Qcm9ncmVzcyhwcm9ncmVzcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICAgICAgaWYgKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPCAzMDApIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ0ludmFsaWQgcmVzcG9uc2UgZm9ybWF0JykpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZWplY3QobmV3IEVycm9yKGBVcGxvYWQgZmFpbGVkOiAke3hoci5zdGF0dXNUZXh0fWApKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHhoci5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsICgpID0+IHtcbiAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignVXBsb2FkIGZhaWxlZCcpKTtcbiAgICAgIH0pO1xuXG4gICAgICB4aHIub3BlbignUE9TVCcsIGVuZHBvaW50KTtcbiAgICAgIFxuICAgICAgLy8g5re75Yqg6K6k6K+B5aS0XG4gICAgICBjb25zdCB0b2tlbiA9IHRoaXMuZ2V0QXV0aFRva2VuKCk7XG4gICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YCk7XG4gICAgICB9XG5cbiAgICAgIHhoci5zZW5kKGZvcm1EYXRhKTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgaHR0cENsaWVudCA9IG5ldyBIdHRwQ2xpZW50KCk7XG5leHBvcnQgZGVmYXVsdCBIdHRwQ2xpZW50O1xuIl0sIm5hbWVzIjpbImh0dHBDbGllbnQiLCJIdHRwQ2xpZW50IiwiY29uc3RydWN0b3IiLCJiYXNlVVJMIiwiQVBJX0JBU0VfVVJMIiwidG9rZW4iLCJ0ZW5hbnRJZCIsInRlbmFudENvZGUiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfQVBJX1VSTCIsInRpbWVvdXQiLCJwYXJzZUludCIsIk5FWFRfUFVCTElDX0FQSV9USU1FT1VUIiwid2luZG93IiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInN0b3JlZFRlbmFudElkIiwic2V0VG9rZW4iLCJzZXRJdGVtIiwiZG9jdW1lbnQiLCJjb29raWUiLCJjbGVhclRva2VuIiwicmVtb3ZlSXRlbSIsInNldFRlbmFudElkIiwidG9TdHJpbmciLCJzZXRUZW5hbnRDb2RlIiwiY29kZSIsImxvZ2dlciIsImluZm8iLCJnZXRUZW5hbnRDb2RlIiwiZ2V0VGVuYW50SWQiLCJnZXRBdXRoVG9rZW4iLCJnZXRUb2tlbiIsImdldEJhc2VVUkwiLCJnZXRIZWFkZXJzIiwiY3NyZlRva2VuIiwic2VjdXJpdHkiLCJjc3JmIiwiZ2V0VG9rZW5Gcm9tTWV0YSIsImhlYWRlcnMiLCJuZXR3b3JrIiwiZ2V0U2VjdXJlSGVhZGVycyIsInVuZGVmaW5lZCIsImN1cnJlbnRUb2tlbiIsImN1cnJlbnRUZW5hbnRJZCIsImN1cnJlbnRUZW5hbnRDb2RlIiwicmVmcmVzaFRva2VuSW50ZXJuYWwiLCJyZWZyZXNoVG9rZW4iLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZWZyZXNoX3Rva2VuIiwib2siLCJkYXRhIiwianNvbiIsImFjY2Vzc190b2tlbiIsImVycm9yIiwicmVxdWVzdEludGVybmFsIiwiZW5kcG9pbnQiLCJjb25maWciLCJ1cmwiLCJyZXF1ZXN0Q29uZmlnIiwiZGVidWciLCJOT0RFX0VOViIsImluY2x1ZGVzIiwid2FybiIsImNvbnRyb2xsZXIiLCJBYm9ydENvbnRyb2xsZXIiLCJ0aW1lb3V0SWQiLCJzZXRUaW1lb3V0IiwiYWJvcnQiLCJzaWduYWwiLCJjbGVhclRpbWVvdXQiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiT2JqZWN0IiwiZnJvbUVudHJpZXMiLCJlbnRyaWVzIiwicmVmcmVzaFN1Y2Nlc3MiLCJyZXRyeUNvbmZpZyIsInJldHJ5UmVzcG9uc2UiLCJyaWQiLCJnZXQiLCJzdWZmaXgiLCJFcnJvciIsInJldHJ5RGF0YSIsIm1lc3NhZ2UiLCJsb2NhdGlvbiIsImhyZWYiLCJyZXNwb25zZURhdGEiLCJuYW1lIiwicmVxdWVzdCIsImFyZzEiLCJhcmcyIiwiY2ZnIiwicGFyYW1zIiwicXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJmb3JFYWNoIiwiayIsInYiLCJhcHBlbmQiLCJTdHJpbmciLCJxIiwiRm9ybURhdGEiLCJyZXNwb25zZVR5cGUiLCJyZXMiLCJibG9iIiwic2VhcmNoUGFyYW1zIiwia2V5IiwidmFsdWUiLCJwb3N0Iiwib25VcGxvYWRQcm9ncmVzcyIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJ1cGxvYWQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJsZW5ndGhDb21wdXRhYmxlIiwicHJvZ3Jlc3MiLCJNYXRoIiwicm91bmQiLCJsb2FkZWQiLCJ0b3RhbCIsInBhcnNlIiwicmVzcG9uc2VUZXh0Iiwib3BlbiIsInNldFJlcXVlc3RIZWFkZXIiLCJzZW5kIiwicHV0IiwicGF0Y2giLCJkZWxldGUiLCJnZXRQYWdpbmF0ZWQiLCJxdWVyeVBhcmFtcyIsImZpbHRlcktleSIsImZpbHRlclZhbHVlIiwiYmF0Y2hPcGVyYXRpb24iLCJvcGVyYXRpb24iLCJ1cGxvYWRGaWxlIiwiZmlsZSIsIm9uUHJvZ3Jlc3MiLCJmb3JtRGF0YSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7SUE0a0JBLE9BQTBCO2VBQTFCOztJQURhQSxVQUFVO2VBQVZBOzs7MkJBM2tCZ0I7MEJBQ0o7cUJBQ0Y7QUEyQnZCLE1BQU1DO0lBT0pDLFlBQVlDLFVBQWtCQyx1QkFBWSxDQUFFO2FBTHBDQyxRQUF1QjthQUN2QkMsV0FBMEI7YUFDMUJDLGFBQTRCO1FBSWxDLElBQUksQ0FBQ0osT0FBTyxHQUFHSyxRQUFRQyxHQUFHLENBQUNDLG1CQUFtQixJQUFJUDtRQUNsRCxJQUFJLENBQUNRLE9BQU8sR0FBR0MsU0FBU0osUUFBUUMsR0FBRyxDQUFDSSx1QkFBdUIsSUFBSTtRQUMvRCw0Q0FBNEM7UUFDNUMsSUFBSSxPQUFPQyxXQUFXLGFBQWE7WUFDakMsSUFBSSxDQUFDVCxLQUFLLEdBQUdVLGFBQWFDLE9BQU8sQ0FBQyxpQkFBaUIsMEJBQTBCO1lBQzdFLE1BQU1DLGlCQUFpQkYsYUFBYUMsT0FBTyxDQUFDO1lBQzVDLElBQUksQ0FBQ1YsUUFBUSxHQUFHVyxpQkFBaUJMLFNBQVNLLGtCQUFrQjtZQUM1RCxJQUFJLENBQUNWLFVBQVUsR0FBR1EsYUFBYUMsT0FBTyxDQUFDLDBCQUEwQjtRQUNuRTtJQUNGO0lBRUFFLFNBQVNiLEtBQWEsRUFBRTtRQUN0QixJQUFJLENBQUNBLEtBQUssR0FBR0E7UUFDYixJQUFJLE9BQU9TLFdBQVcsYUFBYTtZQUNqQ0MsYUFBYUksT0FBTyxDQUFDLGdCQUFnQmQsUUFBUSwwQkFBMEI7WUFDdkUsd0JBQXdCO1lBQ3hCZSxTQUFTQyxNQUFNLEdBQUcsQ0FBQyxXQUFXLEVBQUVoQixNQUFN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