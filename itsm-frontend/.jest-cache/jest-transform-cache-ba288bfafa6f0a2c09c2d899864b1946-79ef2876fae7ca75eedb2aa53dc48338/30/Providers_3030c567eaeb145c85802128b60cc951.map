{"version":3,"names":["Providers","children","cov_za9b0lx5l","f","login","logout","setLoading","s","_authstore","useAuthStore","_react","useEffect","initAuth","isAuthenticated","_authservice","AuthService","b","user","getCurrentUser","token","getToken","error","console","_jsxruntime","jsxs","Fragment","jsx","_NotificationContainer","NotificationContainer"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/components/providers/Providers.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { AuthService } from '@/lib/services/auth-service';\nimport { useAuthStore } from '@/lib/store/auth-store';\nimport { NotificationContainer } from '@/components/ui/NotificationContainer';\n\n/**\n * 全局提供者组件\n * 负责初始化应用状态和提供全局上下文\n */\nexport function Providers({ children }: { children: React.ReactNode }) {\n  const { login, logout, setLoading } = useAuthStore();\n\n  // 初始化认证状态\n  useEffect(() => {\n    const initAuth = async () => {\n      setLoading(true);\n\n      try {\n        // 检查是否有有效的认证状态\n        const isAuthenticated = AuthService.isAuthenticated();\n\n        if (isAuthenticated) {\n          // 获取当前用户信息\n          const user = await AuthService.getCurrentUser();\n          const token = AuthService.getToken();\n\n          if (user && token) {\n            login(user, token);\n          }\n        }\n      } catch (error) {\n        console.error('Failed to initialize auth:', error);\n        // 清除可能损坏的认证状态\n        AuthService.logout();\n        logout();\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    initAuth();\n  }, [login, logout, setLoading]);\n\n  return (\n    <>\n      {children}\n      <NotificationContainer />\n    </>\n  );\n}\n"],"mappings":"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","ignoreList":[]}