{"version":3,"names":["cov_2gv0rhdy","actualCoverage","s","TicketNotificationApi","getTicketNotifications","ticketId","f","_httpclient","httpClient","get","sendTicketNotification","data","post","getUserNotifications","params","markNotificationRead","notificationId","put","markAllNotificationsRead","getNotificationPreferences","userId","updateNotificationPreferences"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/lib/api/ticket-notification-api.ts"],"sourcesContent":["import { httpClient } from './http-client';\n\n// 工单通知类型定义\nexport interface TicketNotification {\n  id: number;\n  ticket_id: number;\n  user_id: number;\n  type: 'created' | 'assigned' | 'status_changed' | 'commented' | 'sla_warning' | 'resolved' | 'closed';\n  channel: 'email' | 'in_app' | 'sms';\n  content: string;\n  sent_at?: string;\n  read_at?: string;\n  status: 'pending' | 'sent' | 'read';\n  created_at: string;\n  user?: {\n    id: number;\n    username: string;\n    name: string;\n    email: string;\n    role?: string;\n    department?: string;\n    tenant_id?: number;\n  };\n}\n\nexport interface ListTicketNotificationsResponse {\n  notifications: TicketNotification[];\n  total: number;\n}\n\nexport interface ListUserNotificationsResponse {\n  notifications: TicketNotification[];\n  total: number;\n  page: number;\n  page_size: number;\n}\n\nexport interface SendTicketNotificationRequest {\n  user_ids: number[];\n  type: string;\n  channel: 'email' | 'in_app' | 'sms';\n  content: string;\n}\n\nexport interface NotificationPreferences {\n  user_id: number;\n  email_enabled: boolean;\n  in_app_enabled: boolean;\n  sms_enabled: boolean;\n  sla_warning_time: number;\n}\n\nexport interface UpdateNotificationPreferencesRequest {\n  email_enabled: boolean;\n  in_app_enabled: boolean;\n  sms_enabled: boolean;\n  sla_warning_time: number;\n}\n\nexport class TicketNotificationApi {\n  // 获取工单通知列表\n  static async getTicketNotifications(ticketId: number): Promise<ListTicketNotificationsResponse> {\n    return httpClient.get<ListTicketNotificationsResponse>(`/api/v1/tickets/${ticketId}/notifications`);\n  }\n\n  // 发送工单通知\n  static async sendTicketNotification(\n    ticketId: number,\n    data: SendTicketNotificationRequest\n  ): Promise<void> {\n    return httpClient.post(`/api/v1/tickets/${ticketId}/notifications`, data);\n  }\n\n  // 获取用户通知列表\n  static async getUserNotifications(params?: {\n    page?: number;\n    page_size?: number;\n    read?: boolean;\n  }): Promise<ListUserNotificationsResponse> {\n    return httpClient.get<ListUserNotificationsResponse>('/api/v1/notifications', params);\n  }\n\n  // 标记通知为已读\n  static async markNotificationRead(notificationId: number): Promise<void> {\n    return httpClient.put(`/api/v1/notifications/${notificationId}/read`, {});\n  }\n\n  // 标记所有通知为已读\n  static async markAllNotificationsRead(): Promise<void> {\n    return httpClient.put('/api/v1/notifications/read-all', {});\n  }\n\n  // 获取用户通知偏好\n  static async getNotificationPreferences(userId: number): Promise<NotificationPreferences> {\n    return httpClient.get<NotificationPreferences>(`/api/v1/users/${userId}/notification-preferences`);\n  }\n\n  // 更新用户通知偏好\n  static async updateNotificationPreferences(\n    userId: number,\n    data: UpdateNotificationPreferencesRequest\n  ): Promise<NotificationPreferences> {\n    return httpClient.put<NotificationPreferences>(`/api/v1/users/${userId}/notification-preferences`, data);\n  }\n}\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IA+DE;IAAAA,YAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,YAAA;AAAAA,YAAA,GAAAE,CAAA;;;;;;+BAJW;;;;;;WAAAC,qBAAA;;;;;gCA3Dc;AA2DpB,MAAMA,qBAAA;EACX;EACA,aAAaC,uBAAuBC,QAAgB,EAA4C;IAAA;IAAAL,YAAA,GAAAM,CAAA;IAAAN,YAAA,GAAAE,CAAA;IAC9F,OAAOK,WAAA,CAAAC,UAAU,CAACC,GAAG,CAAkC,mBAAmBJ,QAAA,gBAAwB;EACpG;EAEA;EACA,aAAaK,uBACXL,QAAgB,EAChBM,IAAmC,EACpB;IAAA;IAAAX,YAAA,GAAAM,CAAA;IAAAN,YAAA,GAAAE,CAAA;IACf,OAAOK,WAAA,CAAAC,UAAU,CAACI,IAAI,CAAC,mBAAmBP,QAAA,gBAAwB,EAAEM,IAAA;EACtE;EAEA;EACA,aAAaE,qBAAqBC,MAIjC,EAA0C;IAAA;IAAAd,YAAA,GAAAM,CAAA;IAAAN,YAAA,GAAAE,CAAA;IACzC,OAAOK,WAAA,CAAAC,UAAU,CAACC,GAAG,CAAgC,yBAAyBK,MAAA;EAChF;EAEA;EACA,aAAaC,qBAAqBC,cAAsB,EAAiB;IAAA;IAAAhB,YAAA,GAAAM,CAAA;IAAAN,YAAA,GAAAE,CAAA;IACvE,OAAOK,WAAA,CAAAC,UAAU,CAACS,GAAG,CAAC,yBAAyBD,cAAA,OAAqB,EAAE,CAAC;EACzE;EAEA;EACA,aAAaE,yBAAA,EAA0C;IAAA;IAAAlB,YAAA,GAAAM,CAAA;IAAAN,YAAA,GAAAE,CAAA;IACrD,OAAOK,WAAA,CAAAC,UAAU,CAACS,GAAG,CAAC,kCAAkC,CAAC;EAC3D;EAEA;EACA,aAAaE,2BAA2BC,MAAc,EAAoC;IAAA;IAAApB,YAAA,GAAAM,CAAA;IAAAN,YAAA,GAAAE,CAAA;IACxF,OAAOK,WAAA,CAAAC,UAAU,CAACC,GAAG,CAA0B,iBAAiBW,MAAA,2BAAiC;EACnG;EAEA;EACA,aAAaC,8BACXD,MAAc,EACdT,IAA0C,EACR;IAAA;IAAAX,YAAA,GAAAM,CAAA;IAAAN,YAAA,GAAAE,CAAA;IAClC,OAAOK,WAAA,CAAAC,UAAU,CAACS,GAAG,CAA0B,iBAAiBG,MAAA,2BAAiC,EAAET,IAAA;EACrG;AACF","ignoreList":[]}