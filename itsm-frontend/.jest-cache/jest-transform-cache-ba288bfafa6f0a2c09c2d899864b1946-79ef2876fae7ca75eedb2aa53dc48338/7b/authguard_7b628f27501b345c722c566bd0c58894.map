{"version":3,"names":["AuthGuard","children","fallback","cov_6qxgar5kz","b","redirectTo","requireAuth","requiredRoles","requiredPermissions","requireAll","f","user","isAuthenticated","s","_authstore","useAuthStore","window","location","href","length","ok","every","r","role","some","perms","permissions","p","includes","_jsxruntime","jsx","Fragment"],"sources":["/Users/heidsoft/Downloads/research/itsm/itsm-frontend/src/components/ui/auth-guard.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport { useAuthStore } from '@/lib/store/auth-store';\n\nexport interface AuthGuardProps {\n  children: React.ReactNode;\n  fallback?: React.ReactNode;\n  redirectTo?: string;\n  requireAuth?: boolean;\n  requiredRoles?: string[];\n  requiredPermissions?: string[];\n  requireAll?: boolean;\n}\n\nexport const AuthGuard: React.FC<AuthGuardProps> = ({\n  children,\n  fallback = null,\n  redirectTo = '/login',\n  requireAuth = true,\n  requiredRoles = [],\n  requiredPermissions = [],\n  requireAll = true,\n}) => {\n  const { user, isAuthenticated } = useAuthStore();\n\n  if (requireAuth && !isAuthenticated) {\n    if (typeof window !== 'undefined') window.location.href = redirectTo;\n    return fallback;\n  }\n\n  if (requiredRoles.length > 0) {\n    const ok = requireAll\n      ? requiredRoles.every(r => user?.role === r)\n      : requiredRoles.some(r => user?.role === r);\n    if (!ok) return fallback;\n  }\n\n  if (requiredPermissions.length > 0) {\n    const perms = user?.permissions || [];\n    const ok = requireAll\n      ? requiredPermissions.every(p => perms.includes(p))\n      : requiredPermissions.some(p => perms.includes(p));\n    if (!ok) return fallback;\n  }\n\n  return <>{children}</>;\n};\n\n\n"],"mappings":"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","ignoreList":[]}