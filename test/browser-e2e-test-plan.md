# 浏览器端到端测试计划（按菜单逐一）

- 日期: 2025-12-07
- 环境: 本地开发服务器 `http://localhost:3000/`（已登录）
- 目标: 覆盖主要菜单模块的真实页面交互、权限与租户隔离、错误与空态、A11y 与统一模板

## 全局与登录

- 打开首页，确认已登录后跳转至仪表盘
- 检查顶部/侧边导航与当前租户显示是否正确
- 执行动作
  - 切换租户（若有菜单入口）：切换后列表数据与头部 `X-Tenant-ID` 一致（通过网络面板）
  - 打开/关闭 Toast 通知（`Toast` 组件按钮与自动关闭应工作）
- 预期
  - 路由守卫正确；刷新令牌无提示错误；Toast 自动关闭，按钮关闭有效；键盘 `Tab` 巡航可达

## 仪表盘（Dashboard）

- 访问 `/(main)/dashboard`
- 执行动作
  - 选择不同时间范围（近7天/近30天）
  - 查看 KPI 卡片、趋势图、分布图与满意度图表是否联动
- 预期
  - 图表数据加载与空态显示一致；错误时统一提示；切换范围后图表刷新

## 工单（Tickets）

- 访问 `/ (main)/tickets`
- 执行动作
  - 筛选：状态=处理中、优先级=高、搜索=“网络”
  - 分页：切换到第2页，再返回第1页；URL 同步参数（地址栏包含 query）
  - 打开某工单详情，执行编辑并保存（如更改描述）
- 预期
  - 列表刷新与提示统一（Loading/Empty/Error 模板）；筛选与分页生效；详情更新后返回列表刷新

### 工单创建与附件上传

- 访问 `/ (main)/tickets/create`
- 执行动作
  - 按要求填写标题/描述/分类/模板/标签
  - 上传 1 个附件后提交
- 预期
  - 创建成功，附件通过 API 层上传（网络面板接口：`POST /api/v1/tickets/:id/attachments`），回显成功提示；页面跳转或清空表单

## 事件（Incidents）

- 访问 `/ (main)/incidents`
- 执行动作
  - 筛选：状态=进行中，来源=手工，类型=事件类型A
  - 分页/统计卡片联动
- 预期
  - 列表与统计一致；错误与空态统一；筛选参数通过 API 层（网络面板可见 `IncidentAPI.listIncidents` 请求）

## 问题（Problems）

- 访问 `/ (main)/problems`
- 执行动作
  - 新建问题；添加调查步骤 2 条；生成根因报告与解决方案
- 预期
  - 多步流程保存成功；审计记录存在；错误与空态统一

## 变更（Changes）与工作流（Workflow）

- 访问 `/ (main)/changes` 与 `/ (main)/workflow/*`
- 执行动作
  - 新建变更并提交审批
  - 在工作流设计器加载并部署 BPMN；查看实例/任务
- 预期
  - 审批状态机一致；部署与任务操作成功；权限拦截提示清晰

## CMDB

- 访问 `/ (main)/cmdb`
- 执行动作
  - 筛选配置项；打开拓扑与关系图；查看影响评估
- 预期
  - 大数据渲染流畅；错误与空态统一；图谱交互可用

## 服务目录（Service Catalog）

- 访问 `/ (main)/service-catalog`
- 执行动作
  - 筛选服务项；发起一次申请（审批/完成/评分/收藏）
  - 表单校验与撤回/重试
- 预期
  - 流程各步有提示与状态；错误与空态统一

## 知识库（Knowledge Base）

- 访问 `/ (main)/knowledge-base`
- 执行动作
  - 新建/编辑文章；分类/标签设置；关联工单推荐
- 预期
  - 版本与协作信息可见；关联推荐加载与空态一致

## SLA

- 访问 `/ (main)/sla` 与 `/(main)/sla-dashboard`
- 执行动作
  - 新建 SLA 定义；查看合规与违规列表；更新违规状态；查看监控与预警规则
- 预期
  - 定义保存与列表刷新；合规计算展示明确；错误与空态统一

## 报表（Reports）

- 访问 `/ (main)/reports`
- 执行动作
  - 切换报表（事件趋势/变更成功率/CMDB质量等）；导出 CSV/PNG；保存为仪表盘卡片
- 预期
  - 导出文件成功；卡片化后仪表盘显示

## 通知（Notifications）

- 访问 `/notifications`
- 执行动作
  - 标记已读与全部已读；更新通知偏好
- 预期
  - 状态变更成功，列表刷新；错误与空态统一

## 管理台（Admin）

- 访问 `/ (main)/admin/*`
- 执行动作
  - 用户/角色/权限/租户/部门/团队/项目/应用/系统配置 CRUD；成员管理；树形结构
- 预期
  - 权限校验生效；租户切换影响数据范围；错误与空态统一

## A11y 与交互一致性

- 检查表单标签可达性（`getByLabelText` 对应）；键盘导航；对话框焦点陷阱与 `Esc` 关闭
- ARIA 语义与 `aria-live` 公告；Toast 与错误提示合理
